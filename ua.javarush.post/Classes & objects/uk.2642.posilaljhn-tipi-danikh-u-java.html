Посилальні типи даних у Java
<p>----------------------------------------</p>
Без розуміння синтаксису Java неможливо стати серйозним розробником, тому ми продовжуємо вивчати синтаксис. ми говорили про примітивні змінні, але так як видів змінних два, сьогодні ми поговоримо про другий вид — типи посилань у Java. То що
<p>----------------------------------------</p>
Без розуміння синтаксису Java неможливо стати серйозним розробником, тому ми продовжуємо вивчати синтаксис. <a href="https://codegym.cc/groups/posts/2630-prostihe-peremennihe-v-java-i-konstantih" target="_blank">В одній із минулих статей</a> ми говорабо про примітивні змінні, але так як видів змінних два, сьогодні ми поговоримо про другий вид — типи посилань у Java. То що це? Навіщо потрібні типи даних у Java? <img data-max-width="800" data-id="303a9a63-afb1-42f4-b1f8-3fe892b2e4ac" class="img-fluid" alt="Посилальні типи даних у Java - 1" src="https://cdn.javarush.com/images/article/303a9a63-afb1-42f4-b1f8-3fe892b2e4ac/800.jpeg" style="width: 800px;">Давайте уявимо, що у нас є об'єкт телевізор з деякими характеристиками, такими як номер каналу, гучність звуку та прапор увімкненості: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> TV <span class="token punctuation"><span class="token punctuation">{</span></span>
   <span class="token keyword"><span class="token keyword">int</span></span> numberOfChannel<span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token keyword"><span class="token keyword">int</span></span> soundVolume<span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token keyword"><span class="token keyword">boolean</span></span> isOn<span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Як простий тип, наприклад, <code class=" language-none">int</code>може зберігати ці дані? Нагадаємо: одна змінна <code class=" language-none">int</code>- це 4 байти. Адже там усередині є дві змінні (4 байти + 4 байти) цього ж типу, та ще й <code class=" language-none">boolean</code>(+1 байт)... Разом — 4 до 9, адже як правило, в об'єкті зберігається набагато більше інформації. Що робити? Не можна ж вкласти об'єкт у змінну. На цьому моменті в нашій історії з'являються перемінні посилання. <strong>Посилальні змінні</strong> зберігають адресау осередку пам'яті, в якій розташований певний об'єкт. Тобто це візитка з адресаою, маючи яку ми можемо знайти наш об'єкт у загальній пам'яті і виконувати з ним деякі маніпуляції. Посилання на будь-який об'єкт у Java є посилальною змінною. Як би це виглядало з нашим об'єктом телевізора: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">TV</span></span> telly <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token function"><span class="token function">TV</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Змінної типу TV з ім'ям <code class=" language-none">telly</code>ми задаємо посилання на об'єкт типу TV, що створюється. Тобто, JVM виділяє пам'ять у купі під об'єкт TV, створює його та адресау на його місце розташування в пам'яті, кладеться в змінну, <code class=" language-none">telly</code>яка зберігається в стеку. Детальніше про пам'ять, а саме про стек і ще масу корисного, можна почитати в <a href="https://codegym.cc/quests/lectures/questharvardcs50.level05.lecture04" target="_blank">цій лекції</a>. Змінна типу TV та об'єкт типу TV, помітабо? Це неспроста: об'єктам певного типу повинні відповідати змінні такого самого типу (крім успадкування та реалізацій інтерфейсів, але зараз ми це не враховуємо). Зрештою, не будемо ж ми в склянки наливати суп? Виходить, що у нас об'єкт — це телевізор, а посилальна змінна для нього — ніби пульт керування. За допомогою цього пульта ми можемо взаємодіяти з нашим об'єктом та його даними. Наприклад, задати характеристики для нашого телевізора: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class="  language-java">telly<span class="token punctuation"><span class="token punctuation">.</span></span>isOn <span class="token operator"><span class="token operator">=</span></span> <span class="token boolean"><span class="token boolean">true</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
telly<span class="token punctuation"><span class="token punctuation">.</span></span>numberOfChannel <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">53</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
telly<span class="token punctuation"><span class="token punctuation">.</span></span>soundVolume <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">20</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Тут ми використовували оператор точки <code class=" language-none">.</code>— щоб отримати доступ і розпочати використання внутрішніх елементів об'єкта, на який посилається змінна. Наприклад, у першому рядку ми сказали змінній <code class=" language-none">telly</code>: “Дай нам внутрішню змінну <code class=" language-none">isOn</code>об'єкта, на який ти посилаєшся, і задай їй значення true” (включи телевізор). 
<h2>Перевизначення посилальних змінних</h2>Припустимо, у нас є дві змінні типу посилання та об'єкти, на які вони посилаються: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">TV</span></span> firstTV <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token function"><span class="token function">TV</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">TV</span></span> secondTV <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token function"><span class="token function">TV</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Якщо ми напишемо: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java">firstTV <span class="token operator"><span class="token operator">=</span></span> secondTV<span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> це означатиме, що ми першою змінною як значення привласнабо копію адресаи (значення бітів адресаи) на другий об'єкт, і тепер обидві змінні посилаються на другий об'єкт (інакше кажучи, два пульти від одного й того самого телевізора). У той же час перший об'єкт залишився без змінної, яка на нього посилається. У результаті у нас є об'єкт, до якого неможливо звернутися, адже змінна була такою умовною ниточкою до нього, без якої він перетворюється на сміття, просто лежить у пам'яті та посідає місце. Згодом цей об'єкт буде знищений із пам'яті <a href="https://codegym.cc/groups/posts/917-sborka-musora" target="_blank">збирачем сміття</a> . <img data-max-width="800" data-id="5016eaac-83a2-417a-acea-97283afafef1" class="img-fluid" alt="Посилальні типи даних у Java - 2" src="https://cdn.javarush.com/images/article/5016eaac-83a2-417a-acea-97283afafef1/800.jpeg" style="width: 800px;">Перервати сполучну ниточку з об'єктом можна і без іншого посилання: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java">secondTV <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">null</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> У результаті посилання на об'єкт залишиться одне - <code class=" language-none">firstTV</code>, а <code class=" language-none">secondTV</code>вже ні на кого вказувати не буде (що не заважає нам надалі привласнити посилання на який-небудь об'єкт типу TV). 
<h2>Клас String</h2>Окремо хотілося б згадати клас <a href="https://codegym.cc/groups/posts/2347-klass-string-v-java" target="_blank">String</a> . Це базовий клас, призначений для зберігання та роботи з даними, що зберігаються у вигляді рядка. Приклад: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">String</span></span> text <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"This TV is very loud"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Тут ми передали рядок для зберігання у конструкторі об'єкта. Але ж ніхто так не робить. Адже рядки можна створювати: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">String</span></span> text <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"This TV is very loud"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Набагато зручніше, правда? За популярністю використання <code class=" language-none">String</code>не поступається примітивним типам, але все ж таки це клас, і змінна, яка посилається на нього - не примітивного, а посилання типу. Є <code class=" language-none">String</code>така чудова можливість конкатенації рядків: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">String</span></span> text <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"This TV"</span></span> <span class="token operator"><span class="token operator">+</span></span> <span class="token string"><span class="token string">" is very loud"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> У результаті ми знову отримаємо текст: <code class=" language-none">This TV is very loud</code>, тому що два рядки з'єднаються в одне ціле, і змінна посилатиметься на цей текст. Важливим нюансом є те, що <code class=" language-none">String</code>це незмінний клас. Що це означає? Візьмемо такий приклад: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">String</span></span> text <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"This TV"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
text <span class="token operator"><span class="token operator">=</span></span> text <span class="token operator"><span class="token operator">+</span></span> <span class="token string"><span class="token string">" is very loud"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Начебто все просто: оголошуємо змінну, задаємо їй значення. На наступному рядку змінюємо його. Але не зовсім і змінюємо. Так як це незмінний клас, на другому рядку початкове значення не змінюється, а створюється нове, яке, у свою чергу, складається з першого <code class=" language-none">+ " is very loud"</code>. 
<h2>Посилальні константи</h2>У статті про примітивні типи ми торкалися теми констант. Як же поводитиметься посилальна змінна, коли ми оголосимо її <a href="https://codegym.cc/groups/posts/1946-neizmennoe-v-java-final-konstantih-i-immutable" target="_blank">final</a> ? 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">final</span></span> <span class="token class-name"><span class="token class-name">TV</span></span> telly <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token function"><span class="token function">TV</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Можливо, ви подумаєте, що це зробить об'єкт незмінним. Але ж ні, це не так. <img data-max-width="800" data-id="fa849db8-0205-4137-96d1-f47f2c01bacf" class="img-fluid" alt="Посилальні типи даних Java - 3" src="https://cdn.javarush.com/images/article/fa849db8-0205-4137-96d1-f47f2c01bacf/800.jpeg" style="width: 800px;">Посилальна змінна з модифікатором <code class=" language-none">final</code>буде прив'язана до певного об'єкта без можливості її відв'язати (перевизначити або прирівняти до <code class=" language-none">null</code>). Тобто після завдання значення такої змінної код виду: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java">telly <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token function"><span class="token function">TV</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> або 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java">telly <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">null</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> буде викликати помилку компіляції. Тобто <code class=" language-none">final</code>діє лише на заслання, а на сам об'єкт впливу не робить. Якщо спочатку він у нас змінюється, ми без проблем можемо змінювати його внутрішній стан: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java">telly<span class="token punctuation"><span class="token punctuation">.</span></span>soundVolume <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">30</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Іноді змінні позначають як final навіть у аргументах методу! 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> enableTV <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">final</span></span> <span class="token class-name"><span class="token class-name">TV</span></span> telly<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
   telly<span class="token punctuation"><span class="token punctuation">.</span></span>isOn <span class="token operator"><span class="token operator">=</span></span> <span class="token boolean"><span class="token boolean">true</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Це робиться для того, щоб у процесі написання методу ці аргументи не можна було перевизначити і створити менше плутанини. А якщо позначити <code class=" language-none">final</code>посилальну змінну, яка посилається на незмінний об'єкт? Наприклад <code class=" language-none">String</code>: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">final</span></span> <span class="token class-name"><span class="token class-name">String</span></span> PASSWORD <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"password"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Як наслідок ми отримаємо константу, аналог констант примітивного типу, адже тут ми не можемо ні перевизначити посилання, ні змінити внутрішній стан об'єкта (внутрішні дані). <a href="https://codegym.cc/welcome" target="_blank"><img id="click_banner1_articles" data-max-width="1024" data-id="056d574d-a6bc-4fdc-b5c5-f1bd0dbd6f21" class="img-fluid" alt="Посилальні типи даних у Java - 4" src="https://cdn.javarush.com/images/article/056d574d-a6bc-4fdc-b5c5-f1bd0dbd6f21/1024.jpeg" style="width: 1024px;"></a>
<h2>Підведемо підсумки</h2>
<ol>
 <li>Якщо прості змінні зберігають біти значень, посилальні змінні зберігають біти, що представляють спосіб отримання об'єкта.</li>
 <li>Посилання на об'єкти оголошуються лише одного виду об'єктів.</li>
 <li>Будь-який клас в Java - це тип посилання.</li>
 <li>За замовчуванням Java значення будь-якого змінного посилання — <code class=" language-none">null</code>.</li>
 <li><code class=" language-none">String</code>- Стандартний приклад посилального типу. Також цей клас є незмінним (immutable).</li>
 <li>Посилальні змінні з модифікатором <code class=" language-none">final</code>прив'язані лише одного об'єкту без можливості перевизначення.</li>
</ol>