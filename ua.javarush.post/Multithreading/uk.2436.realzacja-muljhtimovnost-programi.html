Реалізація мультимовності програми
<p>----------------------------------------</p>
Мультиязичность, інакше кажучи, - це частина розробки програми, яка може бути адаптована для кількох мов без перекроювання логіки програми. Розглянемо ситуацію: ви створюєте веб-додаток великої торгової компанії для мешканців великої кілько
<p>----------------------------------------</p>
<img data-max-width="550" alt="Реалізація мультимовності програми - 1" src="https://cdn.javarush.com/images/article/5382905e-f72b-47e0-895a-c609523b8be0/original.jpeg">
<h2>Сьогодні ми поговоримо про мультимовність. То що це?</h2>Мультиязичность, інакше кажучи, <span class="text-bold">інтернаціоналізація</span> - це частина розробки програми, яка може бути адаптована для кількох мов без перекроювання логіки програми. Розглянемо ситуацію: ви створюєте веб-додаток великої торгової компанії для мешканців великої кількості країн, в яких говорять, наприклад, мовами як російська, англійська, іспанська. Вам потрібно зробити його зручним для всіх користувачів. Задум такий: у російськомовного читача має бути можливість бачити ваші дані російською мовою, американцеві буде зручніше прочитати матеріал англійською, а іспанцю — іспанською (несподівано, так?) Розглянемо сьогодні кілька <img data-max-width="850" alt="Реалізація мультимовності програми - 2" src="https://cdn.javarush.com/images/article/059b5fbd-c759-4181-8ac5-af9e7fa31889/oroginal.jpeg">моделей <span class="text-bold">інтернаціоналізації</span>, і для однієї з них (яка найбільше подобається мені) розглянемо реалізацію на Java. Як піддослідний кролик сьогодні у нас буде табличка з даними про фільми. Не будемо особливо перекручуватися, тому колонок у нас буде небагато. Для прикладу – ОК. І перекладати ми будемо назви фільмів (режисери – так, для масовки): <img data-max-width="550" alt="Реалізація мультимовності програми - 3" src="https://cdn.javarush.com/images/article/8d423472-1a1b-4d91-aa12-4f74af373b9c/original.jpeg">
<h2>1. Таблиця з перекладом під кожну мову</h2>Суть цієї моделі: кожна мова має окрема таблиця в БД, у якій містяться всі осередки, потребують перекладу. Недолік цього способу полягає в тому, що кожного разу, коли у нас додається нова мова, необхідно додавати нову таблицю. Тобто уявімо, що у нашого замовника ну дуже добре пішли справи, і він розширює свій додаток для багатьох країн (власне, і мов) світу. Отже, потрібно буде додавати по табличці на мову. У підсумку у нас буде БД, що наполовину або майже повністю складається з допоміжних табличок перекладів: <img data-max-width="550" alt="Реалізація мультимовності програми - 4" src="https://cdn.javarush.com/images/article/943cbd5c-dacf-4a99-9215-492ab226780d/original.jpeg"> <span class="text-bold">Схема самих фільмів: </span> <img data-max-width="300" alt="Реалізація мультимовності програми - 5" src="https://cdn.javarush.com/images/article/996cfade-6a51-4b0e-8b06-37522e94b368/original.jpeg"><span class="text-bold">Таблиці перекладів:</span>
<ul>
 <li>Українська <img data-max-width="409" alt="Реалізація мультимовності програми - 6" src="https://cdn.javarush.com/images/article/346bd999-52b5-4e16-ad8d-dde299462dbb/original.jpeg"></li>
 <li>Іспанська <img data-max-width="550" alt="Реалізація мультимовності програми - 7" src="https://cdn.javarush.com/images/article/c7c3ab9f-9481-4b10-96c3-029556ba57b6/original.jpeg"></li>
 <li>Англійська <img data-max-width="550" alt="Реалізація мультимовності програми - 8" src="https://cdn.javarush.com/images/article/1722b814-cc3b-4e9c-969f-69cde278c563/original.jpeg"></li>
</ul>
<h2>2. Одна на всіх</h2>У кожній таблиці, яка стосується певної моделі, додається поле з ідентифікатором для таблички мови. Відповідно, у БД є ця табличка з перекладами. Проблема в тому, що одному об'єкту може відповідати кілька перекладів (мов). У результаті відбудеться дублювання сутностей, а це сильно плутає та ускладнює логіку, і це не є добре. <span class="text-bold">Дивимося UML: </span> <img data-max-width="550" alt="Реалізація мультимовності програми - 9" src="https://cdn.javarush.com/images/article/261c20b3-12eb-4856-b833-1dd378e64234/original.jpeg"> <span class="text-bold">Таблиця movies: </span> <img data-max-width="300" alt="Реалізація мультимовності програми - 10" src="https://cdn.javarush.com/images/article/96b41aba-a8da-4923-82e2-971238d04477/original.jpeg"> <span class="text-bold">Таблиця languages:</span> <img data-max-width="550" alt="Реалізація мультимовності програми - 11" src="https://cdn.javarush.com/images/article/a5b610c1-a5d6-4535-ac63-2ed0a7ab1862/original.jpeg">
<h2>3. По колонці на мову</h2>Для кожної колонки кожної мови в таблиці створюється окрема колонка перекладу. Мінус такого підходу в тому, що знову ж таки, якщо додаватиметься велика кількість мов, потрібно буде щоразу змінювати структуру бази даних, а це вважається поганим підходом. Також уявіть, наскільки роздмухуватимуться таблички, які потребують інтернаціоналізації. Можливо, варто задуматися про таку модель, коли заздалегідь відома кількість мов, що підтримуються, їх не надто багато, і кожна модель повинна існувати у всіх мовних варіаціях. <span class="text-bold">UML: </span> <img data-max-width="300" alt="Реалізація мультимовності програми - 12" src="https://cdn.javarush.com/images/article/7bbfb01f-c7f1-4ad6-a857-3f7d148b142f/original.jpeg"><span class="text-bold">Таблиця All inclusive:</span> <img data-max-width="550" alt="Реалізація мультимовності програми - 13" src="https://cdn.javarush.com/images/article/128d0715-11d6-4252-b398-895ca56f0e98/original.jpeg">
<h2>4. Зовнішній переклад</h2>Цей варіант реалізується з допомогою підключення зовнішніх коштів (Google translate, Bing translate, etc.). Його застосовують, якщо потрібно надати інформацію якомога більше відвідувачів, і цієї інформації багато. Дуже багато. У такому разі можна ухвалити рішення не зберігати прямо інформацію в БД усіма мовами, а динамічно її перекладати. Але при цьому варто пам'ятати, що якість машинного перекладу найчастіше залишає бажати кращого. Варіант може розглядатись лише як дуже економний (коли немає ресурсів на переклад кожної публікації). Частою проблемою з точки зору правильності перекладу є те, що перекладачі, що погано знають мову, вибирають неправильне значення слова і плутають користувача, змушуючи його самостійно додумувати зміст написаного на кнопці. Ще важливо не тільки правильно перекласти пропозицію, а й підвести його сенс до конкретної мови та національності. У розробників виникає багато проблем через пологи в деяких мовах. Їм доводиться дублювати фразу в коді залежно від статі користувача, а також враховувати, що не тільки іменники мають рід, але й прикметники та дієслова по-різному схиляються. Трапляються випадки, коли вибравши не англійську мову в додатку, поряд зі словами вибраної мови все одно зустрічаються неперекладені елементи. Ще гірше, якщо відображаються кілька мов і виходить своєрідний Вавилон, де все змішалося, і користувач не може розібратися в додатку Наприклад: що не тільки іменники мають рід, а й прикметники та дієслова по-різному схиляються. Трапляються випадки, коли вибравши не англійську мову в додатку, поряд зі словами вибраної мови все одно зустрічаються неперекладені елементи. Ще гірше, якщо відображаються кілька мов і виходить своєрідний Вавилон, де все змішалося, і користувач не може розібратися в додатку Наприклад: що не тільки іменники мають рід, а й прикметники та дієслова по-різному схиляються. Трапляються випадки, коли вибравши не англійську мову в додатку, поряд зі словами вибраної мови все одно зустрічаються неперекладені елементи. Ще гірше, якщо відображаються кілька мов і виходить своєрідний Вавилон, де все змішалося, і користувач не може розібратися в додатку Наприклад:<a href="https://cloud.google.com/translate/" rel="nofollow" target="_blank">https://cloud.google.com/translate/</a>
<h2>5. Допоміжні файли на рівні програми</h2>Створюються окремі файли для зберігання перекладів. Може бути по файлу на мову або файлу на мову на одну табличку (дрібніше дроблення). Варіант часто використовується через те, що в цих файлух можна зберігати багато текстів, а значить, таблиці і сама БД не роздмухуватимуться. Зручність полягає ще в тому, що не потрібно за цими полями стукати в БД, і в коді файли можна динамічно підміняти залежно від мови, яку ви запитали. У результаті файл служить нам словником, у якому ключ — мову, значення — текст. Але ми не обмежені наведеним нижче форматом "properties", а формати цих файлів можуть широко відрізнятися - JSON, XML, etc. Слабкі сторони у цьому, що у разі сильно знижується нормалізація бази даних. Також цілісність даних залежить не тільки від бази даних, а й від механізму серіалізації. <a href="https://codegym.cc/groups/posts/1557-konstantih-i-internacionalizacija" target="_blank">Відмінна стаття з цієї теми</a> <span class="text-bold"> Приклад файлів-словників з перекладами:</span> <img data-max-width="300" alt="Реалізація мультимовності програми - 14" src="https://cdn.javarush.com/images/article/06ebc7df-0874-43d2-b095-ec56533cee40/original.jpeg">
<ul>
 <li>Англійська <img data-max-width="550" alt="Реалізація мультимовності програми - 15" src="https://cdn.javarush.com/images/article/ae40a2c2-848d-4000-baf8-9d667fabe67c/original.jpeg"></li>
 <li>Українська <img data-max-width="550" alt="Реалізація мультимовності програми - 16" src="https://cdn.javarush.com/images/article/a04aa63b-0d5d-4e7e-af1a-f6670ad0baa1/original.jpeg"></li>
 <li>Іспанська <img data-max-width="550" alt="Реалізація мультимовності програми - 17" src="https://cdn.javarush.com/images/article/b00dcc38-6726-4427-962b-1df427287a46/original.jpeg"></li>
</ul>
<h2>6. Допоміжна таблиця перекладів під кожну таблицю</h2>Як на мене, найгнучкіше рішення. Суть цього підходу полягає у створенні окремої таблиці під мови. Коли необхідно реалізувати можливість перекладів для аналізованої таблиці, створюється зв'язок з таблицею мов, а таблиці зв'язків є id мови, id елемента і колонки з перекладами. Все не таке страшно, як звучить. Даний підхід дозволяє реалізувати досить гнучку розширюваність мов, що підтримуються. Давайте подивимося наочно. <span class="text-bold">UML: </span> <img data-max-width="550" alt="Реалізація мультимовності програми - 18" src="https://cdn.javarush.com/images/article/86565c56-8765-46bd-aa48-0092a62b255e/original.jpeg"><span class="text-bold">Таблиця з фільмами: </span> <img data-max-width="300" alt="Реалізація мультимовності програми - 19" src="https://cdn.javarush.com/images/article/6672ea09-391f-45f8-a2a0-9c81bc923fdf/original.jpeg"><span class="text-bold">Таблиця мов: </span> <img data-max-width="300" alt="Реалізація мультимовності програми - 20" src="https://cdn.javarush.com/images/article/5414d809-6b41-49c3-9dc6-b926a27422ef/original.jpeg"><span class="text-bold">Таблиця перекладів:</span> <img data-max-width="550" alt="Реалізація мультимовності програми - 21" src="https://cdn.javarush.com/images/article/acbc2501-047c-473e-805b-be23a92f7c91/original.jpeg">І, як я говорив вище, давайте розглянемо реалізацію одного з варіантів Java-коду (як ви зрозуміли, це буде останній варіант). У додатку нічого такого: ми пройдемося від контролерів до шарів дао. Розглянемо на методі create — для цього вистачить з головою. Отже поїхали)) Наша сутність - фільм: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Builder</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Movie</span> <span class="token punctuation">{</span>

   <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

   <span class="token keyword">private</span> <span class="token class-name">String</span> producer<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Нічого цікавого просто реалізація моделі першої таблиці. <span class="text-bold">Контролер із конвертерами dto (Data Transfer Object):</span>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">"/cities"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieController</span> <span class="token punctuation">{</span>

   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">MovieService</span> movieService<span class="token punctuation">;</span>

   <span class="token annotation punctuation">@PostMapping</span>
   <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span>moviedto<span class="token punctuation">&gt;</span></span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">MovieDTO</span> movieDTO<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token function">toDTO</span><span class="token punctuation">(</span>movieService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token function">fromDTO</span><span class="token punctuation">(</span>movieDTO<span class="token punctuation">)</span><span class="token punctuation">,</span> movieDTO<span class="token punctuation">.</span><span class="token function">getNameTranslations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> movieDTO<span class="token punctuation">.</span><span class="token function">getNameTranslations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>CREATED<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span> <span class="token class-name">Movie</span> <span class="token function">fromDTO</span><span class="token punctuation">(</span><span class="token class-name">MovieDTO</span> dto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token class-name">Movie</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">producer</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">getProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span> <span class="token class-name">MovieDTO</span> <span class="token function">toDTO</span><span class="token punctuation">(</span><span class="token class-name">Movie</span> movie<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span> nameTranslation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token class-name">MovieDTO</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">producer</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span><span class="token function">getProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">nameTranslations</span><span class="token punctuation">(</span>nameTranslation<span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><a href="https://codegym.cc/welcome" target="_blank"><img id="click_banner1_articles" data-max-width="1024" data-id="27fd9241-29ff-4969-afc7-bda9f1634163" class="img-fluid" alt="Реалізація мультимовності програми - 22" src="https://cdn.javarush.com/images/article/27fd9241-29ff-4969-afc7-bda9f1634163/1024.jpeg" style="width: 1024px;"></a>У DTO ми передаємо переклади як мап, key – скорочення мови, value – значення перекладу (ім'я фільму). <span class="text-bold">DTO:</span>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Builder</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieDTO</span> <span class="token punctuation">{</span>

   <span class="token annotation punctuation">@JsonProperty</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

   <span class="token annotation punctuation">@JsonProperty</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> producer<span class="token punctuation">;</span>

   <span class="token annotation punctuation">@JsonProperty</span><span class="token punctuation">(</span><span class="token string">"nameTranslations"</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nameTranslations<span class="token punctuation">;</span><span class="token comment">//example = "{'en': 'The Matrix', 'ru' : 'Матрица'}"</span>
<span class="token punctuation">}</span></code></pre> Тут ми бачимо сам клас dto, як і написав вище, map для перекладів, решта полів — відображення моделі Movie <span class="text-bold">Переходимо до сервісу фільмів:</span>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MovieService</span> <span class="token punctuation">{</span>

   <span class="token class-name">Movie</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Movie</span> movie<span class="token punctuation">,</span> <span class="token class-name">Map</span><string, string=""> nameList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</string,></code></pre><span class="text-bold">Його реалізація:</span>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">MovieService</span> <span class="token punctuation">{</span>

   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">MovieDAO</span> movieDAO<span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token class-name">LanguageService</span> languageService<span class="token punctuation">;</span>

   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token class-name">Movie</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Movie</span> movie<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span> nameList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       movieDAO<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>movie<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       nameList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>languageService<span class="token punctuation">.</span><span class="token function">getIdByLangCode</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       movieDAO<span class="token punctuation">.</span><span class="token function">createTranslator</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">return</span> movie<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Тут бачимо використання щодо стороннього сервісу LanguageService, для витягування id мови, з його скорочення. І вже з цим ідентифікатором ми зберігаємо наші переклади (так само як map) в таблицю зв'язку. <span class="text-bold">Подивимося на DAO:</span>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MovieDAO</span> <span class="token punctuation">{</span>

   <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Movie</span> movie<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">void</span> <span class="token function">createTranslator</span><span class="token punctuation">(</span><span class="token class-name">Long</span> movieId<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nameTranslations<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><span class="text-bold">Реалізація:</span>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MovieDAOImpl</span> <span class="token keyword">implements</span> <span class="token class-name">MovieDAO</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">;</span>

   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CREATE_MOVIE <span class="token operator">=</span> <span class="token string">"INSERT INTO movies(id, producer) VALUES(?, ?)"</span><span class="token punctuation">;</span>

   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CREATE_TRANSLATOR <span class="token operator">=</span> <span class="token string">"INSERT INTO movies_translator(movies_id, language_id, name) VALUES(?, ?, ?)"</span><span class="token punctuation">;</span>

   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Movie</span> movie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>CREATE_MOVIE<span class="token punctuation">,</span> movie<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> movie<span class="token punctuation">.</span><span class="token function">getProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createTranslator</span><span class="token punctuation">(</span><span class="token class-name">Long</span> movieId<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> nameTranslations<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       nameTranslations<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>CREATE_TRANSLATOR<span class="token punctuation">,</span> movieId<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Тут ми бачимо збереження сутності та мов до неї (словника). І так, тут використовується Spring JDBC: вважаю його кращим для новачків, оскільки він більш прозорий. Переходимо до "стороннього" сервісу. <span class="text-bold">Сервіс мови:</span>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">LanguageService</span> <span class="token punctuation">{</span>

   <span class="token class-name">Long</span> <span class="token function">getIdByLangCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> lang<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><span class="text-bold">Реалізація:</span>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LanguageServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">LanguageService</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">LanguageDAO</span> languageDAO<span class="token punctuation">;</span>

   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">getIdByLangCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> lang<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> languageDAO<span class="token punctuation">.</span><span class="token function">getIdByLangCode</span><span class="token punctuation">(</span>lang<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Нічого особливого, пошук за скороченим ім'ям. <span class="text-bold">DAO:</span>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">LanguageDAO</span> <span class="token punctuation">{</span>

   <span class="token class-name">Long</span> <span class="token function">getIdByLangCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> lang<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><span class="text-bold">Реалізація:</span>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LanguageDAOImpl</span> <span class="token keyword">implements</span> <span class="token class-name">LanguageDAO</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">;</span>

   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> FIND_ID_BY_LANG_CODE <span class="token operator">=</span> <span class="token string">"SELECT id FROM languages WHERE lang_code = ?"</span><span class="token punctuation">;</span>

   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">getIdByLangCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> lang<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> jdbcTemplate<span class="token punctuation">.</span><span class="token function">queryForObject</span><span class="token punctuation">(</span>FIND_ID_BY_LANG_CODE<span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> lang<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><span class="text-bold">Структура:</span> <img data-max-width="308" alt="Реалізація мультимовності програми - 23" src="https://cdn.javarush.com/images/article/5056902c-8f2f-4f14-86ed-2ea48bdeb1a0/original.jpeg"> Усі описані вище моделі мають право життя. Вирішувати, яку саме використовувати, потрібно виходячи із ситуації. Звичайно, це не все: є ще багато різних підходів, серед яких використання різних БД для різних мов, використання кешів, різних фреймворків і так далі. На цьому у мене сьогодні сьогодні все і… <img data-max-width="550" alt="Реалізація мультимовності програми - 24" src="https://cdn.javarush.com/images/article/612eea3b-2c54-477d-bc21-3e3d52d3d5c8/original.jpeg">