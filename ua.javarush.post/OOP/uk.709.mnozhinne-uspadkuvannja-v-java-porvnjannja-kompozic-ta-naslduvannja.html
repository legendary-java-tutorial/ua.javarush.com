Множинне успадкування в Java. Порівняння композиції та наслідування
<p>----------------------------------------</p>
Якийсь час тому я написав кілька постів про успадкування, інтерфейси та композиції в Java. У цій статті ми розглянемо множинне спадкування, а потім дізнаємося про переваги композиції перед спадкуванням. Множинне наслідування – здатність ств
<p>----------------------------------------</p>
Якийсь час тому я написав кілька постів про успадкування, інтерфейси та композиції в Java. У цій статті ми розглянемо множинне спадкування, а потім дізнаємося про переваги композиції перед спадкуванням. 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="3169cceb-a50f-44c5-ab9d-214a4e2229ae" data-max-width="710" alt="Множинне успадкування в Java.  Порівняння композиції та успадкування - 1" src="https://cdn.javarush.com/images/article/3169cceb-a50f-44c5-ab9d-214a4e2229ae/512.jpeg" style="width: 710px;">
 </div>
</div>
<h2>Множинне успадкування в Java</h2>Множинне наслідування – здатність створювати класи з безліччю класів-батьків. На відміну від інших популярних об'єктно-орієнтованих мов, на кшталт С++, мова Java не підтримує успадкування класів. Не підтримує він його через ймовірність зіткнутися з «проблемою алмазу» і замість цього воліє забезпечувати комплексний підхід для його вирішення, використовуючи кращі варіанти з тих, якими ми можемо досягти аналогічний результат успадкування.<cut>
 <h2>«Проблема Алмазу»</h2>Для більш простого розуміння проблеми алмазу припустимо, що множинне успадкування підтримується Java. У цьому випадку ми можемо отримати класи з ієрархією показаної на малюнку нижче. 
 <img data-id="c3a99477-cf8e-4344-8c37-867da7007b07" data-max-width="450" alt="ієрархія класів &quot;алмаз&quot;" src="https://cdn.javarush.com/images/article/c3a99477-cf8e-4344-8c37-867da7007b07/256.jpeg" style="width: 450px;">Припустимо, що 
 <code class=" language-none">SuperClass</code>це абстрактний клас, який описує деякий метод, а класи 
 <code class=" language-none">ClassA</code>і 
 <code class=" language-none">ClassB</code>реальні класи. 
 <code class=" language-none"><strong>SuperClass.java</strong></code>
 <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">abstract</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">SuperClass</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
   	<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">abstract</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre>
 <strong><code class=" language-none">ClassA.java</code></strong>
 <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">ClassA</span></span> <span class="token keyword"><span class="token keyword">extends</span></span> <span class="token class-name"><span class="token class-name">SuperClass</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token annotation punctuation"><span class="token annotation punctuation">@Override</span></span>
 <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Какая-то реализация класса A"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
  <span class="token comment"><span class="token comment">//собственный метод класса  ClassA</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">methodA</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Тепер, давайте припустимо, що клас 
 <code class=" language-none">ClassC</code>успадковується 
 <code class=" language-none">ClassA</code>і 
 <code class=" language-none">ClassB</code>одночасно, і при цьому має наступну реалізацію: 
 <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">ClassC</span></span> <span class="token keyword"><span class="token keyword">extends</span></span> <span class="token class-name"><span class="token class-name">ClassA</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">ClassB</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">test</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token comment"><span class="token comment">//вызов метода родительского класса</span></span>
        <span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Зауважте, що метод 
 <code class=" language-none">test()</code>викликає метод 
 <code class=" language-none">doSomething()</code>батьківського класу, що призведе до невизначеності, тому що компілятор не знає про те, який метод суперкласу повинен бути викликаний. Завдяки обрисам діаграми успадкування класів у цій ситуації, що нагадує обриси гранованого алмазу, проблема отримала назву «проблема Алмаза». Це і є основна причина, чому Java не має підтримки множинного успадкування класів. Зазначимо, що зазначена проблема з множинним успадкуванням класів також може виникнути з трьома класами, що мають як мінімум один загальний метод. 
 <h2>Множинне успадкування та інтерфейси</h2>Ви могли звернути увагу, що я завжди говорю: «множинне спадкування не підтримується між класами», але воно підтримується між інтерфейсами. Нижче наведено простий приклад: 
 <code class=" language-none"><strong>InterfaceA.java</strong></code>
 <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">interface</span></span> <span class="token class-name"><span class="token class-name">InterfaceA</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre>
 <code class=" language-none"><strong>InterfaceB.java</strong></code>
 <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">interface</span></span> <span class="token class-name"><span class="token class-name">InterfaceB</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Зауважте, що обидва інтерфейси мають метод з однаковою назвою. Тепер, припустимо, ми маємо інтерфейс, успадкований від обох інтерфейсів. 
 <code class=" language-none"><strong>InterfaceC.java</strong></code>
 <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">interface</span></span> <span class="token class-name"><span class="token class-name">InterfaceC</span></span> <span class="token keyword"><span class="token keyword">extends</span></span> <span class="token class-name"><span class="token class-name">InterfaceA</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">InterfaceB</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

    <span class="token comment"><span class="token comment">//метод, с тем же названием описан в  InterfaceA и InterfaceB</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Тут, все ідеально, оскільки інтерфейси - це лише резервування/опис методу, а реалізація самого методу буде в конкретному класі, що реалізує ці інтерфейси, таким чином немає ніякої можливості зіткнутися з невизначеністю при успадкування інтерфейсів. Ось чому, класи Java можуть успадковуватися від декількох інтерфейсів. Покажемо на прикладі нижче. 
 <code class=" language-none"><strong>InterfacesImpl.java</strong></code>
 <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">InterfacesImpl</span></span> <span class="token keyword"><span class="token keyword">implements</span></span> <span class="token class-name"><span class="token class-name">InterfaceA</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">InterfaceB</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">InterfaceC</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

    <span class="token annotation punctuation"><span class="token annotation punctuation">@Override</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"doSomething реализация реального класса "</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">InterfaceA</span></span> objA <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">InterfacesImpl</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">InterfaceB</span></span> objB <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">InterfacesImpl</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">InterfaceC</span></span> objC <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">InterfacesImpl</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

        <span class="token comment"><span class="token comment">//все вызываемые ниже методы получат одинаковую реализацию конкретного класса</span></span>

        objA<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        objB<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        objC<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Можливо, ви звернули увагу, що я щоразу, коли я перевизначаю метод описаний у суперкласі або в інтерфейсі, я використовую анотацію @Override. Це одна з трьох вбудованих Java-анотацій і вам слід використовувати її при перевизначенні методів. 
 <h2>Композиція як порятунок</h2>Так що робити, якщо ми хочемо використовувати функцію 
 <code class=" language-none">methodA()</code>класу 
 <code class=" language-none">ClassA</code>і 
 <code class=" language-none">methodB()</code>класу 
 <code class=" language-none">ClassB</code>в 
 <code class=" language-none">ClassС</code>? Вирішенням цього може стати композиція – переписана версія, 
 <code class=" language-none">ClassC</code>що реалізує обидва методи класів 
 <code class=" language-none">ClassA</code>і 
 <code class=" language-none">ClassB</code>також має реалізацію 
 <code class=" language-none">doSomething()</code>для одного з об'єктів. 
 <code class=" language-none"><strong>ClassC.java</strong></code>
 <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">ClassC</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>

    <span class="token class-name"><span class="token class-name">ClassA</span></span> objA <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ClassA</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">ClassB</span></span> objB <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ClassB</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">test</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
        objA<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">methodA</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
        objA<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">methodA</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">methodB</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
        objB<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">methodB</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre>
 <h2>Композиція чи успадкування?</h2>Хорошим тоном програмування на Java є використовувати переваги композиції перед успадкуванням. Ми розглянемо деякі аспекти на користь такого підходу. 
 <ol>
  <li>
   <p>Припустимо, ми маємо наступну зв'язку класів батько-спадкоємець:</p>
   <p><code class=" language-none"><strong>ClassC.java</strong></code></p>
   <p></p>
   <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">ClassC</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">methodC</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
  	<span class="token punctuation"><span class="token punctuation">}</span></span>

<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre>
   <p></p>
   <p><code class=" language-none"><strong>ClassD.java</strong></code></p>
   <p></p>
   <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">ClassD</span></span> <span class="token keyword"><span class="token keyword">extends</span></span> <span class="token class-name"><span class="token class-name">ClassC</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">int</span></span> <span class="token function"><span class="token function">test</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">return</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre>
   <p></p>
   <p>Код вище чудово компілюється та працює, але що, якщо <code class=" language-none">ClassC</code>буде реалізовано інакше:</p>
   <p></p>
   <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">ClassC</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">methodC</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">test</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre>
   <p></p>
   <p>Зауважте, що метод <code class=" language-none">test()</code>вже існує у класі спадкоємця, але повертає результат іншого типу. Тепер <code class=" language-none">ClassD</code>, якщо ви використовуєте IDE, не буде скомпільовано. Вам буде рекомендовано змінити тип результату, що повертається в класі спадкоємця або в суперкласі.</p>
   <p>Тепер уявімо таку ситуацію, де є багаторівневе успадкування класів і суперклас не доступний для наших змін. Тепер, щоб позбутися помилки компіляції, ми не маємо інших варіантів, крім як змінити сигнатуру або ім'я методу підкласу. Також нам доведеться внести зміни до всіх місць, де цей метод викликався. Таким чином, успадкування робить наш код крихким.</p>
   <p>Проблема, описана вище, ніколи не зустрічається у разі композиції, і тому робить останню кращою перед успадкуванням.</p></li>
  <li>
   <p>Наступна проблема з наслідуванням полягає в тому, що ми демонструємо всі методи батька клієнту. І якщо суперклас розроблений не дуже коректно і містить дірки у «безпеці». Тоді, незважаючи на те, що ми повністю подбаємо про безпеку при реалізації нашого підкласу, ми все одно залежатимемо від неповної реалізації класу-батька.</p>
   <p>Композиція допомагає нам у забезпеченні контрольованого доступу до методів суперкласу, тоді як спадкування не підтримує жодного контролю за його методами. Це також одна з головних переваг композиції над спадкуванням.</p></li>
  <li>
   <p>Ще одна перевага композиції – те, що вона додає гнучкості при виклику методів. Реалізація класу <code class=" language-none">ClassC</code>, описана вище, не оптимальна і використовує раннє зв'язування з методом, що викликається. Мінімальні зміни дозволять нам зробити виклик методів гнучким та забезпечити пізнє зв'язування (зв'язування під час виконання).</p>
   <p><code class=" language-none"><strong>ClassC.java</strong></code></p>
   <p></p>
   <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">com<span class="token punctuation"><span class="token punctuation">.</span></span>journaldev<span class="token punctuation"><span class="token punctuation">.</span></span>inheritance</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">ClassC</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">SuperClass</span></span> obj <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">null</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">ClassC</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">SuperClass</span></span> o<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">this</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>obj <span class="token operator"><span class="token operator">=</span></span> o<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">test</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
        obj<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">doSomething</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span> args<span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">ClassC</span></span> obj1 <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ClassC</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ClassA</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">ClassC</span></span> obj2 <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ClassC</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ClassB</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

        obj1<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">test</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        obj2<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">test</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre>
   <p></p>
   <p>Програма виведе на екран:</p>
   <p></p>
   <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><code class="  language-java">doSomething implementation of <span class="token class-name"><span class="token class-name">A</span></span>
doSomething implementation of <span class="token class-name"><span class="token class-name">B</span></span></code></pre>
   <p></p>
   <p>Ця гнучкість при виклику методу не спостерігається при успадкування, що змушує використовувати композицію як найкращий підхід.</p></li>
  <li>
   <p>Модульне тестування простіше у разі композиції, тому що ми знаємо, що для всіх методів, які використовуються в суперкласі, ми можемо поставити заглушку для тестів, у той час як у спадкуванні ми сильно залежимо від суперкласу і не знаємо, як методи класу-батька будуть використані. Таким чином, через спадкування нам доведеться тестувати всі методи суперкласу, що є зайвою роботою.</p>
   <p>В ідеалі, успадкування слід використовувати лише тоді, коли відношення ” <em>is-a</em> ” справедливе для класів батька та спадкоємця, інакше варто віддати перевагу композиції.</p></li>
 </ol>
 <a href="http://www.journaldev.com/1775/multiple-inheritance-in-java-and-composition-vs-inheritance" rel="nofollow"><em>Оригінал статті</em></a>
</cut>