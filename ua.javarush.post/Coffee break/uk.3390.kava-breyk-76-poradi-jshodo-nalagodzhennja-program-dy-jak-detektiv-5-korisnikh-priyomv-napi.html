Кава-брейк #76. Поради щодо налагодження програм: дій як детектив. 5 корисних прийомів написання чистого коду
<p>----------------------------------------</p>
Джерело: Щоб ефективно налагоджувати програмне забезпечення, розробнику потрібно мати навички детектива. У міру свого професійного розвитку я не лише розширила свої знання про різні способи несподіваного виходу програм з ладу, а й відточила
<p>----------------------------------------</p>
<h2 id="topic1">Поради щодо налагодження програм: дій як детектив</h2>Джерело: <a href="https://aboutmonica.com/blog/tips-for-debugging-software-like-a-detective" rel="nofollow" target="_blank">About Monica</a> Щоб ефективно налагоджувати програмне забезпечення, розробнику потрібно мати навички детектива. У міру свого професійного розвитку я не лише розширила свої знання про різні способи несподіваного виходу програм з ладу, а й відточила налагодження. <img data-max-width="800" data-id="651f5811-98d6-4017-99d3-387f5616b321" alt="Кава-брейк #76.  Поради щодо налагодження програм: дій як детектив.  5 корисних прийомів написання чистого коду - 1" src="https://cdn.javarush.com/images/article/651f5811-98d6-4017-99d3-387f5616b321/800.jpeg" style="width: 800px;">У цій статті я розповім про різні підходи до розуміння того, чому комп'ютер, як здається, не робить те, що ви йому кажете.
<h3>1. Скористайтеся лінтером</h3>Виконайте лінтинг. Чи підсвічуються якісь синтаксичні помилки? Чи не посилається ваш код на невизначену змінну? Куди частіше, ніж мені хотілося б, мій код не компілювався (локально) через червону букву «f», яку я якимось чином додала до випадкового рядка. Цей недоречний символ часто забирається під час лінтингу. Але якщо програма успішно скомпільована, а мені хочеться переглянути зміни самостійно, я користуюся <a href="https://dev.to/m0nica/tips-for-debugging-software-like-a-detective-2oab" rel="nofollow" target="_blank">Git Lens</a> . Цей інструмент допомагає виявити, чи не виділяється щось у коді, як невідповідне. Не лякайтеся, якщо у вашому терміналі, консолі браузера або веб-сторінці висякують інші помилки. Вони можуть допомогти вам розібратися, що відбувається не так. Якщо ви поки що звикаєте до повідомлень про помилки, ознайомтеся з<a href="https://nickymeuleman.netlify.app/blog/love-errors" rel="nofollow" target="_blank">порадами Нікі Мейлеман</a> про те, як навчитися їх розуміти.
<h3>2. Змінюйте лише одну річ за раз</h3>У вас може виникнути спокуса змінити все одночасно. Але спробуйте просто змінити щось одне. І взагалі, перш ніж щось змінювати, подумайте, як ця конкретна зміна допоможе вам підтвердити чи спростувати ваші поточні припущення про проблему. Чи наблизить воно вас до потенційного рішення? Щоб перевірити, як зміни працюють у різних тестових випадках, стануть у нагоді автоматизовані тести. Вони також гарантують, що ви через недосвідченість не порушите вже існуючі тестові випадки, які раніше були пройдені.
<h3>3. Перевірте всі свої припущення</h3>Послідовно відтворюйте проблему вручну або за допомогою тестів. За яких умов система виходить з ладу? Щоб краще зрозуміти основну проблему, ви повинні визначити, в яких умовах програма поводиться несподівано. Для визначення коли саме код перестає працювати належним чином, використовуйте логи, брейкпоінти, тести, перевірки мережевих викликів і так далі. Якщо ви зрозумієте, коли трапляється помилка, це наблизить вас до розуміння того, чому вона відбувається. Чи повертає ваш API очікувані дані? Чи прив'язана проблема до середовища виконання? Чи немає пропущених змінних оточення?
<h3>4. Застосовуйте тести для підтвердження своїх припущень та перевірки потенційних рішень</h3>Підходьте до розробки через тестування за допомогою методу "червоний-зелений-рефакторинг". Це передбачає, що для початку ви пишете тест, що включає бажаний функціонал, і ваш код його не проходить (бо коду ще немає). Далі ви пишете код, який має пройти цей тест (результат змінюється із червоного на зелений). Після цього, коли у вас є робочий код, можна зайнятися рефакторингом, не турбуючись про те, що випадково порушите функціональність коду. При використанні цього методу виключається ситуація, коли ви створюєте надто велику частину функціоналу без тестування на працездатність. Git також має команду git bisect, яку можна використовувати для швидкого пошуку проблемного комміту. З її допомогою можна швидко знайти проблему шляхом перевірки конкретних комітів з історії git. Потім, залежно від того, чи ідентифікована ця проблема до або після введення регресії програмного забезпечення, наступна фіксація відбудеться або раніше, або пізніше в історії git, доки не буде виявлено винуватця. Git bisect можна комбінувати з автоматичним тестуванням, щоб зробити процес виявлення проблемної фіксації ще ефективнішим.
<h3>5. Вивчіть ваш код рядково</h3>Спробуйте прочитати код свіжим поглядом, навіть якщо для цього буде потрібна перерва в роботі. Буває, що наступного дня все стає набагато зрозумілішим. Вам не обов'язково постійно дивитися на екран монітора, щоб ваш мозок продовжував шукати рішення.
<h3>6. Перегляньте вихідний код стороннього пакета</h3>Перевірте, чи немає там відкритих іссу. Можливо, хтось інший теж зіткнувся із аналогічною проблемою. Якщо помилка може бути пов'язана зі стороннім програмним забезпеченням, перегляньте його вихідний код.
<h3>7. Google - ваш найкращий друг</h3>Швидкий пошук може стати найкращим другом розробника. Якщо ви використовуєте нову функцію або пакет, спробуйте знайти приклад, де вони вже працюють. Якщо ви хочете побачити код, що використовує ті ж API у контексті, рекомендую пошукати у вашому локальному репозиторії. Або можете пошукати репозиторії з відкритим кодом за допомогою <a href="https://grep.app/" rel="nofollow" target="_blank">grep.app</a> .
<h3>8. Дзвінок другу</h3>Раджу інтегрувати git blame у ваше середовище розробки. Я використовую плагін<a href="https://gitlens.amod.io/" rel="nofollow" target="_blank"> Git lens</a>, який показує, хто є автором певних змін файлів, прямо у цих файлух у редакторі коду. Також цей плагін показує пов'язаний pull request, що може бути корисним для швидкого отримання більшого контексту щодо рішень (ви можете переглянути цей pull request або безпосередньо звернутися до його автора). Ефективним способом налагодження та обміну знаннями може бути парне програмування. Я вже згадала про “чарівне” знаходження рішень після сну чи перерви. Є ще один корисний прийом: "качиний дебаггінг". Суть його в тому, що просте пояснення проблеми комусь іншому (навіть неживій гумовій качечці) може допомогти зробити рішення більш очевидним. Розібравшись із помилкою, не забудьте задокументувати отримані знання. Навіть якщо це буде лише невелика замітка для себе на майбутнє.
<h2 id="topiс2">5 корисних прийомів написання чистого коду</h2>Джерело: <a href="https://dev.to/ishakmohmed/the-art-of-writing-clean-code-my-5-go-to-tricks-4mcl" rel="nofollow" target="_blank">Dev.to</a> Будь-хто може навчитися писати код. Але ви можете писати його чисто? У цій статті я покажу свої методи написання чистого коду.<img data-max-width="800" data-id="c14085ef-277b-4078-abea-ef67f46f5eb2" alt="Кава-брейк #76.  Поради щодо налагодження програм: дій як детектив.  5 корисних прийомів написання чистого коду - 2" src="https://cdn.javarush.com/images/article/c14085ef-277b-4078-abea-ef67f46f5eb2/800.jpeg" style="width: 800px;">
<h3>1. Використовуйте палітру кольорів</h3>Використовуючи палітру кольорів, ви не тільки напишете більш чистий код, але й зможете змінити всю тему своєї програми, змінивши тільки 6 символів коду (посилаючись на шістнадцятковий код). Давайте подивимося на палітру кольорів, яку я використав у своєму проекті React Native. 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">// creating and exporting the color palette</span>
export <span class="token keyword">default</span> <span class="token punctuation">{</span>
  black<span class="token operator">:</span> <span class="token string">"#000"</span><span class="token punctuation">,</span>
  darkBlue<span class="token operator">:</span> <span class="token string">"#090446"</span><span class="token punctuation">,</span>
  darkGreen<span class="token operator">:</span> <span class="token string">"#002E27"</span><span class="token punctuation">,</span>
  green<span class="token operator">:</span> <span class="token string">"#00B14F"</span><span class="token punctuation">,</span>
  light<span class="token operator">:</span> <span class="token string">"#ede6e6"</span><span class="token punctuation">,</span>
  medium<span class="token operator">:</span> <span class="token string">"#6e6969"</span><span class="token punctuation">,</span>
  pink<span class="token operator">:</span> <span class="token string">"#fc5c65"</span><span class="token punctuation">,</span>
  purple<span class="token operator">:</span> <span class="token string">"#4530B3"</span><span class="token punctuation">,</span>
  white<span class="token operator">:</span> <span class="token string">"#FFFFFF"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">// using the palette (default import as colors)</span>
<span class="token keyword">const</span> styles <span class="token operator">=</span> <span class="token class-name">StyleSheet</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  foodName<span class="token operator">:</span> <span class="token punctuation">{</span>
    color<span class="token operator">:</span> colors<span class="token punctuation">.</span>white<span class="token punctuation">,</span>
    fontSize<span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
    fontWeight<span class="token operator">:</span> <span class="token string">"bold"</span><span class="token punctuation">,</span>
    margin<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  foodPrice<span class="token operator">:</span> <span class="token punctuation">{</span>
    color<span class="token operator">:</span> colors<span class="token punctuation">.</span>green<span class="token punctuation">,</span>
    fontSize<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
    margin<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> Тут я можу змінити зелений колір, вибравши інший відтінок, і для цього мені доведеться редагувати тільки основну палітру, а не всі файли проекту. Ви можете піти ще далі і оголосити первинні та вторинні кольори.
<h3>2. Сортуйте параметри та ключі за абеткою</h3>Це просто питання чистоти. Ось кілька прикладів: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class=" language-java">function <span class="token function">doSomething</span><span class="token punctuation">(</span>anArgument<span class="token punctuation">,</span> anotherArgument<span class="token punctuation">,</span> bIsAfterA<span class="token punctuation">,</span> cIsAfterB<span class="token punctuation">,</span> moreArgument<span class="token punctuation">,</span> zIsTheLastAlphabet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// do something...</span>
<span class="token punctuation">}</span></code></pre>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java">container<span class="token operator">:</span> <span class="token punctuation">{</span>
  backgroundColor<span class="token operator">:</span> colors<span class="token punctuation">.</span>darkGreen<span class="token punctuation">,</span>
  borderRadius<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  justifyContent<span class="token operator">:</span> <span class="token string">"space-around"</span><span class="token punctuation">,</span>
  margin<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  padding<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  width<span class="token operator">:</span> <span class="token number">180</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">180</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre>
<h3>Робіть імена виразними, навіть якщо вони при цьому будуть довгими</h3>Всі радять писати код коротше, і це справді має сенс. Але коли справа стосується імен змінних та функцій, можна зробити виняток. Давайте подивимося на прикладі: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">const</span> handlePress <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something...</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> handlePress2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something...</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> handlePress3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something...</span>
<span class="token punctuation">}</span></code></pre> Якщо у вас невелика програма, можна зупинитися на варіанті найменувань, наведеному вище. Але уявіть, що йдеться про масштабні проекти у великій компанії, де багато розробників працюють над величезною кодовою базою. Повірте, останнє, що вам захочеться посеред напруженого трудового дня, це вичитувати погано написаний код і намагатися вгадати, як він працює. Ось більш відповідні імена тих самих функцій: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">const</span> handlePressAddButton <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something...</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> handlePressCrossButton <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something...</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> handlePressCircularView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something...</span>
<span class="token punctuation">}</span></code></pre>
<h3>4. Створюйте структуру директорій, що розширюється, навіть для маленьких проектів</h3>Це, мабуть, найважливіший момент у цій статті. На мій погляд, створити структуру проекту, що розширюється, нескладно. Все, що вам потрібно, це пошукати в Google зразок для вашого стеку технологій. Тим часом цей крок принесе користь протягом усього циклу розробки. Ось скріншот структури одного з моїх проектів:<img data-max-width="256" data-id="a9b25ee1-c16a-4afa-87b1-b7c3263fbd07" alt="Кава-брейк #76.  Поради щодо налагодження програм: дій як детектив.  5 корисних прийомів написання чистого коду – 3" src="https://cdn.javarush.com/images/article/a9b25ee1-c16a-4afa-87b1-b7c3263fbd07/256.jpeg" style="width: 256px;">
<h3>5. Створюйте невеликі, багаторазові компоненти, що розширюються.</h3>Ось приклад багаторазового компонента React: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java">function <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">{</span> children<span class="token punctuation">,</span> style<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>otherProps <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>h1 style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>styles<span class="token punctuation">.</span>myCustomStyle<span class="token punctuation">,</span> style<span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>otherProps<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>children<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Тут ми повністю готовий тег h1 з дефолтними стилями. Все, що вам потрібно, це використовувати його у своєму додатку. А завдяки останньому параметру REST у компонента Text можуть бути додаткові властивості, а можуть і не бути за вашим бажанням. Але це ще не все. Стиль цього компонента написаний так, щоб бути самодостатнім, але його можна розширювати або перезаписувати (параметр style).