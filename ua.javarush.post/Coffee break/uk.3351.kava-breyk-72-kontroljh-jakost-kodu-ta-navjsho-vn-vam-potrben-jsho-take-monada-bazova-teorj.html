Кава-брейк #72. Контроль якості коду та навіщо він вам потрібен. Що таке монада? Базова теорія для Java-розробника
<p>----------------------------------------</p>
Джерело: Якість коду - важлива річ, вірно? Все це знають і всі погоджуються з цим. Але чому тоді більшість софтверних компаній: У цій статті я збираюся зосередитись на третій проблемі, а саме на . Якщо команда не контролює якість вихідного 
<p>----------------------------------------</p>
<h2 id="topic1">Контроль якості коду та навіщо він вам потрібен</h2>Джерело: <a href="https://dzone.com/articles/code-quality-control-and-why-you-need-it" rel="nofollow" target="_blank">DZone</a> Якість коду - важлива річ, вірно? Все це знають і всі погоджуються з цим. Але чому тоді більшість софтверних компаній:
<ul>
 <li>не мають визначення якості коду,</li>
 <li>непослідовно використовують стандарти якості коду,</li>
 <li><span class="text-bold">Чи не контролюють якість свого коду?</span></li>
</ul>У цій статті я збираюся зосередитись на третій проблемі, а саме на <span class="text-bold">відсутності контролю за якістю коду</span> . <img data-max-width="800" data-id="849d9400-10ae-4b6d-bd5c-910bfd1dd868" alt="Кава-брейк #72.  Контроль якості коду та навіщо він вам потрібен.  Що таке монада?  Базова теорія для Java-розробника - 1" src="https://cdn.javarush.com/images/article/849d9400-10ae-4b6d-bd5c-910bfd1dd868/800.jpeg" style="width: 800px;">Якщо команда не контролює якість вихідного коду, то як вона визначає, що розробники справді створюють ефективне програмне забезпечення? Низька якість коду погіршує продуктивність та ефективність робочого процесу. Більше того, чи поінформовані вони про те, що їхній <a href="https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D1%85%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%B4%D0%BE%D0%BB%D0%B3" rel="nofollow" target="_blank">технічний борг</a> може збільшуватися? І, як наслідок, зросте вартість додавання нових фіч.
<h3>Технічний обов'язок?</h3>Про технічний обов'язок написано сотні текстів, але <a href="https://martinfowler.com/articles/is-quality-worth-cost.html" rel="nofollow" target="_blank">цей</a> , написаний Мартіном Фаулером, добре розкриває тему. Отже, що буде, якщо не виплатити технічний борг (або, іншими словами, до чого призводить відсутність роботи над покращенням коду)? <span class="text-bold">Якщо ви погано дбаєте про свій код</span> , то це призводить до таких наслідків:
<ol>
 <li>Код не відповідає сучасним стандартам написання коду.</li>
 <li>Страждають показники якості вашого коду.</li>
 <li>Виникають проблеми із тестуванням вашого коду.</li>
 <li>Доводиться витрачати зайвий час на покращення якості коду (рефакторинг).</li>
 <li>Ви <span class="text-bold">більше часу та зусиль витрачаєте на супровід коду</span> , а не на розробку.</li>
</ol>Може спочатку ці проблеми ви і не помітите, але з часом все стане ясно. <em>«Як і у випадку з грошовим боргом, якщо технічний борг не погашено, він може накопичувати «відсотки», що ускладнює реалізацію змін». </em> Це був своєрідний фінансовий погляд на наслідки поганої якості коду. Але погляньмо на цю проблему <span class="text-bold">з точки зору розробників</span> програмного забезпечення. Що для нас означає <span class="text-bold">погану якість коду</span> та великий технічний обов'язок?
<ol>
 <li><span class="text-bold">Підвищений рівень стресу</span> , оскільки можна не встигнути до дедлайну. Щоб додати щось у код, треба більше часу.</li>
 <li><span class="text-bold">Знову ж таки, збільшення рівня стресу</span> , тому що на вихідних вам доводиться займатися вирішенням проблем із кодом.</li>
 <li><span class="text-bold">Втомлива та нудна робота</span> замість творчого та приємного кодингу.</li>
 <li><span class="text-bold">"Чому це займає стільки часу?" </span>— питання, яке ваше керівництво повторює дедалі частіше.</li>
 <li><span class="text-bold">Розчарування від роботи з поганим кодом</span> . Вам це знайоме, правда? ;)</li>
</ol>Добре, тепер ми знаємо, наскільки погано може бути, якщо недостатньо піклуємося про наш код. Але що ми можемо з цим поробити?
<h3>Процес контролю якості коду</h3>Я майже впевнений, ви знаєте, що не існує чарівної палички, яка могла б перетворити поганий код на надійний. Особливо за день. Але це не означає, що ми не можемо нічого вдіяти. Ми можемо <span class="text-bold">побудувати процес</span> . Це може бути серія повторюваних кроків, які:
<ul>
 <li><span class="text-bold">допомагають підтримувати якість коду</span> високому рівні для проектів, у яких якість вже задовільна;</li>
 <li><span class="text-bold">показують, що, де і як потрібно змінити</span> існуючий код, щоб поліпшити його якість.</li>
</ul>Однак робити все вручну – не найкращий варіант. По-перше, це неефективно. По-друге, можуть виникнути помилки. Ви колись пропускали очевидну помилку в коді під час перевірки коду? Я, наприклад, так… :( Більше того, іноді помилки навіть не виявляються під час тестування (звичайно, ручного), але з'являються першого ж дня після релізу...
<h3>Автоматизація – ключ до успіху</h3>Ручна перевірка коду гірша, ніж автоматична. <span class="text-bold">Автоматизація</span> може зняти тягар постійної перевірки коду. Це дозволить вам зосередитись на вирішенні реальних проблем за допомогою програмного забезпечення, а не на вирішенні <span class="text-bold">проблем самого програмного забезпечення.</span>. У світі Java-розробки існує багато інструментів, здатних допомогти вам в автоматизації перевірки та покращення якості коду. Я не знаю жодного інструменту, який міг би перетворити ваш застарілий, погано спроектований та погано закодований проект у добре організований та легко підтримуваний. Принаймні не зараз. І не все можна повністю автоматизувати (наприклад, реву коду). Але чи можемо ми позбутися багатьох помилок коду, що важко виявлятися, і зробити наш код чистішим і надійнішим на самому початку циклу розробки ( <a href="https://www.techopedia.com/definition/22193/software-development-life-cycle-sdlc" rel="nofollow" target="_blank">SDLC</a> )? Що ще важливіше, автоматизуючи процес, ми можемо досягти цього, витративши лише невелику кількість зусиль та часу порівняно з роботою вручну. І все це перед тим, як команда тестувальників візьметься за справу. ;)
<h3>Що перевіряти?</h3>Тепер ми знаємо, що нам потрібний процес. Більше того, ми знаємо, що він має бути максимально автоматичним. Але що ми маємо перевірити? Ми можемо розділити весь процес перевірки вихідного коду на 7 областей:
<ul>
 <li>перевірка стилю оформлення коду,</li>
 <li>перевірка коректності коду та виявлення типових помилок,</li>
 <li>виявлення недоліків конструкції,</li>
 <li>розрахунок складності коду,</li>
 <li>перевірка безпеки коду та залежностей,</li>
 <li>розрахунок покриття коду,</li>
 <li>огляд коду.</li>
</ul>
<h3>Висновок</h3>Якість коду – це дуже важлива тема і щодо неї є багато різних думок. Але що б ви не думали про якість коду, це все одно впливає на наше (розробників) життя. Це може покращити якість нашого життя або погіршити його. Ви можете пишатися своїм кодом, або вам може бути за нього соромно. Ви можете вирішувати реальні проблеми або виконувати стомлюючі та повторювані завдання щодня. Недостатньо навчати розробників, організовувати тренінги чи робити презентації якість коду. Наявність процесу забезпечення якості коду є обов'язковою, якщо компанія серйозно ставиться до створення програмного забезпечення. Навіть у «зіркових» командах розробників.
<h2 id="topic2">Що таке монада? Базова теорія для Java-розробника</h2>Джерело: <a href="https://dzone.com/articles/what-is-a-monad-basic-theory-for-a-java-developer" rel="nofollow" target="_blank">DZone</a> Як можна здогадатися із назви, основною темою цієї статті будуть монади. За допомогою класу <span class="code">Optional</span> Java я постараюся описати їх докладно, поринувши в структуру і внутрішню роботу монад. Наприкінці публікації я реалізую монаду для ліг, а потім опишу роль кожного основного фрагмента коду і наведу простий приклад його використання.<img data-max-width="800" data-id="f54ea8ef-0475-4991-9482-d0b3baed87d7" alt="Кава-брейк #72.  Контроль якості коду та навіщо він вам потрібен.  Що таке монада?  Базова теорія для Java-розробника - 2" src="https://cdn.javarush.com/images/article/f54ea8ef-0475-4991-9482-d0b3baed87d7/800.jpeg" style="width: 800px;">
<h3>Навіщо вивчати, як працюють монади?</h3>Завжди добре мати базове уявлення про те, як працюють речі, які ми використовуємо. Якщо ви Java-розробник, ви, ймовірно, використовуєте монади, навіть не підозрюючи про це. Дві з найвідоміших фіч Java 8 - це монадні реалізації, а саме Stream і Optional. Почнемо з опису, що таке монада. На мою думку, тут все досить просто. 
<center>
 <em>«Монада – це просто моноїд у категорії ендофункторів».</em>
</center> Це була цитата з книги <a href="https://link.springer.com/book/10.1007/978-1-4612-9839-7" rel="nofollow" target="_blank">Категорії для практикуючих математиків</a> Сондерса Маклейна. А тепер давайте серйозно...
<h2>Що таке монада?</h2>Це концепція, а чи не клас чи інтерфейс. Звичайно, надалі її можна реалізувати як клас чи інтерфейс. Це можна зробити практично будь-якою мовою зі статичною типізацією з підтримкою універсальних типів. Більше того, ми можемо розглядати її як оболонку, яка поміщає наше значення в певний контекст і дозволяє виконувати операції зі значенням. У цьому контексті вихідні дані операції на будь-якому етапі є вхідними даними для операції на наступному етапі. Приклади монад у сучасних мовах програмування:
<ul>
 <li>Stream (Java).</li>
 <li>Optional/Option (Java/Scala).</li>
 <li>Either (Scala).</li>
 <li>Try (Scala).</li>
 <li>IO Monad (Haskell).</li>
</ul>
<h3>Правила монад</h3>Останнє, що треба згадати, говорячи про монади, — це їхні правила. Якщо ми хочемо розглядати нашу реалізацію як справжню монаду, ми повинні їх дотримуватися. Є три правила: <span class="text-bold">ліва ідентичність</span> , <span class="text-bold">права ідентичність</span> та <span class="text-bold">асоціативність</span> . За допомогою класу <span class="code">Optional</span> я постараюсь докладніше пояснити ці правила. Але спочатку кілька визначень:
<ul>
 <li>F є функцією з підписом: <span class="code">(T -&gt; Optional&lt;U&gt;) = Optional&lt;U&gt;</span> .</li>
 <li>G - функція з підписом <span class="code">(A -&gt; Optional&lt;B&gt;) = Optional&lt;B&gt;</span> .</li>
 <li><span class="code">FG = F.apply(value).flatMap(G)</span> з підписом: <span class="code">(T -&gt; Optional&lt;B&gt;) = Optional&lt;B&gt;</span> .</li>
</ul>
<h4>Ліва ідентичність</h4>Якщо ми створимо нову монаду і прив'яжемо її до функції, результат має бути таким самим, як при застосуванні функції до значення: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java"><span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">F</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">F</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<h4>Права ідентичність</h4>Результат прив'язки одиничної функції до монади має бути таким самим, як і при створенні нової монади: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java"><span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">Optional</span><span class="token operator">::</span><span class="token function">of</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<h4>Асоціативність</h4>У ланцюжку функціональних програм не важливо, як функції вкладені: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">B</span><span class="token punctuation">&gt;</span></span> leftSide <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">F</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">G</span><span class="token punctuation">)</span>

<span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">B</span><span class="token punctuation">&gt;</span></span> rightSide <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">F</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">G</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

leftSide<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>rightSide<span class="token punctuation">)</span><span class="token punctuation">.</span></code></pre>
<h3>Створення монади</h3>Перше, що нам потрібно, це параметризований тип M&lt;T&gt;, оболонка для нашого значення типу T. Наш тип має реалізовувати дві функції:
<ul>
 <li><span class="code">Unit</span> - використовується для надбудови (wrapper) нашого значення і має підпис <span class="code">(T) = M&lt;T&gt;</span> .</li>
 <li><span class="code">Bind</span> - відповідає за виконання операцій. Тут ми передаємо функцію, яка працює зі значенням у нашому контексті та повертає його з іншим типом, уже укладеним у контекст. Цей метод повинен мати наступний підпис <span class="code">(T -&gt; M&lt;U&gt;) = M&lt;U&gt;</span> .</li>
</ul>Щоб зробити все зрозумілішим, я ще раз скористаюся <span class="code">Optional</span> і покажу, як у даному випадку виглядає наведена вище структура. Тут перша умова виконується відразу, тому що <span class="code">Optional</span> це параметризований тип. Роль функції <span class="code">unit</span> виконують <span class="code">методиnullable</span> і <span class="code">of</span> . <span class="code">FlatMap</span> відіграє роль функції <span class="code">bind</span> . Звичайно, у випадку <span class="code">Optional</span> , межі типів дозволяють використовувати більш складні типи, ніж у визначенні вище.
<h3>Закінчивши з теорією, приступимо до реалізації</h3>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//imports</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">T</span> value<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> LOGGER <span class="token operator">=</span>
      <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">LogMonad</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">LogMonad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">LogMonad</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">"value is null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">LogMonad</span><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> function<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>function<span class="token punctuation">,</span> <span class="token string">"function is null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> function<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Level</span><span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> <span class="token string">"{0}"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Level</span> loggingLevel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>loggingLevel<span class="token punctuation">,</span> <span class="token string">"logging level is null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>loggingLevel<span class="token punctuation">,</span> <span class="token string">"{0}"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">//equals, hashCode &amp; toString</span>
<span class="token punctuation">}</span></code></pre> І вуаля, монада реалізована. Докладно опишемо, що саме я тут зробив.
<h3>Що саме тут сталося</h3>Основою нашої реалізації є параметризований клас з незмінним полем з ім'ям <span class="code">value</span> , який відповідає за збереження нашого значення. Друге поле - <span class="code">Logger</span> , відповідатиме за ключовий ефект нашої монади. Потім у нас є приватний конструктор, який унеможливлює створення об'єкта будь-яким іншим способом, крім за допомогою нашого методу надбудови. Далі ми маємо дві основні функції монад, а саме <span class="code">of</span> (еквівалент <span class="code">unit</span> ) і <span class="code">flatMap</span> (еквівалент <span class="code">bind</span>), які гарантують, що наша реалізація виконує необхідні умови у формі законів монад. Останні два методи відповідають за ефект монади, тобто вони відповідають за запис поточного значення стандартний висновок. Один із них дозволяє пройти рівень логування, інший використовує рівень "INFO". Тепер настав час для прикладу використання. Отож він. 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//imports</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">T</span> value<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> LOGGER <span class="token operator">=</span>
      <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">LogMonad</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">LogMonad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">LogMonad</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">"value is null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span></span> <span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">LogMonad</span><span class="token punctuation">&lt;</span><span class="token class-name">U</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> function<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>function<span class="token punctuation">,</span> <span class="token string">"function is null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> function<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Level</span><span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> <span class="token string">"{0}"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">LogMonad</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Level</span> loggingLevel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>loggingLevel<span class="token punctuation">,</span> <span class="token string">"logging level is null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>loggingLevel<span class="token punctuation">,</span> <span class="token string">"{0}"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">//equals, hashCode &amp; toString</span>
<span class="token punctuation">}</span></code></pre> У наведеному вище коді, крім того, що ми бачимо, як працюють монади, ми також можемо оцінити кілька плюсів їх використання. Насамперед, ми інкапсулюємо наш побічний ефект логування в монадичний контекст. Це забезпечило шар абстракції над нашою логікою. Завдяки цій абстракції ми змогли зменшити кількість шаблонів. Наш код став більш декларативним, більш простим для читання та розуміння. Нарешті ми об'єднали всі операції в єдиний конвеєр. З іншого боку, у немонадичній частині прикладу ми можемо побачити всі деталі реалізації. Код менш дескриптивний і можна використовувати повторно. Більш того, ми виявабо побічний ефект, який може спричинити деякі проблеми в майбутньому і зробабо наш код менш читабельним. Якщо ми вирішимо обробити помилку через виклик функції, нам знадобиться багато шаблонів. На мій погляд,
<h3>Підбиваємо підсумки</h3>Монада – дуже корисне поняття. Ймовірно, багато хто з нас використовує його в повсякденному житті. У цій статті я спробував дати просте пояснення його теоретичної основи та логіки, що лежить в основі поняття. Я впровадив<span class="code"> LogMonad</span> щоб показати, що це супер складно, і насправді його можна досить легко реалізувати. На прикладі я показав, як може виглядати використання монади, які потенційні переваги такої дії і чим вона може відрізнятись від звичайного виклику методів.