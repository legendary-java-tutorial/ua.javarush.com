Повертайте масив нульової довжини, а не null
<p>----------------------------------------</p>
Нерідко зустрічаються методи, що мають такий вигляд: Немає причин розглядати як особливий випадок ситуацію, коли у продажу немає сиру. Це вимагає від клієнта написання додаткового коду для обробки значення, що повертається методом , наприкл
<p>----------------------------------------</p>
Нерідко зустрічаються методи, що мають такий вигляд: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">private</span></span> <span class="token class-name"><span class="token class-name">List</span></span> cheesesInStock <span class="token operator"><span class="token operator">=</span></span> … <span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token comment"><span class="token comment">/**
* @return массив, содержащий все сыры, имеющиеся в магазине,
* або null, если сыров для продажи нет.
*/</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">Cheese</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> <span class="token function"><span class="token function">getCheeses</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
<span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>cheesesInStock<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">size</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token operator"><span class="token operator">==</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
<span class="token keyword"><span class="token keyword">return</span></span> <span class="token keyword"><span class="token keyword">null</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Немає причин розглядати як особливий випадок ситуацію, коли у продажу немає сиру. Це вимагає від клієнта написання додаткового коду для обробки значення, що повертається методом <code class=" language-none">пull</code>, наприклад: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">Cheese</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> cheeses <span class="token operator"><span class="token operator">=</span></span> shop<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getCheeses</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>cheeses <span class="token operator"><span class="token operator">!</span></span> <span class="token operator"><span class="token operator">=</span></span> пull <span class="token operator"><span class="token operator">&amp;&amp;</span></span>
Аrrауs<span class="token punctuation"><span class="token punctuation">.</span></span>а<span class="token function"><span class="token function">sList</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>shор<span class="token punctuation"><span class="token punctuation">.</span></span>gеtСhееsе<span class="token function"><span class="token function">s</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>соntа<span class="token function"><span class="token function">ins</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>Сhееsе<span class="token punctuation"><span class="token punctuation">.</span></span>SТILТON<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
<span class="token class-name"><span class="token class-name">S</span></span>уstеm<span class="token punctuation"><span class="token punctuation">.</span></span>оut<span class="token punctuation"><span class="token punctuation">.</span></span>р<span class="token function"><span class="token function">rintln</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Jоllу good, just the thing."</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> замість простого: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">if</span></span>  <span class="token punctuation"><span class="token punctuation">(</span></span>Аrrаys<span class="token punctuation"><span class="token punctuation">.</span></span>а<span class="token function"><span class="token function">sList</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>shор<span class="token punctuation"><span class="token punctuation">.</span></span>gеtСhееsе<span class="token function"><span class="token function">s</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>соntа<span class="token function"><span class="token function">ins</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>Сhееsе<span class="token punctuation"><span class="token punctuation">.</span></span>SТILTON<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token class-name"><span class="token class-name">S</span></span>уstеm<span class="token punctuation"><span class="token punctuation">.</span></span>оut<span class="token punctuation"><span class="token punctuation">.</span></span>р<span class="token function"><span class="token function">rintln</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Jоllу good, just the thing."</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Така багатомовність необхідна майже при кожному виклику методу, який замість масиву нульової довжини повертає null. Це може призвести до помилок, оскільки розробник клієнта міг і не написати спеціальний код для обробки результату <code class=" language-none">null</code>. Помилка може залишатися непоміченою роками, оскільки подібні методи зазвичай повертають один або кілька об'єктів. Слід ще згадати, що повернення<code class=" language-none">null</code>замість масиву призводить до ускладнення самого методу, що повертає масив. Іноді можна почути заперечення, що повернення значення null краще, ніж повернення масиву нульової довжини тому, що це дозволяє уникнути витрат на розміщення масиву в пам'яті. Цей аргумент неспроможний із двох причин. По-перше, на цьому рівні немає сенсу турбуватися про продуктивність, якщо тільки профіль програми не покаже, що саме цей метод є основною причиною падіння продуктивності. По-друге, при кожному виклику методу, який не повертає записів, клієнту можна передавати той самий масив нульової довжини, оскільки будь-який масив нульової довжини незмінний, а незмінні об'єкти доступні для спільного використання. Насправді, саме це і відбувається, 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">private</span></span> <span class="token class-name"><span class="token class-name">List</span></span> сhееsеsInStосk <span class="token operator"><span class="token operator">=</span></span> … <span class="token punctuation"><span class="token punctuation">,</span></span>
<span class="token keyword"><span class="token keyword">private</span></span> fiпаl <span class="token keyword"><span class="token keyword">static</span></span> <span class="token class-name"><span class="token class-name">Cheese</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> NULL_CHEESE_ARRAY <span class="token operator"><span class="token operator">=</span></span> nеw <span class="token class-name"><span class="token class-name">Cheese</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">]</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
 <span class="token comment"><span class="token comment">/**
* @геtuгп массие, содержащий все сыры, имеющиеся в магазине
*/</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">Cheese</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> <span class="token function"><span class="token function">getCheeses</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
геtuгп <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Cheese</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> сhееsеsInStосk<span class="token punctuation"><span class="token punctuation">.</span></span>tоАггау<span class="token punctuation"><span class="token punctuation">(</span></span>NULL_СНЕЕ<span class="token class-name"><span class="token class-name">S</span></span>Е_АRRАУ<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> У цій ідіомі константа у вигляді <a href="https://codegym.cc/groups/posts/1398-java-massivih" target="_blank">масиву</a> нульової довжини передається методу <code class=" language-none">toArray</code>для того, щоб показати який тип він повинен повернути. Зазвичай метод <code class=" language-none">toArray</code>виділяє місце в пам'яті для масива, що повертається, проте якщо колекція порожня, вона розміщується у вхідному масиві, а специфікація<code class=" language-none">Сollесtion,tоАггау(Оbjесt[])</code>дає гарантію, що якщо вхідний масив буде достатньо місткий, щоб містити колекцію, буде повернено саме він. Тому представлена ​​ідіома ніколи не сама розміщувати в пам'яті масив нульової довжини, а в якості такого використовує "константу із зазначенням типу". Підведемо підсумки. Немає жодних причин для того, щоб метод, що працює з масивами, повертав значення null, а не масив нульової довжини. Така ідіома, мабуть, походить з мови програмування, де довжина масиву повертається окремо від самого масиву. У мові С марно виділяти пам'ять під масив нульової довжини. Джерело: Джошуа Блох, Java TM Ефективне програмування, Видавництво «Лорі»