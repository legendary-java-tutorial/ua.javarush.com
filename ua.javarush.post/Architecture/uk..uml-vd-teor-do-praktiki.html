UML: від теорії до практики
<p>----------------------------------------</p>
Я думаю, кожен чув у дитинстві таку приказку як " ". У програмуванні так само. Краще завжди продумати реалізацію до того, як ви витратите час на її виконання. Часто доводиться при реалізації створювати класи, вигадувати їхню взаємодію. І ча
<p>----------------------------------------</p>
<h2>Вступ</h2>Я думаю, кожен чув у дитинстві таку приказку як " <em>Сім разів відміряй, один раз відріж</em> ". У програмуванні так само. Краще завжди продумати реалізацію до того, як ви витратите час на її виконання. Часто доводиться при реалізації створювати класи, вигадувати їхню взаємодію. І часто візуальне уявлення про це може допомогти вирішити завдання найбільш правильним чином. У цьому нам і допомагає <strong>UML</strong> .
<h2>Що таке UML?</h2>
<div>
 <p>Якщо подивитися картинки в пошукових системах, то стане зрозуміло, що <strong>UML</strong> – це щось про схеми, стрілочки та квадратики. Що важливо, що UML перекладається як <em>Unified Modeling Language</em> . Важливе слово Unified. Тобто наші картинки зрозуміємо не лише ми, а й інші, хто знає UML. Виходить це така міжнародна мова малювання схем.</p><img data-id="acc16872-33f2-44c6-8f32-2d0aeb63c28d" data-max-width="800" alt="UML: від теорії до практики - 1" src="https://cdn.javarush.com/images/article/acc16872-33f2-44c6-8f32-2d0aeb63c28d/800.jpeg" style="width: 800px;">
</div>
<p align="right">Як говорить Вікіпедія</p>
<blockquote>
 UML – це мова графічного опису для об'єктного моделювання в галузі розробки програмного забезпечення, моделювання бізнес-процесів, системного проектування та відображення організаційних структур.
</blockquote> Найцікавіше, що не всі замислюються чи здогадуються, UML має специфікації. І навіть є специфікація UML2. Докладніше зі специфікацією можна ознайомитись на сайті <a href="https://www.omg.org/spec/UML/About-UML/" target="_blank" rel="nofollow">Object Management Group</a> . Власне, ця група займається розробкою специфікацій UML. Цікаво, що UML не обмежується описом структури класів. Існує багато типів UML діаграм. Короткий опис типів UML діаграм можна побачити в тій же Вікіпедії: <a href="https://ru.wikipedia.org/wiki/UML#%D0%94%D0%B8%D0%B0%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D1%8B" target="_blank" rel="nofollow">UML - діаграми</a> або відео Тимур Батиршинова <a href="https://www.youtube.com/watch?v=moMkpX9uSns" target="_blank" rel="nofollow">Огляд UML діаграм</a> . UML також широко застосовується при описі різних процесів, наприклад тут: <a href="https://www.ispring.ru/articles/ediniy-vhod-s-ispolzovaniem-jwt.html" target="_blank" rel="nofollow">Єдиний вхід з використанням JWT</a> . Повертаючись до використання UML діаграм класів, варто зазначити книгу<a href="https://goo.gl/gBRkMY" target="_blank" rel="nofollow">Head First: Паттерни проектування</a> , в якій патерни ілюструються тими самими UML діаграмами. Виходить, що UML справді використовується. І виходить, що знання та розуміння його застосування досить корисна навичка. 
<h2>Застосування</h2>Розберемо, як із цим UML можна працювати з IDE. Як IDE візьмемо <em>IntelliJ Idea</em> . Якщо використовувати <strong>IntelliJ Idea Ultimate</strong> , то у нас "з коробки" буде встановлений плагін " <strong>UML Support</strong> ". Він дозволяє автоматично генерувати чудові діаграми класів. Наприклад, через Ctrl+N або пункт меню "Navigate" -&gt; "Class" перейдемо до класу <strong>ArrayList</strong> . Тепер, через контекстне меню на ім'я класу виберемо "Diagram" -&gt; "Show diagram popup". В результаті ми отримаємо гарну діаграму: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="d1dd2cd5-f20a-4742-a780-a78415016940" data-max-width="627" alt="UML: від теорії до практики - 2" src="https://cdn.javarush.com/images/article/d1dd2cd5-f20a-4742-a780-a78415016940/512.jpeg" style="width: 627px;">
 </div>
</div>Але що якщо хочеться самому намалювати, та ще й немає Ultimate версії Idea? Якщо ми використовуємо IntelliJ Idea Community Edition, то ми не маємо іншого вибору. Для цього потрібно зрозуміти, як така схема UML влаштована. Для початку нам знадобиться встановити <a href="https://graphviz.gitlab.io/download/" target="_blank" rel="nofollow">Graphviz</a> . Це набір утиліт для візуалізації графів. Його використовує плагін, який ми будемо застосовувати. Після встановлення необхідно додати каталог <em>bin</em> з каталогу встановленого <em>Graphviz</em> до змінного середовища оточення <em>PATH</em> . Після цього IntelliJ Idea в меню вибрати File -&gt; Settings. У вікні "Settings" вибрати категорію "Plugins", натиснути кнопку "Browse repositories" та встановити плагін <a href="https://plugins.jetbrains.com/plugin/7017-plantuml-integration" target="_blank" rel="nofollow">PlantUML integration</a> . Чим такий гарний цей <em>PlantUML</em>? Він використовує для опису UML мову описи графів під назвою " <strong>dot</strong> " і це дозволяє бути більш універсальним, т.к. ця мова використовується не тільки PlantUML. Більш того, все, що ми нижче зробимо, ми можемо виконати не тільки в IDE, але і в онлайн сервісі <a href="https://www.planttext.com/" target="_blank" rel="nofollow">planttext.com</a> . Після встановлення плагіна PlantUML у нас з'явиться можливість через "File" -&gt; "New" створювати UML діаграми. Давайте виконаємо створення діаграми типу "UML class". У результаті автоматично генерується шаблон з прикладом. Видалимо його вміст і створимо свій, озброївшись статтею з Хабра: <a href="https://habr.com/post/150041/" target="_blank" rel="nofollow">Відносини класів - від UML до коду</a> . А щоб зрозуміти, як це зобразити в тексті, візьмемо мануал по PlantUML: <a href="http://plantuml.com/class-diagram" target="_blank" rel="nofollow">plantuml class-diagram</a>. У ньому на самому початку представлена ​​табличка про те, як потрібно описувати зв'язки: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="b9a03ed5-85f6-422c-91d5-7db479acc747" data-max-width="263" alt="UML: від теорії до практики - 3" src="https://cdn.javarush.com/images/article/b9a03ed5-85f6-422c-91d5-7db479acc747/256.jpeg" style="width: 263px;">
 </div>
</div>Про самі зв'язку можемо ще підглядати сюди: " <a href="http://deryabych.narod.ru/6/7.html" target="_blank" rel="nofollow">Відносини між класами в UML. Приклади</a> " . На основі цих матеріалів приступимо до створення нашої UML діаграми. Додамо такий вміст, що описує два класи: 
<pre class="line-numbers language-none" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-none">
@startuml
class ArrayList {
}
class LinkedList {
}
@enduml</code></pre> Щоб побачити результат у Idea, оберемо "View" -&gt; "Tool Windows" -&gt; "PlantUML". Ми отримаємо просто два квадрати, що позначають класи. Як ми знаємо, обидва ці класи реалізують інтерфейс List. Це ставлення класів і називають — реалізація (realization). Для зображення такого зв'язку використовують стрілку з пунктирною лінією. Зобразимо її: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">interface</span></span> <span class="token class-name"><span class="token class-name">List</span></span>
<span class="token class-name"><span class="token class-name">List</span></span> <span class="token operator"><span class="token operator">&lt;</span></span><span class="token operator"><span class="token operator">|</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token punctuation"><span class="token punctuation">.</span></span> <span class="token class-name"><span class="token class-name">ArrayList</span></span>
<span class="token class-name"><span class="token class-name">List</span></span> <span class="token operator"><span class="token operator">&lt;</span></span><span class="token operator"><span class="token operator">|</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token punctuation"><span class="token punctuation">.</span></span> <span class="token class-name"><span class="token class-name">LinkedList</span></span></code></pre><code class=" language-none">List</code>- Один з дочірніх класів <code class=" language-none">Collection</code>. Тобто успадковується від Collection. Цей зв'язок називається узагальненням (generalization). Виглядає як стрілка із звичайною безперервною лінією. Зобразимо її: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">interface</span></span> <span class="token class-name"><span class="token class-name">Collection</span></span>
<span class="token class-name"><span class="token class-name">Collection</span></span> <span class="token operator"><span class="token operator">&lt;</span></span><span class="token operator"><span class="token operator">|</span></span><span class="token operator"><span class="token operator">--</span></span> <span class="token class-name"><span class="token class-name">List</span></span></code></pre> Для наступного типу зв'язку додамо до опису класу <code class=" language-none">ArrayList</code>запис про <em>package private</em> масив елементів: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token operator"><span class="token operator">~</span></span><span class="token class-name"><span class="token class-name">Object</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> elementData</code></pre> Тепер ми хочемо показати, що <code class=" language-none">ArrayList</code>містить якісь об'єкти. У разі буде тип зв'язку — агрегація ( <em>aggregation</em> ). Агрегатом у разі є <code class=" language-none">ArrayList</code>, т.к. він містить інші об'єкти. Агрегацію ми вибираємо тому, що об'єкти у списку можуть жити без списку: вони не є його невід'ємними частинами. Їхній час життя не прив'язаний до часу життя списку. Агрегат з латинського перекладається як "зібраний", тобто щось складене з чогось. Наприклад, у житті є насосний агрегат, який складається з насоса та двигуна. Сам агрегат можна розібрати, залишивши щось із його складових частин. Наприклад, щоб продати чи поставити в інший агрегат. Так і у списку. І це виражається у вигляді порожнього ромбика біля агрегату і безперервної лінії. Зобразимо це так: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">Object</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token class-name"><span class="token class-name">ArrayList</span></span> o<span class="token operator"><span class="token operator">-</span></span> <span class="token class-name"><span class="token class-name">Object</span></span></code></pre> Тепер ми хочемо показати, що на відміну від <code class=" language-none">ArrayList</code>клас <code class=" language-none">LinkedList</code>містить в собі <code class=" language-none">Node</code>- контейнери, що посилаються на дані, що зберігаються. У разі <code class=" language-none">Node</code>є частиною самого <code class=" language-none">LinkedList</code>і що неспроможні жити окремо. <code class=" language-none">Node</code>не є безпосередньозбереженим вмістом, а лише містить посилання на нього. Наприклад, коли ми додаємо в <code class=" language-none">LinkedList</code>якийсь рядок, ми додаємо новий <code class=" language-none">Node</code>, який містить посилання на цей рядок, а також посилання на попередній і наступний <code class=" language-none">Node</code>. Такий тип зв'язку називається <em>композицією</em> (Composition). Для відображення у композита (того, хто складається з частин) малюється забарвлений робмик, до нього веде безперервна лінія. Запишемо тепер це у вигляді текстового відображення зв'язку: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">Node</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token class-name"><span class="token class-name">LinkedList</span></span> <span class="token operator"><span class="token operator">*</span></span><span class="token operator"><span class="token operator">--</span></span> <span class="token class-name"><span class="token class-name">Node</span></span></code></pre> І тепер необхідно навчитися відображати ще один важливий тип зв'язку – <em>залежність</em> (dependency relationship). Він використовується тоді, коли один клас використовує інший, при цьому клас не містить клас, що використовується, і не є його спадкоємцем. Наприклад, <code class=" language-none">LinkedList</code>і <code class=" language-none">ArrayList</code>вміють створювати <code class=" language-none">ListIterator</code>. Відобразимо це у вигляді стрілок з пунктирною лінією: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">ListIterator</span></span>
<span class="token class-name"><span class="token class-name">ListIterator</span></span> <span class="token operator"><span class="token operator">&lt;</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token punctuation"><span class="token punctuation">.</span></span> <span class="token class-name"><span class="token class-name">ArrayList</span></span> <span class="token operator"><span class="token operator">:</span></span> create
<span class="token class-name"><span class="token class-name">ListIterator</span></span> <span class="token operator"><span class="token operator">&lt;</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token punctuation"><span class="token punctuation">.</span></span> <span class="token class-name"><span class="token class-name">LinkedList</span></span> <span class="token operator"><span class="token operator">:</span></span> create</code></pre> Виглядатиме після всього це буде таким чином: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="340b3a27-e4a2-49bd-a217-a5b7fd0a5386" data-max-width="375" alt="UML: від теорії до практики - 4" src="https://cdn.javarush.com/images/article/340b3a27-e4a2-49bd-a217-a5b7fd0a5386/256.jpeg" style="width: 375px;">
 </div>
</div>Деталізувати можна настільки, наскільки це потрібно. Всі позначення вказані тут: " <a href="http://plantuml.com/class-diagram" target="_blank" rel="nofollow">PlantUML - діаграма класів</a> ". Крім того, у малюванні такої схеми немає нічого надприродного, і під час роботи над своїми завданнями її можна швидко малювати від руки. Це дозволить розвинути навички продумування архітектури програми та допоможе виявити недоліки структури класів на ранньому етапі, а не коли ви вже витратите день на реалізацію неправильної моделі. Мені здається, це непогана причина спробувати? ) 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="8ee40fef-a567-431e-b3be-b9d9a4691b1a" data-max-width="307" alt="UML: від теорії до практики - 5" src="https://cdn.javarush.com/images/article/8ee40fef-a567-431e-b3be-b9d9a4691b1a/256.jpeg" style="width: 307px;">
 </div>
</div>
<h2>Автоматизація</h2>Існують різні способи автоматичної генерації PlantUML діаграм. Наприклад, у <em>Idea</em> є плагін <a href="https://plugins.jetbrains.com/plugin/10387-sketch-it-" target="_blank" rel="nofollow">SketchIT</a> , але малює він їх не зовсім правильно. Скажімо, неправильно малюється імплементація інтерфейсів (відображається як спадкування). Також в інтернеті є приклади того, як це вбудувати у життєвий цикл складання вашого проекту. Допустимо, для <em>Maven</em> є приклад використання <a href="https://github.com/gboersma/uml-java-doclet/blob/master/README.md" target="_blank" rel="nofollow">uml-java-docklet</a> . Для того, щоб показати як це, скористаємося <a href="https://maven.apache.org/archetype/index.html" target="_blank" rel="nofollow">Maven Archetype</a> для швидкого створення Maven проекту. Виконаємо команду: <code class=" language-none">mvn archetype:generate</code> На питанні вибору фільтра ( <strong>Choose a number or apply filter</strong> ) залишаємо default, просто натиснувши Enter. Це завжди буде " <strong>maven-archetype-quickstart</strong>Далі відповідаємо на запитання і завершуємо створення проекту: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="819b0302-04f2-477c-af53-c3fa55720640" data-max-width="508" alt="UML: від теорії до практики - 6" src="https://cdn.javarush.com/images/article/819b0302-04f2-477c-af53-c3fa55720640/256.jpeg" style="width: 508px;">
 </div>
</div>Оскільки Maven не є метою цієї статті, відповіді на свої запитання щодо Maven можна знайти в <a href="https://maven.apache.org/users/index.html" target="_blank" rel="nofollow">Maven Users Centre</a> . У створеному проекті відкриємо на редагування файл опису проекту, <strong>pom.xml</strong> . У нього скопіюємо вміст із опису <a href="https://github.com/gboersma/uml-java-doclet/blob/master/README.md#installing" target="_blank" rel="nofollow">uml-java-docklet installing</a> . Артефакт, що використовується в описі, не вдалося знайти в репозиторії Maven Central. Але у мене запрацювало з цим: <a href="https://mvnrepository.com/artifact/com.chfourie/uml-java-doclet/1.0.0" target="_blank" rel="nofollow">https://mvnrepository.com/artifact/com.chfourie/uml-java-doclet/1.0.0</a> . Тобто треба в тому описі просто замінити <em>groupId</em> з " <em>info.leadinglight</em> " на " <em>com.chfourie</em> " і поставити версію " <em>1.0.0</em> ". Після цього можемо виконати у каталозі, де знаходиться файл<strong>pom.xml</strong> ці команди: <code class=" language-none">mvn clean install</code>і <code class=" language-none">mvn javadoc:javadoc</code>. Тепер, якщо відкрити згенеровану документацію (explorer targetsiteapidocsindex.html), ми побачимо UML схеми. До речі, імплементація тут вже відображається правильно. 
<div class="email-subscription">
 <iframe frameborder="0" src="https://secure.esputnik.com.ua/4Q0Ef6d2SOs" width="100%" height="200" scrolling="no" data-savepage-key="0-2"></iframe>
</div>
<h2>Висновок</h2>Як видно, UML дозволяє візуалізувати структуру вашої програми. Крім того, UML не обмежується лише цим. За допомогою UML можна описувати різні процеси всередині вашої компанії або описувати бізнес-процес, в рамках якого працює функція, яку ви пишете. Наскільки UML корисний особисто для вас - вирішувати вам, але знайти час і ознайомитися докладніше буде в будь-якому випадку корисно. #Viacheslav