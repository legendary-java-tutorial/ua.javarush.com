Структури даних: піраміда (двійкова купа) у Java
<p>----------------------------------------</p>
Привіт привіт! Ніхто не заперечуватиме, що алгоритми та структури даних — незаперечний фундамент програмування. Так, можна і працювати програмістом і без їх знання, але, на жаль, далеко ви так не поїдете. Тому щоб посилити вашу базу знань у
<p>----------------------------------------</p>
Привіт привіт! Ніхто не заперечуватиме, що алгоритми та структури даних — незаперечний фундамент програмування. Так, можна і працювати програмістом і без їх знання, але, на жаль, далеко ви так не поїдете. Тому щоб посаботи вашу базу знань у цій галузі, хотілося б поговорити про таку структуру даних як <span>піраміда</span> (ще відома як купа та двійкова купа). Зазвичай такі структури даних застосовують у різних планувальниках та інших структурах, у яких необхідно позначити пріоритетність різних завдань. Отже... <img width="800" height="500" data-id="ceae024f-6c99-45a5-a5ea-fb1b9f01a47c" alt="Структури даних: піраміда (двійкова купа) в Java - 1" src="https://cdn.javarush.com/images/article/ceae024f-6c99-45a5-a5ea-fb1b9f01a47c/1080.jpeg">Піраміда — це різновид дерева, який забезпечує <span>вставку/видалення</span> за час <span>O(logN)</span> і має наступні властивості:
<ul>
 <li>Повнота. Всі рівні дерева містять усі можливі вузли, крім останнього, який може бути заповнений лише частково і який заповнюється зліва-направо;</li>
 <li>Піраміда зазвичай реалізується з урахуванням масиву;</li>
 <li>Для кожного вузла в піраміді є основна умова, що значення кожного вузла більше (або одно) значення його нащадків. Відповідно, максимум зберігатиметься у верхньому елементі.</li>
</ul>Піраміда, що складається з вершин, які зберігають значення не вище 10: <img width="800" height="500" data-id="3043b4e0-231b-4e3d-8478-66aa0d1f1f79" alt="Структури даних: піраміда (двійкова купа) в Java - 2" src="https://cdn.javarush.com/images/article/3043b4e0-231b-4e3d-8478-66aa0d1f1f79/1080.jpeg">Хотілося б зазначити, що в порівнянні з деревом двійкового пошуку піраміда є <span>слабо впорядкованою</span> , тому що в дереві двійкового пошуку ключ лівого нащадка менший за ключ правого нащадка, а в піраміді така умова відсутня.
<h2>Видалення елемента за індексом</h2>Для початку давайте розглянемо, яка послідовність дій при видаленні обраного вузла:
<ol>
 <li>Видалити вибраний вузол.</li>
 <li>Перемістити останній вузол в останньому ряду на місце віддаленого.</li>
 <li>Зміщувати його вниз до тих пір, поки він не виявиться нижче більшого і вище меншого вузла.</li>
</ol>Коли використовують піраміду, то, як правило, необхідно вміти видаляти вершину (нульовий елемент внутрішнього масиву) або останній (тоді операції з переміщення можна опустити, залишивши тільки видалення елемента). Як приклад видалення елемента за індексом у піраміді, що розглядається нами, ми видалимо вузол зі значенням 7:
<ol>
 <li>
  <p>Видаляємо обраний вузол і поміщаємо на його місце останній, який має значення 4:</p><img data-id="3db4dc79-e943-41c6-a863-36901833ff04" data-max-width="512" alt="Структури даних: піраміда (двійкова купа) Java - 3" src="https://cdn.javarush.com/images/article/3db4dc79-e943-41c6-a863-36901833ff04/512.jpeg" style="width: 512px;">
  <p>Але в такому положенні даний вузол не відповідає умові, що кожен вузол нащадок не повинен бути більшим за розглянуте, чи не так?</p>
  <p>Тому:</p></li>
 <li>
  <p>Змінюємо його місцями з найбільшим із нащадків, який має значення 6:</p><img data-id="9189f7a4-64e3-408b-82df-81f93509f54d" data-max-width="512" alt="Структури даних: піраміда (двійкова купа) Java - 4" src="https://cdn.javarush.com/images/article/9189f7a4-64e3-408b-82df-81f93509f54d/512.jpeg" style="width: 512px;">
  <p>Далі дивимося, чи немає нащадків зі значенням більшим, ніж у нашого елемента, що зміщується, і бачимо що ні, а це означає, що елемент став на своє місце.</p></li>
</ol>
<h2>Вставлення нового елемента</h2>Які ж дії при вставці нового елемента:
<ol>
 <li>
  <p>Вузол, що вставляється, поміщається в кінець піраміди.</p>
  <p>Але ж у нас є умова, що дочірній елемент не може мати значення більше за батьківське, вірно?</p>
  <p>Тому:</p></li>
 <li>Порівнюємо новий елемент із батьківським елементом. Якщо новий елемент менше, то операція закінчена, якщо ні, він змінюється місцями з батьківським елементом. Потім починає порівнюватися з новим батьківським елементом, і так далі... Доти, доки батьківський елемент не буде більше нового.</li>
</ol>Наприклад, піраміду, яка була отримана в результаті видалення елемента, ми хочемо додати елемент зі значенням 8:
<ol>
 <li>
  <p>Поміщаємо новий вузол у кінець піраміди:</p><img data-id="307b5dd4-4c67-4574-994d-f14cd7731d8c" data-max-width="512" alt="Структури даних: піраміда (двійкова купа) Java - 5" src="https://cdn.javarush.com/images/article/307b5dd4-4c67-4574-994d-f14cd7731d8c/512.jpeg" style="width: 512px;"></li>
 <li>
  <p>Порівнюємо новий елемент із батьківським елементом, який має значення 4.</p>
  <p>Так як новий елемент більше батьківського, міняємо їх місцями:</p><img data-id="a4d503ed-2acd-4af2-891d-41099d8be326" data-max-width="512" alt="Структури даних: піраміда (двійкова купа) в Java - 6" src="https://cdn.javarush.com/images/article/a4d503ed-2acd-4af2-891d-41099d8be326/512.jpeg" style="width: 512px;"></li>
 <li>
  <p>Порівнюємо новий елемент з новим його батьком і бачимо, що наш елемент більший і його (8&gt;7), тому міняємо місцями та їх:</p><img data-id="203c79ee-4911-4cd2-b3da-727e98df7b17" data-max-width="512" alt="Структури даних: піраміда (двійкова купа) Java - 7" src="https://cdn.javarush.com/images/article/203c79ee-4911-4cd2-b3da-727e98df7b17/512.jpeg" style="width: 512px;">
  <p>Знову ж таки, порівнюємо елемент із батьківським елементом і бачимо, що цього разу батьківський елемент більше, а це означає, що наш новий елемент став на своє місце.</p></li>
</ol>
<h2>Заміна елемента</h2>При заміні елемента спочатку потрібно замінити елемент із заданим індексом. Логічно, чи не так? Ну, а що далі? Адже нове значення елемента вже інше, і факт, що він відповідає умові піраміди. Тобто не факт, що всі дочірні елементи менше елемента, що вставляється. Також не факт, що батьківські елементи більші за новий. Тому спочатку потрібно порівняти зі старим значенням елемента:
<ul>
 <li>якщо новий елемент більше, ніж він, то нам потрібно порівнювати його з батьківськими елементами і при потребі міняти їх місцями;</li>
 <li>якщо ж новий елемент менший, то потрібно порівнювати з великим з дочірніх елементів і міняти місцями, якщо дочірній елемент виявиться більше (доки новий елемент не стане на допустиме місце).</li>
</ul>Давайте розглянемо це на нашому прикладі. Зараз ми хочемо вставити елемент зі значенням 1 замість елемента зі значенням 9:
<ol>
 <li>Вставляємо елемент на місце попереднього:<img data-id="823d7d56-d91b-48e8-a20e-d7f68db80d86" data-max-width="512" alt="Структури даних: піраміда (двійкова купа) Java - 8" src="https://cdn.javarush.com/images/article/823d7d56-d91b-48e8-a20e-d7f68db80d86/512.jpeg" style="width: 512px;"></li>
 <li>Порівнюємо попередній елемент 9 і новий 1 і бачимо, що менше, а значить, ми намагатимемося зміщувати вниз.</li>
 <li>Порівнюємо з великим елементом із дочірніх, тобто з тим, що має значення 5, і бачимо, що новий менший. Тому міняємо порівнювані елементи місцями:<img data-id="44792def-a433-4444-a2fe-ebb1fa901bb6" data-max-width="512" alt="Структури даних: піраміда (двійкова купа) Java - 9" src="https://cdn.javarush.com/images/article/44792def-a433-4444-a2fe-ebb1fa901bb6/512.jpeg" style="width: 512px;"></li>
 <li>Оскільки нових елементів нижче нашого нового вже немає, можна сказати, що елемент став на своє місце.</li>
</ol>
<h2>Реалізація піраміди на Java</h2>Після розуміння принципу роботи даної структури саме час розглянути <span>реалізацію піраміди на Java</span> : Клас, що представляє одну вершину та значення, яке вона містить: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Node</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> value<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Клас, що представляє саму піраміду: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Heap</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">Node</span><span class="token punctuation">[</span><span class="token punctuation">]</span> heapArray<span class="token punctuation">;</span> <span class="token comment">// массив со всеми вершинами</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> maxSize<span class="token punctuation">;</span> <span class="token comment">// размер массива</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> currentSize<span class="token punctuation">;</span> <span class="token comment">// количество узлов массиве</span>

  <span class="token keyword">public</span> <span class="token class-name">Heap</span><span class="token punctuation">(</span><span class="token keyword">int</span> maxSize<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// создание пустой пирамиды</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>maxSize <span class="token operator">=</span> maxSize<span class="token punctuation">;</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>currentSize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
     heapArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>maxSize<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// отображение перамиды в консоль</span>
     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Массив значений: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> currentSize<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>heapArray<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>heapArray<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">int</span> countOfGaps <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>
     <span class="token keyword">int</span> itemsPerRow <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
     <span class="token keyword">int</span> columnNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// номер елемента в данной строке</span>
     <span class="token class-name">String</span> lines <span class="token operator">=</span> <span class="token string">"___________________________________________________________________"</span><span class="token punctuation">;</span>
     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> currentSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>columnNumber <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// проверяем первый элемент ли в текущей строке</span>
           <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> countOfGaps<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// добавляем предшествующие пробелы</span>
              <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>heapArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// выводим в консоль значення вершины</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>columnNumber <span class="token operator">==</span> itemsPerRow<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// проверяем последний ли элемент в строке</span>
           countOfGaps <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// уменьшаем количество оступов применяемое для следующей строки</span>
           itemsPerRow <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// указываем, что элементов может быть вдвое больше</span>
           columnNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// сбрасываем счётчик для текущего елемента строки</span>
           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// переходим на нову строку</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">//переход к следующему элементу</span>
           <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> countOfGaps <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// добавляем оступы</span>
           <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"\n"</span> <span class="token operator">+</span> lines<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// нижний пункир</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// вставка нового значения</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>currentSize <span class="token operator">==</span> maxSize<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// проверяем не выходим ли мы за рамки массива</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token class-name">Node</span> newNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// создание вершины с данным значенням</span>
     heapArray<span class="token punctuation">[</span>currentSize<span class="token punctuation">]</span> <span class="token operator">=</span> newNode<span class="token punctuation">;</span><span class="token comment">// вершину задём в самый низ дерева</span>
     <span class="token function">displaceUp</span><span class="token punctuation">(</span>currentSize<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// пытаемся поднять вершину, если значення вершины позволяет</span>
     <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">Node</span> <span class="token function">removeNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// удалить элемент по индексу массива</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> currentSize <span class="token operator">&gt;</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Node</span> root <span class="token operator">=</span> heapArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        heapArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> heapArray<span class="token punctuation">[</span><span class="token operator">--</span>currentSize<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// задаём элементу с переданным индексом, значення последнего елемента</span>
        heapArray<span class="token punctuation">[</span>currentSize<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">// последний элемент удаляем</span>
        <span class="token function">displaceDown</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// проталкиваем вниз новый элемент, чтобы он должное ему место</span>
        <span class="token keyword">return</span> root<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">changeNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">int</span> newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> currentSize<span class="token operator">&lt;=</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">int</span> oldValue <span class="token operator">=</span> heapArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// сохраняем старое значення</span>
     heapArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// присваиваем новое</span>

     <span class="token keyword">if</span> <span class="token punctuation">(</span>oldValue <span class="token operator">&lt;</span> newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// если узел повышается</span>
        <span class="token function">displaceUp</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// выполняется смещение вверх</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">else</span> <span class="token punctuation">{</span>                  <span class="token comment">// если понижается</span>
        <span class="token function">displaceDown</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// смещение вниз</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">displaceUp</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//смещение вверх</span>
     <span class="token keyword">int</span> parentIndex <span class="token operator">=</span> <span class="token punctuation">(</span>index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// узнаем индекс родителя</span>
     <span class="token class-name">Node</span> bottom <span class="token operator">=</span> heapArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// берем элемент</span>
     <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> heapArray<span class="token punctuation">[</span>parentIndex<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> bottom<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// если родительский элемент меньше</span>
        heapArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> heapArray<span class="token punctuation">[</span>parentIndex<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// то меняем его местами с рассматриваемым</span>
        index <span class="token operator">=</span> parentIndex<span class="token punctuation">;</span>
        parentIndex <span class="token operator">=</span> <span class="token punctuation">(</span>parentIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">// берем новый родительский индекс и повторяем сравнение элементов</span>
     <span class="token punctuation">}</span>
     heapArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> bottom<span class="token punctuation">;</span><span class="token comment">// соохраняем результат</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">displaceDown</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// смещение вниз</span>
     <span class="token keyword">int</span> largerChild<span class="token punctuation">;</span>
     <span class="token class-name">Node</span> top <span class="token operator">=</span> heapArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// сохранение корня, пока у узла есть хотя бы один потомок</span>
     <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> currentSize <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// если данное умова не выполняется то элемент уже в самом низу пирамиды</span>
        <span class="token keyword">int</span> leftChild <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// вычисляем индексы в массиве для левого узла ребенка</span>
        <span class="token keyword">int</span> rightChild <span class="token operator">=</span> leftChild <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// и правого</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>rightChild <span class="token operator">&lt;</span> currentSize <span class="token operator">&amp;&amp;</span> heapArray<span class="token punctuation">[</span>leftChild<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> heapArray<span class="token punctuation">[</span>rightChild<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           largerChild <span class="token operator">=</span> rightChild<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token comment">// вычисляем ребенка вершину с наибольшим числовым значенням</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
           largerChild <span class="token operator">=</span> leftChild<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>top<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> heapArray<span class="token punctuation">[</span>largerChild<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// если значення вершины больше або равно</span>
           <span class="token comment">//значени его наибольшего ребенка</span>
           <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">// то выходим из метода</span>
        <span class="token punctuation">}</span>

        heapArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> heapArray<span class="token punctuation">[</span>largerChild<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// заменяем вершину, большей дочерней вершиной</span>
        index <span class="token operator">=</span> largerChild<span class="token punctuation">;</span> <span class="token comment">// текущий индекс переходит вниз</span>
     <span class="token punctuation">}</span>
     heapArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> top<span class="token punctuation">;</span> <span class="token comment">// задаем конечное местоположение для елемента</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> І нарешті, давайте подивимося на нашу піраміду у справі: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// задаем начальные данные:</span>
     <span class="token class-name">Heap</span> heap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Heap</span><span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">210</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// выводим начальную пирамиду в консоль</span>
     heap<span class="token punctuation">.</span><span class="token function">printHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> Висновок у консолі:<img data-id="d7a92203-0ed4-46ff-9207-23042713f453" data-max-width="512" alt="Структури даних: піраміда (двійкова купа) в Java - 10" src="https://cdn.javarush.com/images/article/d7a92203-0ed4-46ff-9207-23042713f453/512.jpeg" style="width: 512px;">
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">// изменяем элемент под индексом 0 с 210 на 15, и выводим в консоль измененную пирамиду</span>
     heap<span class="token punctuation">.</span><span class="token function">changeNode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">printHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> Висновок у консолі:<img data-id="3b15f053-b1a3-4389-9eb6-745c6d68f453" data-max-width="512" alt="Структури даних: піраміда (двійкова купа) в Java - 11" src="https://cdn.javarush.com/images/article/3b15f053-b1a3-4389-9eb6-745c6d68f453/512.jpeg" style="width: 512px;">
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">// удаляем элемент под индексом 3, который имеет значення 80 и смотрим на изменившуюся пирамиду</span>
     heap<span class="token punctuation">.</span><span class="token function">removeNode</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     heap<span class="token punctuation">.</span><span class="token function">printHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Висновок у консолі: <img data-id="250f9a76-b4f5-4576-8497-755260ce9d4c" data-max-width="512" alt="Структури даних: піраміда (двійкова купа) в Java - 12" src="https://cdn.javarush.com/images/article/250f9a76-b4f5-4576-8497-755260ce9d4c/512.jpeg" style="width: 512px;">Ну от, власне, і все. Всім дякую за увагу!<img data-id="ac3c6345-e8a0-4dc7-8179-f593e411e8d6" data-max-width="512" alt="Структури даних: піраміда (двійкова купа) Java - 13" src="https://cdn.javarush.com/images/article/ac3c6345-e8a0-4dc7-8179-f593e411e8d6/512.jpeg" style="width: 512px;"><a href="https://codegym.cc/welcome" target="_blank" rel="nofollow"><img data-id="5736eb4b-2b1c-4ab6-b4cc-b9e2d1cef628" data-max-width="1080" alt="Структури даних: піраміда (двійкова купа) в Java - 14" src="https://cdn.javarush.com/images/article/5736eb4b-2b1c-4ab6-b4cc-b9e2d1cef628/1080.jpeg" style="width: 1080px;"></a>