Шаблон Спостерігач (Observer)
<p>----------------------------------------</p>
Як пише банда чотирьох (мається на увазі книга «Паттерни об'єктно-орієнтованого проектування» 4 першокласних розробників) призначення цього патерну в тому, щоб Ще цей патерн називають: Dependents (підлеглі) або Publish-Subscribe (видавець –
<p>----------------------------------------</p>
Як пише банда чотирьох (мається на увазі книга «Паттерни об'єктно-орієнтованого проектування» 4 першокласних розробників) призначення цього патерну в тому, щоб <strong>визначати залежність типу «один до багатьох» між об'єктами таким чином, що при зміні стану одного об'єкта всі, що залежать від нього, оповіщаються про це автоматично оновлюються. </strong> Ще цей патерн називають: Dependents (підлеглі) або Publish-Subscribe (видавець – передплатник). Але давайте спробуємо розібратися з прикладу католицької церкви :) У ній є послідовники, які вірять у вчення цієї церкви. З появою будь-яких нових догматів (обов'язкових віровчень) і не тільки - ці люди повинні знати про них. <strong>Але як це можна було описати мовою програмування, використовуючи даний патерн?</strong> 1. У нас є «голос церкви» (сама церква чи папа Римський коли мовить ex cathedra), тобто якийсь мовник чи суб'єкт, який оголошує новини в церкві. 2. Є парафіяни цієї церкви, т. е. деякі спостерігачі, які хочуть знати важливих подій. Відповідно сьогодні парафіян може бути 1,3 млд людей, а завтра більше чи менше. І сповіщати потрібно лише тих, хто перебуває в цій церкві (не потрібно турбувати атеїстів зайвий раз :). Таким чином це все можна було б виразити наступним чином: Є церква, яка буде мовити своїй пастві про щось, у якій можна зареєструватися або навпаки вийти з неї: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Church</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">registerParishioner</span><span class="token punctuation">(</span><span class="token class-name">Parishioner</span> parishioner<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">removeParishioner</span><span class="token punctuation">(</span><span class="token class-name">Parishioner</span> parishioner<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">notifyParishioners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Є конкретно католицька церква з реалізацією цих методів, а також новинами та списком людей, яким ці новини потрібно транслювати: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CatholicChurch</span> <span class="token keyword">implements</span> <span class="token class-name">Church</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>parishioner<span class="token punctuation">&gt;</span></span> parishioners<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> newsChurch<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">CatholicChurch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parishioners <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNewsChurch</span><span class="token punctuation">(</span><span class="token class-name">String</span> news<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>newsChurch <span class="token operator">=</span> news<span class="token punctuation">;</span>
        <span class="token function">notifyParishioners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerParishioner</span><span class="token punctuation">(</span><span class="token class-name">Parishioner</span> parishioner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parishioners<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>parishioner<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeParishioner</span><span class="token punctuation">(</span><span class="token class-name">Parishioner</span> parishioner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parishioners<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>parishioner<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">notifyParishioners</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Parishioner</span> parishioner <span class="token operator">:</span> parishioners<span class="token punctuation">)</span>
            parishioner<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>newsChurch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Є людина-прихожанин, яка може увійти в лоно церкви або вийти з неї (для спрощення коду ми дозволимо їй тільки увійти:) 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Parishioner</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Parishioner</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Church</span> church<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        church<span class="token punctuation">.</span><span class="token function">registerParishioner</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">String</span> newsChurch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">"узнал новость: "</span> <span class="token operator">+</span> newsChurch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Відповідно як це працюватиме: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> catholicChurch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CatholicChurch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Parishioner</span><span class="token punctuation">(</span><span class="token string">"Мартин Лютер"</span><span class="token punctuation">,</span> catholicChurch<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Parishioner</span><span class="token punctuation">(</span><span class="token string">"Жан Кальвин"</span><span class="token punctuation">,</span> catholicChurch<span class="token punctuation">)</span><span class="token punctuation">;</span>

        catholicChurch<span class="token punctuation">.</span><span class="token function">setNewsChurch</span><span class="token punctuation">(</span><span class="token string">"Инквизиция была ошибкой... месса Mea Culpa 12 марта 2000 года"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> та результат роботи програми: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><code class=" language-java">Мартин Лютер узнал новость<span class="token operator">:</span> Инквизиция была ошибкой<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> месса <span class="token class-name">Mea</span> <span class="token class-name">Culpa</span> <span class="token number">12</span> марта <span class="token number">2000</span> года
Жан Кальвин узнал новость<span class="token operator">:</span> Инквизиция была ошибкой<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> месса <span class="token class-name">Mea</span> <span class="token class-name">Culpa</span> <span class="token number">12</span> марта <span class="token number">2000</span> года</code></pre> Тобто. Як тільки в церкві з'явиться новина, будуть сповіщені про неї всі, хто перебуває у масиві зареєстрованих членів цієї церкви. <strong>У чому недоліки даної реалізації:</strong> 1. У перших інтерфейс де можна зареєструватися та отримувати новини може стосуватися не лише цієї церкви (можливо таке буде потрібно). Тому можна було б відразу винести це на окремий інтерфейс Observable. 2. Так само можна було б вчинити з парафіянами церкви, а саме метод update винести в окремий інтерфейс та реалізувати у потрібного прихожанина його. Тоді цей метод зможуть використовувати взагалі і не парафіяни католицької церкви, а наприклад ті, що повікують у існування ельфів (мається на увазі рух «Дорога до Єдинорога»). Тобто. створити інтерфейс Observer із методом update. Що в результаті вийде: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">interface</span> <span class="token class-name">Observable</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">registerObserver</span><span class="token punctuation">(</span><span class="token class-name">Observer</span> o<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">removeObserver</span><span class="token punctuation">(</span><span class="token class-name">Observer</span> o<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CatholicChurch</span> <span class="token keyword">implements</span> <span class="token class-name">Observable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>observer<span class="token punctuation">&gt;</span></span> parishioners<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> newsChurch<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">CatholicChurch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parishioners <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNewsChurch</span><span class="token punctuation">(</span><span class="token class-name">String</span> news<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>newsChurch <span class="token operator">=</span> news<span class="token punctuation">;</span>
        <span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerObserver</span><span class="token punctuation">(</span><span class="token class-name">Observer</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parishioners<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeObserver</span><span class="token punctuation">(</span><span class="token class-name">Observer</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        parishioners<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Observer</span> o <span class="token operator">:</span> parishioners<span class="token punctuation">)</span>
            o<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>newsChurch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">interface</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> update <span class="token punctuation">(</span><span class="token class-name">String</span> news<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Parishioner</span> <span class="token keyword">implements</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Parishioner</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Observable</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        o<span class="token punctuation">.</span><span class="token function">registerObserver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">String</span> news<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">" узнал новость: "</span> <span class="token operator">+</span> news<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><strong>Таким чином:</strong> Ми «послабабо зв'язок» між церквою та парафіянами, що природно добре лише у програмуванні :) Суб'єкт (католицька церква) має лише список слухачів (прихожан) та при отриманні новин (змін), транслює дані новини своїм слухачам. Можна завести тепер будь-який інший суб'єкт (наприклад, протестантську церкву) і там уже транслювати новини «своїм» слухачам. Також потрібно врахувати, що дані 2 класу (точніше клас Observable та інтерфейс Observer) були в пакеті java.util java, але зараз вони Deprecation з java 9 (https://docs.oracle.com/en/java/javase/15/ docs/api/java.base/java/util/Observable.html): <em>Deprecated. Ця категорія і об'єкти керування мають бути неперевіреними. Цей model підтримується помічником і помічником є ​​тимчасово обмеженим, потік notifications, узгоджений по помічникам, не визначений, і зміни змін не є в одному-на-всього відповідності з поданнями. Для richer event model, consider using java.beans package. Для надійного і відповідного messaging серед threads, розглядає за допомогою однієї з поточних структур даних в java.util.concurrent package. Для реактивних streams style programming, viz the Flow API. </em> Тому використати їх не потрібно. А замість них можна використовувати інші, але суть патерну від цього не зміниться. Для прикладу давайте спробує використовувати PropertyChangeListener (щоб не писати зайві класи, які вже написані) із пакету java.beans. <strong>Давайте подивимося як це буде:</strong> клас суб'єкта: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CatholicChurch</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> news<span class="token punctuation">;</span>
    <span class="token comment">// используя support мы можем добавлять або удалять наших прихожан (слушателей)</span>
    <span class="token keyword">private</span> <span class="token class-name">PropertyChangeSupport</span> support<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">CatholicChurch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        support <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyChangeSupport</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addPropertyChangeListener</span><span class="token punctuation">(</span><span class="token class-name">PropertyChangeListener</span> pcl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        support<span class="token punctuation">.</span><span class="token function">addPropertyChangeListener</span><span class="token punctuation">(</span>pcl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removePropertyChangeListener</span><span class="token punctuation">(</span><span class="token class-name">PropertyChangeListener</span> pcl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        support<span class="token punctuation">.</span><span class="token function">removePropertyChangeListener</span><span class="token punctuation">(</span>pcl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNews</span><span class="token punctuation">(</span><span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        support<span class="token punctuation">.</span><span class="token function">firePropertyChange</span><span class="token punctuation">(</span><span class="token string">"news"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>news<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>news <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> та клас слухача: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Parishioner</span> <span class="token keyword">implements</span> <span class="token class-name">PropertyChangeListener</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Parishioner</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">propertyChange</span><span class="token punctuation">(</span><span class="token class-name">PropertyChangeEvent</span> evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setNews</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> evt<span class="token punctuation">.</span><span class="token function">getNewValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNews</span><span class="token punctuation">(</span><span class="token class-name">String</span> news<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">" узнал новость: "</span> <span class="token operator">+</span> news<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Якщо ми виконаємо наступний код: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">CatholicChurch</span> observable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CatholicChurch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    observable<span class="token punctuation">.</span><span class="token function">addPropertyChangeListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Parishioner</span><span class="token punctuation">(</span><span class="token string">"Мартин Лютер"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    observable<span class="token punctuation">.</span><span class="token function">addPropertyChangeListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Parishioner</span><span class="token punctuation">(</span><span class="token string">"Жан Кальвин"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    observable<span class="token punctuation">.</span><span class="token function">setNews</span><span class="token punctuation">(</span><span class="token string">"Дева Мария имеет непорочное зачатие... булла Ineffabilis Deus... 8 декабря 1854 года Папа Пий IX"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    observable<span class="token punctuation">.</span><span class="token function">setNews</span><span class="token punctuation">(</span><span class="token string">"Папа непогрешим... не всегда конечно, а только когда транслирует учение церкви ex cathedra... Первый Ватиканский собор 1869 год"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Отримаємо наступний результат: 
<div class="terminal">
 Мартін Лютер дізнався новину: Діва Марія має непорочне зачаття... Була Ineffabilis Deus... 8 грудня 1854 року Папа Пій IX Жан Кальвін дізнався новину: Діва Марія має непорочне зачаття... Була Ineffabilis Deus... 8 грудня 1854 року Папа Пій IX Мартін Лютер дізнався новину: Папа непогрішимо... не завжди звичайно, а тільки коли транслює вчення церкви ex cathedra... Перший Ватиканський собор 1869 Жан Кальвін дізнався новину: Папа непогрішимо... не завжди звичайно, а тільки коли транслює вчення церкви ex cathedra... Перший Ватиканський собор 1869 рік
</div>