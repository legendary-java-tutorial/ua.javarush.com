9 головних питань про Map в Java
<p>----------------------------------------</p>
Нагадаємо, що - це структуровані дані, що складаються з набору пар ключ-значення, і кожен ключ може використовуватися лише один раз на одній Map. Ця тема розкриває 9 основних питань про використання у Java та її втілених (імплементованих) к
<p>----------------------------------------</p>
Нагадаємо, що <strong><a href="https://codegym.cc/groups/posts/1940-klass-hashmap-" target="_blank">Map</a></strong> - це структуровані дані, що складаються з набору пар ключ-значення, і кожен ключ може використовуватися лише один раз на одній Map. Ця тема розкриває 9 основних питань про використання <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Map.html" rel="nofollow" target="_blank">Map</a> у Java та її втілених (імплементованих) класах. Для простоти, я буду використовувати в прикладах <a href="https://docs.oracle.com/javase/tutorial/java/generics/" rel="nofollow" target="_blank">узагальнення</a> . Тому, я писатиму просто Map, не конкретизуючи специфікатор Map. Але можна вважати, що обидва значення <strong>K</strong> і <strong>V</strong> можна порівняти, що означає <strong>K</strong> розширює <strong>Comparable</strong> і <strong>V</strong> так само розширює <strong>Comparable</strong> .<img data-id="599e88a7-47f9-44de-986e-fa3ff12917c6" data-max-width="850" alt="9 головних питань про Map в Java - 1" src="https://cdn.javarush.com/images/article/599e88a7-47f9-44de-986e-fa3ff12917c6/800.jpeg" style="width: 850px;">
<h2>0. Звернення Map у List</h2>У Java, інтерфейс <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Map.html" rel="nofollow" target="_blank">Map</a> пропонує три види колекцій: набір ключів, набір значень та набір ключ-значення. Всі вони можуть бути звернені до <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html" rel="nofollow" target="_blank">List</a> за допомогою конструктора або методу <code class=" language-none">addAll()</code>. Наступна вирізка коду демонструє, як зробити <a href="https://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html" rel="nofollow" target="_blank">ArrayList</a> з Map. 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token comment"><span class="token comment">//аркуш ключів</span></span>
<span class="token class-name"><span class="token class-name">List</span></span> keyList <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ArrayList</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">keySet</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token comment"><span class="token comment">//аркуш значень</span></span>
<span class="token class-name"><span class="token class-name">List</span></span> valueList <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ArrayList</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">valueSet</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token comment"><span class="token comment">//аркуш ключ-значення</span></span>
<span class="token class-name"><span class="token class-name">List</span></span> entryList <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ArrayList</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">entrySet</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre>
<h2>1. Пройтися за всіма значеннями в Map</h2>Прохід по кожній парі ключ-значення - базова, основна процедура проходу по Map. У Java кожна пара зберігається в полі Map званому <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Map.Entry.html" rel="nofollow" target="_blank">Map.Entry</a> . <code class=" language-none">Map.entrySet()</code>повертає набір ключ-значень, тому найефективнішим способом пройтися по всіх значеннях Map буде: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">for</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Entry</span></span> entry<span class="token operator"><span class="token operator">:</span></span> <span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">entrySet</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
  <span class="token comment"><span class="token comment">//отримати ключ</span></span>
  <span class="token class-name"><span class="token class-name">K</span></span> key <span class="token operator"><span class="token operator">=</span></span> entry<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getKey</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
  <span class="token comment"><span class="token comment">//отримати значення</span></span>
  <span class="token class-name"><span class="token class-name">V</span></span> value <span class="token operator"><span class="token operator">=</span></span> entry<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getValue</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Також ми можемо використовувати <code class=" language-none">Iterator</code>, особливо у версіях молодших JDK 1.5 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">Iterator</span></span> itr <span class="token operator"><span class="token operator">=</span></span> <span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">entrySet</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">iterator</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">while</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>itr<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">hasNext</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
  <span class="token class-name"><span class="token class-name">Entry</span></span> entry <span class="token operator"><span class="token operator">=</span></span> itr<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">next</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
  <span class="token comment"><span class="token comment">//отримати ключ</span></span>
  <span class="token class-name"><span class="token class-name">K</span></span> key <span class="token operator"><span class="token operator">=</span></span> entry<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getKey</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
  <span class="token comment"><span class="token comment">//отримати значення</span></span>
  <span class="token class-name"><span class="token class-name">V</span></span> value <span class="token operator"><span class="token operator">=</span></span> entry<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getValue</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre>
<h2>2. Упорядкування Map за ключами</h2>Упорядкування Map за ключами ще одна процедура, що часто зустрічається. Перший спосіб: додати <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Map.Entry.html" rel="nofollow" target="_blank">Map.Entry</a> до списку і впорядкувати з використанням компаратора, що сортує за значеннями. 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">List</span></span> list <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ArrayList</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">entrySet</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">Collections</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">sort</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>list<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Comparator</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

  <span class="token annotation punctuation"><span class="token annotation punctuation">@Override</span></span>
  <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">int</span></span> <span class="token function"><span class="token function">compare</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Entry</span></span> e1<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">Entry</span></span> e2<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">return</span></span> e1<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getKey</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">compareTo</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>e2<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getKey</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
  <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Інший спосіб: використовувати <a href="https://docs.oracle.com/javase/7/docs/api/java/util/SortedMap.html" rel="nofollow" target="_blank">SortedMap</a> , яка до всього ще й вибудовує свої ключі по порядку. Але всі ключі при цьому повинні втілювати <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html" rel="nofollow" target="_blank">Comparable</a> або прийматися компаратором. Один із імплементованих класів <code class=" language-none">SortedMap</code>- <a href="https://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html" rel="nofollow" target="_blank">TreeMap</a> . Її конструктор приймає компаратор. Наступний код показує як перетворити звичайну <code class=" language-none">Map</code>на впорядковану. 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">SortedMap</span></span> sortedMap <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">TreeMap</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Comparator</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

  <span class="token annotation punctuation"><span class="token annotation punctuation">@Override</span></span>
  <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">int</span></span> <span class="token function"><span class="token function">compare</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">K</span></span> k1<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">K</span></span> k2<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">return</span></span> k1<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">compareTo</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>k2<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
  <span class="token punctuation"><span class="token punctuation">}</span></span>

<span class="token punctuation"><span class="token punctuation">}</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
sortedMap<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">putAll</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre>
<h2>3. Упорядкування Map за значеннями</h2>Додавання Map до списку та подальше сортування працюють і в даному випадку, але потрібно цього разу брати <code class=" language-none">Entry.getValue()</code>. Код нижче майже такий самий, як і раніше. 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">List</span></span> list <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ArrayList</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">entrySet</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">Collections</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">sort</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>list<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Comparator</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

  <span class="token annotation punctuation"><span class="token annotation punctuation">@Override</span></span>
  <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">int</span></span> <span class="token function"><span class="token function">compare</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Entry</span></span> e1<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">Entry</span></span> e2<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">return</span></span> e1<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getValue</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">compareTo</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>e2<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getValue</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
  <span class="token punctuation"><span class="token punctuation">}</span></span>

<span class="token punctuation"><span class="token punctuation">}</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Ми все ще можемо використовувати <code class=" language-none">SortedMap</code>в цьому випадку, але якщо значення унікальні. У такому випадку, ви можете звернути пару ключ-значення до значення-ключ. Це рішення має суворе обмеження, і не рекомендується мною. 
<h2>4. Ініціалізація статичної/незмінної Map</h2>Коли ви хочете, щоб Map залишалася незмінною, хорошим способом скопіюватиме її в незмінну (immutable) Map. Така захисна техніка програмування допоможе вам створити не тільки безпечну для використання, але й потокобезпечну Map. Для ініціалізації статичної/незмінної Map ми можемо використовувати ініціалізатор <code class=" language-none">static</code>(див. нижче). Проблема даного коду в тому, що, не дивлячись на оголошення Map як <code class=" language-none">static final</code>, ми все ще можемо працювати з нею після ініціалізації, наприклад <code class=" language-none">Test.Map.put(3,"three");</code>. Тож це не справжня незмінність. Для створення незмінної Map з використанням статичного ініціалізатора нам потрібен супер анонімний клас, який ми додамо в незмінну Map на останньому кроці ініціалізації. Будь ласка, подивіться на другу частину коду. Коли буде викинуто<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/UnsupportedOperationException.html" rel="nofollow" target="_blank">UnsupportedOperationException</a> , якщо ви запустите <code class=" language-none">Test.Map.put(3,"three");</code>. 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">Test</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

  <span class="token keyword"><span class="token keyword">private</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token class-name"><span class="token class-name">Map</span></span> <span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
  <span class="token keyword"><span class="token keyword">static</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">Map</span></span> <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">HashMap</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">put</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token number"><span class="token number">1</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"one"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">put</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token number"><span class="token number">2</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"two"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
  <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">Test</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

  <span class="token keyword"><span class="token keyword">private</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token class-name"><span class="token class-name">Map</span></span> <span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
  <span class="token keyword"><span class="token keyword">static</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">Map</span></span> aMap <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">HashMap</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    aMap<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">put</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token number"><span class="token number">1</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"one"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    aMap<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">put</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token number"><span class="token number">2</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"two"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">Map</span></span> <span class="token operator"><span class="token operator">=</span></span> <span class="token class-name"><span class="token class-name">Collections</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">unmodifiableMap</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>aMap<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
  <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Бібліотека <a href="https://github.com/google/guava" rel="nofollow" target="_blank">Guava</a> також підтримує різні способи ініціалізації статичних та постійних колекцій. Щоб дізнатися більше про переваги утиліти Guava для постійних колекцій, зверніться до розділу <a href="https://github.com/google/guava" rel="nofollow" target="_blank">Постійні колекції в Інструкції Guava</a> . 
<h2>5. Різниця між HashMap, TreeMap, та Hashtable</h2>Є три основні втілення інтерфейсу <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Map.html" rel="nofollow" target="_blank">Map</a> Java: <a href="https://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html" rel="nofollow" target="_blank">HashMap</a> , <a href="https://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html" rel="nofollow" target="_blank">TreeMap</a> , і <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Hashtable.html" rel="nofollow" target="_blank">Hashtable</a> . Головні відмінності полягають у наступному: 
<ul>
 <li><strong>Порядок проходу</strong> . <a href="https://codegym.cc/groups/posts/732-kak-rabotaet-hashmap-v-java" target="_blank">HashMap</a> і HashTable не дають гарантій упорядкованості в Map; зокрема, вони не гарантують, що порядок залишиться тим самим протягом часу. Але <code class=" language-none">TreeMap</code>впорядковуватиме всі значення в "природному порядку" ключів або за компаратором.</li>
 <li><strong>Допустимі пари ключ-значення. </strong> <code class=" language-none">HashMap</code>дозволяє мати ключ null та значення null. <code class=" language-none">HashTable</code>не дозволяє ключ null чи значення null. Якщо <code class=" language-none">TreeMap</code>використовує природний порядок або компаратор не дозволяє використовувати ключ null, буде викинуто виняток.</li>
 <li><strong>Синхронізація</strong> . Тільки <code class=" language-none">HashTable</code>синхронізована, решта — ні. Але, "якщо потокобезпечне втілення не потрібне, рекомендується використовувати <code class=" language-none">HashMap</code>замість <code class=" language-none">HashTable</code>".</li>
</ul> Докладніше порівняння 
<pre class="  language-java" tabindex="0"><code class="  language-java"><span class="token punctuation"><span class="token punctuation">.</span></span>                       <span class="token operator"><span class="token operator">|</span></span> <span class="token class-name"><span class="token class-name">HashMap</span></span> <span class="token operator"><span class="token operator">|</span></span> <span class="token class-name"><span class="token class-name">HashTable</span></span> <span class="token operator"><span class="token operator">|</span></span> <span class="token class-name"><span class="token class-name">TreeMap</span></span>
<span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">-</span></span>

Упорядочивание          <span class="token operator"><span class="token operator">|</span></span>нет      <span class="token operator"><span class="token operator">|</span></span>нет        <span class="token operator"><span class="token operator">|</span></span> да
<span class="token keyword"><span class="token keyword">null</span></span> в ключ<span class="token operator"><span class="token operator">-</span></span>значення    <span class="token operator"><span class="token operator">|</span></span> да<span class="token operator"><span class="token operator">-</span></span>да   <span class="token operator"><span class="token operator">|</span></span> нет<span class="token operator"><span class="token operator">-</span></span>нет   <span class="token operator"><span class="token operator">|</span></span> нет<span class="token operator"><span class="token operator">-</span></span>да
синхронизировано        <span class="token operator"><span class="token operator">|</span></span> нет     <span class="token operator"><span class="token operator">|</span></span> да        <span class="token operator"><span class="token operator">|</span></span> нет
производительность      <span class="token operator"><span class="token operator">|</span></span> <span class="token class-name"><span class="token class-name">O</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token number"><span class="token number">1</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>    <span class="token operator"><span class="token operator">|</span></span> <span class="token class-name"><span class="token class-name">O</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token number"><span class="token number">1</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>      <span class="token operator"><span class="token operator">|</span></span> <span class="token class-name"><span class="token class-name">O</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>log n<span class="token punctuation"><span class="token punctuation">)</span></span>
воплощение              <span class="token operator"><span class="token operator">|</span></span> корзины <span class="token operator"><span class="token operator">|</span></span> корзины   <span class="token operator"><span class="token operator">|</span></span> красно<span class="token operator"><span class="token operator">-</span></span>чёрное дерево</code></pre> Докладніше про відносини <a href="https://www.programcreek.com/2013/03/hashmap-vs-treemap-vs-hashtable-vs-linkedhashmap/" rel="nofollow" target="_blank">HashMap vs. TreeMap vs. Hashtable vs. LinkedHashMap</a> . 
<h2>6. Map з реверсивним пошуком/переглядом</h2>Іноді, нам потрібен набір пар ключ-ключ, що має на увазі значення так само унікальні, як і ключі (патерн один до одного). Така сталість дозволяє створити "інвертований перегляд/пошук" Map. Тобто ми можемо знайти ключ за його значенням. Така структура даних називається <a href="https://en.wikipedia.org/wiki/Bidirectional_map" rel="nofollow" target="_blank">двонаправлена ​​Map</a> , яка, на жаль, не підтримується JDK. Обидві Apache Common Collections та Guava пропонують втілення двонаправленої Map, звані BidiMap та BiMap, відповідно. Обидві вводять обмеження, яке задає відповідність 1:1 між ключами та значеннями. 
<h2>7. Поверхнева копія Map</h2>Майже всі, якщо не всі, Map Java містить конструктор копіювання інший Map. Але процедуру копіювання не синхронізовано. Що означає, коли один потік копіює Map, інший може змінити її структуру. Для запобігання раптовій розсинхронізації копіювання один з них повинен використовувати в такому випадку <code class=" language-none">Collections.synchronizedMap()</code>. 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">Map</span></span> copiedMap <span class="token operator"><span class="token operator">=</span></span> <span class="token class-name"><span class="token class-name">Collections</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">synchronizedMap</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Map</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Інший цікавий спосіб поверхневого копіювання - використання методу <code class=" language-none">clone()</code>. Але він не рекомендується навіть творцем фреймворку колекцій Java, Джошуа Блохом. У суперечці " <a href="https://www.artima.com/intv/bloch13.html" rel="nofollow" target="_blank">Конструктор копіювання проти клонування</a> ", він займає позицію: Цитата: <em>"Я часто наводжу публічний метод clone в конкретних класах, оскільки люди очікують їх там побачити. ... це ганьба, що Клонування зламано, але це сталося. ... Клонування це слабке місце, та я думаю люди повинні бути попереджені про його обмеження." </em> З цієї причини, я навіть не показую вам, як використовувати метод <code class=" language-none">clone()</code>копіювання Map 
<h2>8. Створення порожній Map</h2>Якщо <code class=" language-none">Map</code>незмінна, використовуйте: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">Map</span></span> <span class="token operator"><span class="token operator">=</span></span> <span class="token class-name"><span class="token class-name">Collections</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">emptyMap</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Або використовуйте будь-яке інше втілення. Наприклад: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">Map</span></span> <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">HashMap</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> КІНЕЦЬ