IntelliJ Idea: Декомпіляція, Компіляція, Субституція (або як правити чужі помилки)
<p>----------------------------------------</p>
"Та не винайти ти велосипед" - одне з головних правил успішної та ефективної роботи. Але що робити, коли свій велосипед винаходити не хочеться, а у чужого кермо виявилося кривим, а колеса квадратними? Даний огляд призначений для можливості 
<p>----------------------------------------</p>
"Та не винайти ти велосипед" - одне з головних правил успішної та ефективної роботи. Але що робити, коли свій велосипед винаходити не хочеться, а у чужого кермо виявилося кривим, а колеса квадратними? Даний огляд призначений для можливості короткого ознайомлення з прийомом виправлення в чужих бібліотеках "на крайній випадок" і про те, як цю справу поширити далі свого комп'ютера. 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="f7fba6bb-26a5-4b4f-a85d-06de721af53d" data-max-width="710" alt="IntelliJ Idea : Декомпіляція, Компіляція, Субституція (або як правити чужі помилки) - 1" src="https://cdn.javarush.com/images/article/f7fba6bb-26a5-4b4f-a85d-06de721af53d/512.jpeg" style="width: 710px;">
 </div>
</div>
<h2>Вступ</h2>Усі ми користуємося тими чи іншими інструментами. Але іноді інструменти підходять не до кінця або мають помилки. Завдяки особливостям мови Java ми можемо виправити поведінку інструментів там, де це потрібно. Добре, коли ми вносимо свій внесок проекти і надсилаємо пулл реквести (докладніше можна прочитати тут: « <a href="https://git-scm.com/book/ru/v2/GitHub-%D0%92%D0%BD%D0%B5%D1%81%D0%B5%D0%BD%D0%B8%D0%B5-%D1%81%D0%BE%D0%B1%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE-%D0%B2%D0%BA%D0%BB%D0%B0%D0%B4%D0%B0-%D0%B2-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D1%8B" target="_blank" rel="nofollow">GitHub – Внесення власного вкладу до проектів</a> »). Але приймати їх можуть не одразу, а можуть навіть не прийняти. Але для потреб проекту потрібно ось зараз. І тут, сподіваюся, ця стаття покаже доступні нам, як розробнику, гроші. Нам знадобиться виконати такі дії, про які ми говоритимемо: 
<ul>
 <li>Підготувати випробуваний додаток для прикладу (на прикладі Hibernate проекту)</li>
 <li>Пошук місця, що змінюється</li>
 <li>Виконання зміни</li>
 <li>Розгортання репозиторію</li>
</ul> Всі нижче вказані дії наведені для Windows, але мають аналоги під nix системи. Так що при потребі ви можете їх повторити. 
<h2>Підготовка випробуваного</h2>Отже, нам потрібний піддослідний проект. Нам ідеально підійде Hibernate, т.к. це "стильно, модно, сучасно". Не особливо вдаватися до деталей, т.к. стаття не про Hibernate Робитимемо все швидко і у справі. І будемо, як правильні розробники, використовувати систему збирання. Наприклад, нам також підійде Gradle, який для цієї статті повинен бути встановлений ( <a href="https://gradle.org/install/" target="_blank" rel="nofollow">https://gradle.org/install/</a> ). Спочатку нам потрібно створити проект. У Maven'а для цього є <a href="https://maven.apache.org/guides/introduction/introduction-to-archetypes.html" target="_blank" rel="nofollow">архетипи</a> , а у Gradle для цього є особливий плагін: <a href="https://docs.gradle.org/current/userguide/build_init_plugin.html" target="_blank" rel="nofollow">Gradle Init</a> . Отже, відкриваємо командний рядок будь-яким відомим вам способом. Створюємо каталог для проекту, переходимо до нього та виконуємо команду: 
<pre class=" language-none" tabindex="0"><code class=" language-none">
mkdir codegym 
cd codegym 
gradle init --type java-application</code></pre>
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="a495cc11-dc52-48c4-bb6a-a3ba03e202ae" data-max-width="710" alt="IntelliJ Idea : Декомпіляція, Компіляція, Субституція (або як правити чужі помилки) - 2" src="https://cdn.javarush.com/images/article/a495cc11-dc52-48c4-bb6a-a3ba03e202ae/512.jpeg" style="width: 710px;">
 </div>
</div>Перш ніж виконувати імпорт проекту, внесемо деякі зміни до файлу, який описує, яким чином потрібно виконувати збірку. Цей файл називається <a href="https://docs.gradle.org/current/userguide/tutorial_using_tasks.html" target="_blank" rel="nofollow">build script'ом</a> і має ім'я build.gradle. Знаходиться він у тому каталозі, де ми виконали gradle init. Тому просто відкриваємо його (наприклад, у windows командою start build.gradle). Знаходимо там блок " <a href="https://docs.gradle.org/current/userguide/declaring_dependencies.html" target="_blank" rel="nofollow">dependencies</a> ", тобто. залежності. Тут описуються всі сторонні jar, які ми будемо використовувати. Тепер слід зрозуміти, що тут описувати. Перейдемо на сайт Hibernate ( <a href="http://hibernate.org/" target="_blank" rel="nofollow">http://hibernate.org/</a> ). Нас цікавить <a href="http://hibernate.org/orm/" target="_blank" rel="nofollow">Hibernate ORM</a>. Нам потрібний останній реліз. У меню зліва є підрозділ "Releases". Вибираємо "latest stable". Промотуємо вниз і знаходимо "Core implementation (includes JPA)". Раніше потрібно було підтримувати JPA окремо, але тепер все стало простіше і достатньо лише однієї залежності. Також нам знадобиться за допомогою Hibernate працювати з базою даних. Для цього візьмемо найпростіший варіант – <a href="http://www.h2database.com/html/cheatSheet.html" target="_blank" rel="nofollow">H2 Database</a> . Вибір зроблений, ось наші залежності: 
<pre class=" language-none" tabindex="0"><code class=" language-none">
dependencies {
    // Базовая зависимость для Hibernate (новые версии включают и JPA)
    compile 'org.hibernate:hibernate-core:5.2.17.Final'
    // База данных, к которой мы будем подключаться
    compile 'com.h2database:h2:1.4.197'
    // Use JUnit test framework
    testCompile 'junit:junit:4.12'
}</code></pre> Чудово, що далі? Потрібно налаштувати Hibernate. У Hibernate є " <a href="http://docs.jboss.org/hibernate/orm/5.2/quickstart/html_single/" target="_blank" rel="nofollow">Getting Started Guide</a> ", але він безглуздий і більше заважає, ніж допомагає. Тому підемо як правильні люди відразу в " <a href="http://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html" target="_blank" rel="nofollow">User Guide</a> ". У змісті бачимо розділ " <a href="http://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html#bootstrap" target="_blank" rel="nofollow">Bootstrap</a> ", що перекладається як "Початкове завантаження". Те що треба. Там написано багато розумних слів, але сенс у тому, що на classpath має бути каталог META-INF, а там файл persistence.xml. На classpath за стандартом потрапляє каталог "resources". Тому створюємо вказаний каталог:<code class=" language-none">mkdir src\main\resources\META-INF</code> Створюємо там файл persistence.xml та відкриваємо його. Там же в документації є приклад "Example 268. META-INF/persistence.xml configuration file" з якого ми візьмемо вміст і вставимо у файл persistence.xml. Далі запускаємо IDE та імпортуємо до неї наш створений проект. Тепер нам треба щось зберігати у базу. Це щось називається сутністю. Сутності представляють щось із так званої доменної моделі. І в змісті, про диво, бачимо « <a href="http://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html#domain-model" target="_blank" rel="nofollow">2. Domain Model</a> ». Спускаємося нижче за текстом і бачимо у розділі "2.1. Mapping types" простий приклад сутності. Забираємо його до себе, трохи скоротивши: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">entity</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">javax<span class="token punctuation"><span class="token punctuation">.</span></span>persistence<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">Entity</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">javax<span class="token punctuation"><span class="token punctuation">.</span></span>persistence<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">GeneratedValue</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">javax<span class="token punctuation"><span class="token punctuation">.</span></span>persistence<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">Id</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token annotation punctuation"><span class="token annotation punctuation">@Entity</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>name <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"Contact"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">Contact</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

    <span class="token annotation punctuation"><span class="token annotation punctuation">@Id</span></span>
    <span class="token annotation punctuation"><span class="token annotation punctuation">@GeneratedValue</span></span>
    <span class="token keyword"><span class="token keyword">private</span></span> <span class="token class-name"><span class="token class-name">Integer</span></span> id<span class="token punctuation"><span class="token punctuation">;</span></span>

    <span class="token keyword"><span class="token keyword">private</span></span> <span class="token class-name"><span class="token class-name">String</span></span> name<span class="token punctuation"><span class="token punctuation">;</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">Contact</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span> name<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">this</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>name <span class="token operator"><span class="token operator">=</span></span> name<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Тепер у нас з'явився клас, який представляє сутність. Повернемося до persistence.xml і поправимо там одне місце: Там де вказано <code class=" language-none">class</code>вкажемо свій клас <code class=" language-none">entity.Contact</code>. Добре, залишилося запуститися. Повертаємося в розділ « <a href="http://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html#bootstrap" target="_blank" rel="nofollow">Bootstrap</a> ». Так як у нас немає сервера додатків, який нам надасть особливе EE оточення (тобто оточення, яке реалізує для нас певну поведінку системи), ми працюємо в SE оточенні. Для нього нам підійде лише приклад "Example 269. Application bootstrapped EntityManagerFactory". Наприклад, зробимо так: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">App</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">EntityManagerFactory</span></span> emf <span class="token operator"><span class="token operator">=</span></span> <span class="token class-name"><span class="token class-name">Persistence</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createEntityManagerFactory</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"CRM"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">EntityManager</span></span> em <span class="token operator"><span class="token operator">=</span></span> emf<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createEntityManager</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        em<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getTransaction</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">begin</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">Contact</span></span> contact <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Contact</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Vasya"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        em<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">persist</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>contact<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        em<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getTransaction</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">commit</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">Query</span></span> sqlQuery <span class="token operator"><span class="token operator">=</span></span> em<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createNativeQuery</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"select count(*) from contact"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">BigInteger</span></span> count <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">BigInteger</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> sqlQuery<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getSingleResult</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        emf<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">close</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Entiries count: "</span></span> <span class="token operator"><span class="token operator">+</span></span> count<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Ура, наш випробуваний готовий. Цю частину <u>не хотів опускати</u> , т.к. для наступних розділів бажано розуміти те, як з'явився наш випробуваний. 
<h2>Пошук змінної поведінки</h2>Давайте станемо місце ініціалізації поля count типу BigInteger і поставимо там точки зупинки ( <a href="https://www.jetbrains.com/help/idea/creating-line-breakpoints.html" target="_blank" rel="nofollow">BreakPoint</a> ). Вставши на потрібному рядку це можна зробити за допомогою Ctrl+F8 або через меню Run -&gt; Toggle Line Breakpoint. Після чого запускаємо наш main метод у дебазі (Run -&gt; Debug): 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="9f19143f-f830-46f4-9b69-d2689109d276" data-max-width="710" alt="IntelliJ Idea : Декомпіляція, Компіляція, Субституція (або як правити чужі помилки) - 3" src="https://cdn.javarush.com/images/article/9f19143f-f830-46f4-9b69-d2689109d276/512.jpeg" style="width: 710px;">
 </div>
</div>Трохи незграбний приклад, але, скажімо, ми хочемо змінити кількість query spaces при старті. Як бачимо, наш sqlQuery це NativeQueryImpl. Натискаємо <code class=" language-none">Ctrl+N</code>, пишемо назву класу, переходимо до нього. Щоб при перехід у клас нас перекидало те місце, де лежить цей клас включив автоскрол: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="5050b2a9-bc41-4424-82c0-f75846c7c11d" data-max-width="710" alt="IntelliJ Idea : Декомпіляція, Компіляція, Субституція (або як правити чужі помилки) - 4" src="https://cdn.javarush.com/images/article/5050b2a9-bc41-4424-82c0-f75846c7c11d/512.jpeg" style="width: 710px;">
 </div>
</div>Відразу зауважимо, що Idea не знає зараз, де можна знайти вихідний код програми (вихідники, тобто). Тому вона милостиво декомпілювала для нас із class файлу вміст: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="e2897b66-211f-4163-820a-16db96fc531b" data-max-width="710" alt="IntelliJ Idea : Декомпіляція, Компіляція, Субституція (або як правити чужі помилки) - 5" src="https://cdn.javarush.com/images/article/e2897b66-211f-4163-820a-16db96fc531b/512.jpeg" style="width: 710px;">
 </div>
</div>Зауважимо також, що у заголовку вікна IntelliJ Idea пишеться, де Gradle зберігає для нас артефакт. Тепер отримаємо в Idea шлях, де лежить наш артефакт: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="fbb360dc-8a64-45fa-a510-29d379708fcb" data-max-width="710" alt="IntelliJ Idea : Декомпіляція, Компіляція, Субституція (або як правити чужі помилки) - 6" src="https://cdn.javarush.com/images/article/fbb360dc-8a64-45fa-a510-29d379708fcb/512.jpeg" style="width: 710px;">
 </div>
</div>Перейдемо в цей каталог у командному рядку за допомогою команди <code class=" language-none">cd шлях до каталогу</code>. Відразу зроблю зауваження: якщо є можливість зібрати проект із вихідних, краще збирати з вихідних. Наприклад, вихідний код Hibernate доступний на офіційному сайті. Краще забрати його для потрібної версії і зробити всі зміни там і зібратися за допомогою скриптів збирання, які вказані у проекті. Я ж наводжу у статті найжахливіший варіант – є jar, а вихідного коду немає. І зауваження номер 2: Gradle може отримати вихідний код за допомогою плагінів. Докладніше див. « <a href="https://stackoverflow.com/questions/28404149/how-to-download-javadocs-and-sources-for-jar-using-gradle-2-0" target="_blank" rel="nofollow">How to download javadocs and sources for jar using Gradle</a> . 
<h2>Виконання зміни</h2>Нам потрібно відтворити структуру каталогів відповідно до того, в якому пакеті лежить клас, що змінюється. У цьому випадку: <code class=" language-none">mkdir org\hibernate\query\internal</code>, після чого створюємо в цьому каталозі файл <code class=" language-none">NativeQueryImpl.java</code>. Тепер відкриваємо даний файл і копіюємо туди весь вміст класу з IDE (те саме, яке для нас декомпілювала Idea). Змінюємо потрібні рядки. Наприклад: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="89564767-c36f-4eee-9dc3-c61de557a0ac" data-max-width="710" alt="IntelliJ Idea : Декомпіляція, Компіляція, Субституція (або як правити чужі помилки) - 7" src="https://cdn.javarush.com/images/article/89564767-c36f-4eee-9dc3-c61de557a0ac/512.jpeg" style="width: 710px;">
 </div>
</div> Тепер компілюємо файл. Виконуємо: <code class=" language-none">javac org\hibernate\query\internal\NativeQueryImpl.java</code>. Потрібно ж, не можна просто взяти і скомпілювати без помилок. Набули купу помилок Cannot Find Symbol, т.к. змінюваний клас зав'язаний інші класи, які зазвичай IntelliJ Idea за нас додає в classpath. Чи відчуваєте всю корисність наших IDE? =) Що ж, давайте додамо самі, ми теж можемо. Скопіюємо окремо в блокнот шляху: 
<ul>
 <li>[1] - hibernate-core-5.2.17.Final.jar</li>
 <li>[2] - hibernate-jpa-2.1-api-1.0.0.Final.jar</li>
</ul> Як ми робабо: У вигляді "Project" в "External libraries" знаходимо потрібний jar і натискаємо <code class=" language-none">Ctrl+Shift+C</code>. Тепер сформуємо та виконаємо таку команду: <code class=" language-none">javac -cp [1];[2] org\hibernate\query\internal\NativeQueryImpl.java</code> В результаті поряд з java файлом з'являться нові class файли, які потрібно оновити у jar файлі: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-max-width="243" alt="IntelliJ Idea : Декомпіляція, Компіляція, Субституція (або як правити чужі помилки) - 8" src="https://cdn.javarush.com/images/article/d1add0b9-bec5-452b-a889-563b8c0b3967/original.jpeg">
 </div>
</div> Ура тепер можна виконати jar update. Можемо керуватися <a href="https://docs.oracle.com/javase/tutorial/deployment/jar/update.html" target="_blank" rel="nofollow">офіційними матеріалами</a> : <code class=" language-none">jar uf hibernate-core-5.2.17.Final.jar org\hibernate\query\internal\*.class</code> Відкрита IntelliJ Idea, швидше за все, не дасть змінювати файли. Тому до виконання jar update, швидше за все, доведеться закрити Idea, а після оновлення – відкрити. Після цього можна знову відкриваємо IDE, знову виконуємо dubug. Break Points не скидаються між перезапусками IDE. Тому виконання програми зупиниться там, де й раніше. Вуаля, ми бачимо, як працюють наші зміни: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="537777fa-5261-496a-8209-18680e205215" data-max-width="710" alt="IntelliJ Idea : Декомпіляція, Компіляція, Субституція (або як правити чужі помилки) - 9" src="https://cdn.javarush.com/images/article/537777fa-5261-496a-8209-18680e205215/512.jpeg" style="width: 710px;">
 </div>
</div> Чудово. Але тут постає питання – завдяки чому? Просто завдяки тому, що коли gradle збирає проект, він аналізує блок dependencies та repositories. У гредла є якийсь build cache, який лежить у певному місці (див. « <a href="https://stackoverflow.com/questions/28838699/how-to-set-gradle-cache-location" target="_blank" rel="nofollow">How to set gradle cache location?</a> ». Якщо в кеші немає залежності, то Gradle її скачає з репозиторію. Оскільки ми змінювали jar у самому кеші, то Gradle думає, що в кеші бібліотека є і нічого не викачує, але будь-яке очищення кешу призведе до того, що наші зміни пропадуть, плюс, ніхто, крім нас, не може просто взяти і отримати їх, скільки незручностей, чи не так? Хм, скачує з репозиторію?Отже, нам потрібен наш репозиторій, з преферансом та поетесами, про це наступний етап. 
<h2>Розгортання репозиторію</h2>Для розгортання свого репозиторію існують різні безкоштовні рішення: одне з них <a href="https://jfrog.com/open-source/" target="_blank" rel="nofollow">Artifactory</a> , а інше – <a href="http://archiva.apache.org/download.cgi" target="_blank" rel="nofollow">Apache Archive</a> . Артифактори виглядає модно, стильно, сучасно, але з ним у мене виникли труднощі, ніяких не хотів правильно розміщувати артефакти і генерував помилкові метадані. Тому, несподівано для себе, у мене запрацював апачевський варіант. Він виявився не таким гарним, зате працює надійно. На сторінці <a href="http://archiva.apache.org/download.cgi" target="_blank" rel="nofollow">завантаження</a> шукаємо Standalone версію, розпаковуємо. У них є свій " <a href="http://archiva.apache.org/docs/2.2.3/quick-start.html" target="_blank" rel="nofollow">Quick Start</a> ". Після запуску слід дочекатися, коли за адресаою <code class=" language-none">http://127.0.0.1:8080/#repositorylist</code>. Після цього вибираємо "Upload Artifact": 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="8edcee3e-2eeb-4ce7-9d04-7e3293a430e9" data-max-width="710" alt="IntelliJ Idea : Декомпіляція, Компіляція, Субституція (або як правити чужі помилки) - 10" src="https://cdn.javarush.com/images/article/8edcee3e-2eeb-4ce7-9d04-7e3293a430e9/512.jpeg" style="width: 710px;">
 </div>
</div> Натискаємо "Start Upload", а після "Save Files". Після цього з'явиться зелене повідомлення про успішність і артефакт стане доступним у розділі "Browse". Так треба зробити для jar та для pom файлів: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="5f4cba5a-e63f-4804-bfee-73128f897f58" data-max-width="710" alt="IntelliJ Idea : Декомпіляція, Компіляція, Субституція (або як правити чужі помилки) - 11" src="https://cdn.javarush.com/images/article/5f4cba5a-e63f-4804-bfee-73128f897f58/512.jpeg" style="width: 710px;">
 </div>
</div> Це з тим, що у pom файлі прописані додаткові залежності хибернейта. А нам залишилося лише 1 крок – вказати репозиторій у нашому білд скрипті: 
<pre class=" language-none" tabindex="0"><code class=" language-none">
repositories {
    jcenter()
    maven {
        url "http://127.0.0.1:8080/repository/internal/"
    }
}</code></pre> І, відповідно, версія нашого хібернейту стане: <code class=" language-none">compile 'org.hibernate:hibernate-core:5.2.17.Final-CODEGYM'</code>. Ось і все тепер наш проект використовує виправлений нами варіант, а не початковий. 
<h2>Висновок</h2>От наче й ознайомабось. Сподіваюся, було цікаво. Подібні "трюки" робляться рідко, але якщо раптом ваші бізнес вимоги поставлять умови, які не можуть задовольнити бібліотеки, що використовуються - ви знаєте що робити. І так, ось кілька прикладів, що може так виправлятися: 
<ul>
 <li>Є такий веб-сервер Undertow. До деякого часу був баг, який при використанні проксі не давав дізнатися про IP кінцевого користувача.</li>
 <li>До певного часу WildFly JPA певним чином обробляв один не врахований специфікацією момент, через що сипалися Exception. І це не налаштовувалося.</li>
</ul> #Viacheslav