Клас MessageFormat
<p>----------------------------------------</p>
У цій статті я хочу розповісти про клас , який використовується у задачі 2412 (task2412). Клас призначений для створення рядків. Даний клас Java приймає набір об'єктів, форматує їх, а потім вставляє форматовані рядки у шаблон у відповідних 
<p>----------------------------------------</p>
У цій статті я хочу розповісти про клас <code class=" language-none">MessageFormat</code>, який використовується у задачі 2412 (task2412). <img data-id="9b79ba9c-91fc-4e92-8682-836b718a243d" data-max-width="850" alt="Клас MessageFormat - 1" src="https://cdn.javarush.com/images/article/9b79ba9c-91fc-4e92-8682-836b718a243d/800.jpeg" style="width: 850px;">Клас <code class=" language-none">MessageFormat</code>призначений для створення рядків. Даний клас Java приймає набір об'єктів, форматує їх, а потім вставляє форматовані рядки у шаблон у відповідних місцях. Це свого роду альтернатива (або навіть доповнення) до статичного методу <code class=" language-none">String.format</code>. Для початку простий приклад використання цього Java класу без створення об'єкта, а використовуючи статичний метод: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">int</span></span> planet <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">7</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">String</span></span> event <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"a disturbance in the Force"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">String</span></span> result <span class="token operator"><span class="token operator">=</span></span> <span class="token class-name"><span class="token class-name">MessageFormat</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">format</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>
        <span class="token string"><span class="token string">"At {0, time, medium} on {0, date}, there was {1} on planet {2, number, integer}."</span></span><span class="token punctuation"><span class="token punctuation">,</span></span>
        <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Date</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> event<span class="token punctuation"><span class="token punctuation">,</span></span> planet<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>result<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Тут викликається статичний метод <code class=" language-none">MessageFormat.format</code>, в який передаються аргументами шаблон рядка і, власне, об'єкти, які будуть вставлені в місця, обмежені дужками <code class=" language-none">{}</code>. У дужках задається позиція об'єкта починаючи з <code class=" language-none">0</code>, а також тип форматування, якщо є. Висновок буде таким: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">At</span></span> <span class="token number"><span class="token number">21</span></span><span class="token operator"><span class="token operator">:</span></span><span class="token number"><span class="token number">25</span></span><span class="token operator"><span class="token operator">:</span></span><span class="token number"><span class="token number">54</span></span> on <span class="token number"><span class="token number">28</span></span> апр<span class="token punctuation"><span class="token punctuation">.</span></span> <span class="token number"><span class="token number">2018</span></span> г<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> there was a disturbance in the <span class="token class-name"><span class="token class-name">Force</span></span> on planet <span class="token number"><span class="token number">7.</span></span></code></pre> У наступному прикладі вже створюється об'єкт класу <code class=" language-none">MessageFormat</code>: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">int</span></span> fileCount <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">1273</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">String</span></span> diskName <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"MyDisk"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">Object</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> testArgs <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>fileCount<span class="token punctuation"><span class="token punctuation">,</span></span> diskName<span class="token punctuation"><span class="token punctuation">}</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token class-name"><span class="token class-name">MessageFormat</span></span> form <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">MessageFormat</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>
        <span class="token string"><span class="token string">"The disk \"{1}\" contains {0} file(s)."</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>form<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">format</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>testArgs<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> При створенні об'єкта класу <code class=" language-none">MessageFormat</code>до його конструктора передається шаблон рядка. Далі, при виклику методу <code class=" language-none">format</code>об'єкта, туди як аргумент передається масив об'єктів, які будуть вставлені в шаблон рядка. Висновок буде таким: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">The</span></span> disk <span class="token string"><span class="token string">"MyDisk"</span></span> contains <span class="token number"><span class="token number">1</span></span> <span class="token number"><span class="token number">273</span></span> <span class="token function"><span class="token function">file</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>s<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span></code></pre> Також можна зробити так, що в залежності від значення змінної вибиратиметься необхідний текст. Свого роду реалізація оператора <code class=" language-none">if...else</code>, лише з допомогою класу <code class=" language-none">ChoiceFormat</code>. Ось код: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">MessageFormat</span></span> form <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">MessageFormat</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Я могу {1} {0}."</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">int</span></span> count <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">2</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">String</span></span> exercise <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"подтянуться"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">Object</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> testArgs <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>count<span class="token punctuation"><span class="token punctuation">,</span></span> exercise<span class="token punctuation"><span class="token punctuation">}</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">double</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> filelimits <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span><span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">,</span></span><span class="token number"><span class="token number">2</span></span><span class="token punctuation"><span class="token punctuation">,</span></span><span class="token number"><span class="token number">5</span></span><span class="token punctuation"><span class="token punctuation">}</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> filepart <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span><span class="token string"><span class="token string">"{0} раз"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span><span class="token string"><span class="token string">"{0} раза"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span><span class="token string"><span class="token string">"{0} раз"</span></span><span class="token punctuation"><span class="token punctuation">}</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">ChoiceFormat</span></span> fileform <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ChoiceFormat</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>filelimits<span class="token punctuation"><span class="token punctuation">,</span></span> filepart<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
form<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">setFormatByArgumentIndex</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> fileform<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>form<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">format</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>testArgs<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Цей код залежно від значення змінної <code class=" language-none">count</code>змінює виведення рядка таким чином: 
<ul>
 <li>
  <p>якщо <code class=" language-none">count = 1</code>висновок буде таким</p>
  <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java">Я могу подтянуться <span class="token number"><span class="token number">1</span></span> раз<span class="token punctuation"><span class="token punctuation">.</span></span></code></pre></li>
 <li>
  <p>якщо <code class=" language-none">count = 2</code>висновок буде таким</p>
  <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java">Я могу подтянуться <span class="token number"><span class="token number">2</span></span> раза<span class="token punctuation"><span class="token punctuation">.</span></span></code></pre></li>
 <li>
  <p>якщо <code class=" language-none">count = 7</code>висновок буде таким</p>
  <pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java">Я могу подтянуться <span class="token number"><span class="token number">7</span></span> раз<span class="token punctuation"><span class="token punctuation">.</span></span></code></pre></li>
</ul> У цьому коді створюється масив <code class=" language-none">double[] filelimits</code>, у якому вказуються межі значень, у яких змінюватиметься виведення рядків. На масиві <code class=" language-none">String[] filepart</code>вказуються самі варіанти рядків, які можна використовувати. Умови вибору варіанта рядка від значення змінної визначаються так: вибереться варіант <code class=" language-none">filepart[j]</code>, якщо <code class=" language-none">filelimits[j] =&lt; count &lt; filelimits[j+1]</code>. Далі створюється об'єкт <code class=" language-none">ChoiceFormat fileform</code>і його конструктор передаються масиви <code class=" language-none">double[] filelimits</code>і <code class=" language-none">String[] filepart</code>. За допомогою методу <code class=" language-none">form.setFormatByArgumentIndex(0, fileform)</code>ми говоримо об'єкту <code class=" language-none">MessageFormat form</code>, що коли викличуть метод <code class=" language-none">format</code>, то для індексу 0 у шаблоні рядка використовуй форматування, яке було задано в об'єкті <code class=" language-none">ChoiceFormat fileform</code>. Добре. У вас вже в принципі могла з'явитися думка ніколи не використовувати Java клас<code class=" language-none">MessageFormat</code>але знайте, що це ще не всі примочки. Є такий код: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">MessageFormat</span></span> pattform <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">MessageFormat</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"There {0} on {1}.\n{2} {2}"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">int</span></span> count <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">Date</span></span> date <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Date</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">Object</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> testArgs <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>count<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"ADisk"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> date<span class="token punctuation"><span class="token punctuation">,</span></span> date<span class="token punctuation"><span class="token punctuation">}</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">double</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> filelimits <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span><span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">,</span></span><span class="token number"><span class="token number">1</span></span><span class="token punctuation"><span class="token punctuation">,</span></span><span class="token number"><span class="token number">2</span></span><span class="token punctuation"><span class="token punctuation">}</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> filepart <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span><span class="token string"><span class="token string">"are no files"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span><span class="token string"><span class="token string">"is one file"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span><span class="token string"><span class="token string">"are {0} files"</span></span><span class="token punctuation"><span class="token punctuation">}</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">ChoiceFormat</span></span> fileform <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ChoiceFormat</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>filelimits<span class="token punctuation"><span class="token punctuation">,</span></span> filepart<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token class-name"><span class="token class-name">Format</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> testFormats
        <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>fileform<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token keyword"><span class="token keyword">null</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">DateFormat</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getDateInstance</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">DateFormat</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>SHORT<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">DateFormat</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getTimeInstance</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">DateFormat</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>SHORT<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">}</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
pattform<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">setFormats</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>testFormats<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>pattform<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">format</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>testArgs<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Тут основна фішка в масиві <code class=" language-none">Format[] testFormats</code>. У цей масив ми заносимо об'єкти (що реалізують абстрактний клас <code class=" language-none">Format</code>), які відповідають за форматування об'єктів, визначених у масиві <code class=" language-none">Object[] testArgs</code>. Якщо об'єкт не потребує форматування, то масив <code class=" language-none">Format[] testFormats</code>записується <code class=" language-none">null</code>. Далі за допомогою методу <code class=" language-none">pattform.setFormats(testFormats)</code>ми говоримо об'єкту <code class=" language-none">MessageFormat pattform</code>, що для всіх індексів у шаблоні рядка треба використовувати форматування, визначене в масиві <code class=" language-none">Format[] testFormats</code>. Для цього приклад висновок буде таким: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">There</span></span> are no files on <span class="token class-name"><span class="token class-name">ADisk</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>
<span class="token number"><span class="token number">28.04</span></span><span class="token number"><span class="token number">.18</span></span> <span class="token number"><span class="token number">22</span></span><span class="token operator"><span class="token operator">:</span></span><span class="token number"><span class="token number">10</span></span></code></pre> На цьому все і я сподіваюся, що при вирішенні задачі 2412 у вас не виникне труднощів.