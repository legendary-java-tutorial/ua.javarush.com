Регулярні вирази в Java, частина 5
<p>----------------------------------------</p>
Пропонуємо до вашої уваги переклад короткого посібника з регулярних виразів у мові Java, написаного Джеффом Фрісеном (Jeff Friesen) для сайту javaworld. Для простоти читання ми розділили статтю кілька частин. Ця частина - остання. Ще більш 
<p>----------------------------------------</p>
Пропонуємо до вашої уваги переклад короткого посібника з регулярних виразів у мові Java, написаного Джеффом Фрісеном (Jeff Friesen) для сайту javaworld. Для простоти читання ми розділабо статтю кілька частин. Ця частина - остання. <img data-max-width="800" data-id="42bced17-119d-411e-9554-a1c760fb4644" class="img-fluid" alt="Регулярні вирази Java, частина 5 - 1" src="https://cdn.javarush.com/images/article/42bced17-119d-411e-9554-a1c760fb4644/800.jpeg" style="width: 800px;"><a href="https://codegym.cc/groups/posts/136-reguljarnihe-vihrazhenija-v-java-chastjh-1" target="_blank">Регулярні вирази в Java, частина 1 </a> <a href="https://codegym.cc/groups/posts/154-reguljarnihe-vihrazhenija-v-java-chastjh-2" target="_blank">Регулярні вирази в Java, частина 2 </a> <a href="https://codegym.cc/groups/posts/186-reguljarnihe-vihrazhenija-v-java-chastjh-3" target="_blank">Регулярні вирази в Java, частина 3 </a> <a href="https://codegym.cc/groups/posts/229-reguljarnihe-vihrazhenija-v-java-chastjh-4" target="_blank">Регулярні вирази в Java, частина 4</a>
<h2>Використання регулярних виразів для лексичного аналізу</h2>Ще більш корисний додаток регулярних виразів – бібліотека, що допускає багаторазове використання коду для виконання лексичного аналізу, ключовий компонент будь-якого компілятора або асемблера. У цьому випадку вхідний потік символів групується у вихідний потік маркерів (token) – імен для послідовностей символів, що мають загальне значення. Наприклад, наткнувшись у вхідному потоці на послідовність символів <code class=" language-none">c</code>, <code class=" language-none">o</code>, <code class=" language-none">u</code>, <code class=" language-none">n</code>, <code class=" language-none">t</code>, <code class=" language-none">e</code>, <code class=" language-none">r</code>, лексичний аналізатор може вивести маркер <code class=" language-none">ID</code>(ідентифікатор). Відповідна маркеру послідовність символів називається лексемою (lexeme). 
<div class="table-container">
 <table>
  <thead>
   <tr>
    <th>Ще про маркери та лексеми</th>
   </tr>
  </thead>
  <tbody>
   <tr>
    <td>Такі маркери, як ID, можуть відповідати багатьом послідовностям символів. У випадку подібних маркерів фактична лексема, що відповідає маркеру, теж необхідна компілятору, асемблеру або іншій утиліті, якій потрібен лексичний аналіз. Для маркерів, які представляють одну конкретну послідовність символів, як маркер <code class=" language-none">PLUS</code>, відповідний лише символу <code class=" language-none">+</code>, фактична лексема не потрібно, оскільки її можна [однозначно] визначити за маркером.</td>
   </tr>
  </tbody>
 </table>
</div><a href="https://codegym.cc/groups/posts/2013-reguljarnihe-vihrazhenija-v-java" target="_blank">Регулярні вирази</a> набагато ефективніші за лексичні аналізатори на основі [кінцевого] ​​стану, які необхідно писати вручну і зазвичай не можна використовувати повторно. Як приклад лексичного аналізатора на основі регулярних виразів можна навести <a href="http://www.cs.princeton.edu/~appel/modern/java/JLex/current/manual.html" target="_blank">JLex</a> , лексичний генератор для мови Java, що використовує регулярні вирази для завдання правил розбиття вхідного потоку даних на маркери. Ще один приклад – Lexan. 
<h2>Знайомимося з Lexan</h2>Lexan - допускає багаторазове використання Java-бібліотека, призначена для лексичного аналізу. Вона заснована на коді із серії повідомлень із блогу<a href="http://cogitolearning.co.uk/2013/03/writing-a-parser-in-java-introduction/" target="_blank"> Пишемо синтаксичний аналізатор на мові Java</a> веб-сайту <a href="http://cogitolearning.co.uk/" target="_blank">Cogito Learning</a> . <span class="text-bold">Бібліотека складається з наступних класів, які знаходяться в пакеті <code class=" language-none">ca.javajeff.lexan</code>, включеному в завантажуваний код цієї статті:</span>
<ul>
 <li><code class=" language-none">Lexan</code>: лексичний аналізатор;</li><code class=" language-none">LexanException</code>: виняток, що генерується в конструкторі класу<code class=" language-none">Lexan;</code>
 <li><code class=" language-none">LexException</code>: виняток, що генерується у разі виявлення неправильного синтаксису при лексичному аналізі;</li>
 <li><code class=" language-none">Token</code>: назва з атрибутом-регулярним виразом;</li>
 <li><code class=" language-none">TokLex</code>: пара маркер/лексема.</li>
</ul>Конструктор <code class=" language-none">Lexan(java.lang.Class tokensClass)</code>створює новий лексичний аналізатор. Для нього потрібен один аргумент у вигляді об'єкта класу <code class=" language-none">java.lang.Class</code>, що відповідає класу констант типу <code class=" language-none">static Token</code>. За допомогою API Reflection конструктор читає всі константи <code class=" language-none">Token</code>в масив значень <code class=" language-none">Token[]</code>. Якщо констант <code class=" language-none">Token</code>немає, генерується виняток <code class=" language-none">LexanException</code>. <img data-max-width="800" data-id="6d27ccf9-12eb-4243-adf4-20bbf06963c2" class="img-fluid" alt="Регулярні вирази у Java, частина 5 - 2" src="https://cdn.javarush.com/images/article/6d27ccf9-12eb-4243-adf4-20bbf06963c2/800.jpeg" style="width: 800px;"><span class="text-bold">Клас <code class=" language-none">Lexan</code>також надає такі два методи:</span>
<ul>
 <li>Метод повертає перелік цього лексичного аналізатора;<code class=" language-none">List<toklex>
    getTokLexes()
   </toklex></code><code class=" language-none">Token</code></li>
 <li><code class=" language-none">Метод void lex(String str)</code>виконує лексичний аналіз вхідного рядка [з поміщенням результату] до списку значень типу <code class=" language-none">TokLex</code>. У разі виявлення символу, що не відповідає жодному з шаблонів масиву <code class=" language-none">Token[]</code>, генерується виняток <code class=" language-none">LexException</code>.</li>
</ul>У класі <code class=" language-none">LexanException</code>методів немає, він використовує для повернення повідомлення виключення успадкований метод <code class=" language-none">getMessage()</code>. <span class="text-bold">На відміну від нього, клас <code class=" language-none">LexException</code>надає такі методи:</span>
<ul>
 <li>Метод <code class=" language-none">int getBadCharIndex()</code>повертає позицію символу, що не відповідає жодному шаблону маркерів.</li>
 <li>Метод <code class=" language-none">String getText()</code>повертає аналізований при генерації виключення текст.</li>
</ul>Клас <code class=" language-none">Token</code>перевизначає метод <code class=" language-none">toString()</code>повернення назви маркера. Він також надає метод <code class=" language-none">String getPattern()</code>, що повертає атрибут регулярного вираження маркера. Клас <code class=" language-none">TokLex</code>надає метод <code class=" language-none">Token getToken()</code>, який повертає його маркер. Він також надає метод <code class=" language-none">String getLexeme()</code>, який повертає його лексему. 
<h2>Демонстрація роботи бібліотеки Lexan</h2>Для демонстрації роботи бібліотеки <code class=" language-none">Lexan</code>я написав додаток <code class=" language-none">LexanDemo</code>. Воно складається з класів <code class=" language-none">LexanDemo</code>, <code class=" language-none">BinTokens</code>, <code class=" language-none">MathTokens</code>та <code class=" language-none">NoTokens</code>. Вихідний код програми <code class=" language-none">LexanDemo</code>наведено у лістингу 2. <span class="text-bold">Лістинг 2. Демонстрація роботи бібліотеки Lexan</span>
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">ca<span class="token punctuation"><span class="token punctuation">.</span></span>javajeff<span class="token punctuation"><span class="token punctuation">.</span></span>lexan<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">Lexan</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">ca<span class="token punctuation"><span class="token punctuation">.</span></span>javajeff<span class="token punctuation"><span class="token punctuation">.</span></span>lexan<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">LexanException</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">ca<span class="token punctuation"><span class="token punctuation">.</span></span>javajeff<span class="token punctuation"><span class="token punctuation">.</span></span>lexan<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">LexException</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">ca<span class="token punctuation"><span class="token punctuation">.</span></span>javajeff<span class="token punctuation"><span class="token punctuation">.</span></span>lexan<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">TokLex</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">LexanDemo</span></span>
<span class="token punctuation"><span class="token punctuation">{</span></span>
   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span>
   <span class="token punctuation"><span class="token punctuation">{</span></span>
      <span class="token function"><span class="token function">lex</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">MathTokens</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token keyword"><span class="token keyword">class</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">" sin(x) * (1 + var_12) "</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      <span class="token function"><span class="token function">lex</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">BinTokens</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token keyword"><span class="token keyword">class</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">" 1 0 1 0 1"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      <span class="token function"><span class="token function">lex</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">BinTokens</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token keyword"><span class="token keyword">class</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"110"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      <span class="token function"><span class="token function">lex</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">BinTokens</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token keyword"><span class="token keyword">class</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"1 20"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      <span class="token function"><span class="token function">lex</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">NoTokens</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token keyword"><span class="token keyword">class</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">""</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token punctuation"><span class="token punctuation">}</span></span>

   <span class="token keyword"><span class="token keyword">private</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">lex</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Class</span></span> tokensClass<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">String</span></span> text<span class="token punctuation"><span class="token punctuation">)</span></span>
   <span class="token punctuation"><span class="token punctuation">{</span></span>
      <span class="token keyword"><span class="token keyword">try</span></span>
      <span class="token punctuation"><span class="token punctuation">{</span></span>
         <span class="token class-name"><span class="token class-name">Lexan</span></span> lexan <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Lexan</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>tokensClass<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
         lexan<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">lex</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>text<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
         <span class="token keyword"><span class="token keyword">for</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">TokLex</span></span> tokLex<span class="token operator"><span class="token operator">:</span></span> lexan<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getTokLexes</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
            <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">printf</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"%s: %s%n"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> tokLex<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getToken</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">,</span></span>
                              tokLex<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getLexeme</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      <span class="token punctuation"><span class="token punctuation">}</span></span>
      <span class="token keyword"><span class="token keyword">catch</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">LexanException</span></span> le<span class="token punctuation"><span class="token punctuation">)</span></span>
      <span class="token punctuation"><span class="token punctuation">{</span></span>
         <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>err<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>le<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getMessage</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      <span class="token punctuation"><span class="token punctuation">}</span></span>
      <span class="token keyword"><span class="token keyword">catch</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">LexException</span></span> le<span class="token punctuation"><span class="token punctuation">)</span></span>
      <span class="token punctuation"><span class="token punctuation">{</span></span>
         <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>err<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>le<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getText</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
         <span class="token keyword"><span class="token keyword">for</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">int</span></span> i <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> i <span class="token operator"><span class="token operator">&lt;</span></span> le<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getBadCharIndex</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> i<span class="token operator"><span class="token operator">++</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
            <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>err<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">print</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"-"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
         <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>err<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"^"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
         <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>err<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>le<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getMessage</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      <span class="token punctuation"><span class="token punctuation">}</span></span>
      <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Метод <code class=" language-none">main()</code>з лістингу 2 викликає утиліту <code class=" language-none">lex()</code>для демонстрації лексичного аналізу за допомогою Lexan. При кожному виклику цьому методу передається клас маркерів в об'єкті <code class=" language-none">Class</code>та рядок, аналіз якого необхідно виконати. Метод <code class=" language-none"> lex()</code>спочатку створює об'єкт класу <code class=" language-none">Lexan</code>, передаючи об'єкт <code class=" language-none">Class</code>конструктору класу <code class=" language-none">Lexan</code>. А потім він викликає метод <code class=" language-none">lex()</code>класу <code class=" language-none">Lexan</code>для цього рядка. У разі успішного виконання лексичного аналізу з метою повернення списку об'єктів <code class=" language-none">TokLex</code>викликається метод <code class=" language-none">getTokLexes()</code>класу <code class=" language-none">Lexan</code>. Для кожного з цих об'єктів викликається його метод <code class=" language-none">getToken()</code>класу <code class=" language-none">TokLex</code>для повернення маркера та його метод<code class=" language-none">getLexeme()</code>для повернення лексеми. Обидва значення виводяться у стандартний потік виведення. У разі невдачі лексичного аналізу генерується і обробляється відповідним чином один із винятків <code class=" language-none">LexanException</code>або <code class=" language-none">LexException</code>. Для стислості, розглянемо, зі складових цю програму, тільки клас <code class=" language-none">MathTokens</code>. У лістингу 3 показаний вихідний код. <span class="text-bold">Лістинг 3. Опис набору маркерів для невеликої математичної мови</span>
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">ca<span class="token punctuation"><span class="token punctuation">.</span></span>javajeff<span class="token punctuation"><span class="token punctuation">.</span></span>lexan<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">MathTokens</span></span>
<span class="token punctuation"><span class="token punctuation">{</span></span>
   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token class-name"><span class="token class-name">Token</span></span> FUNC <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"FUNC"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"sin|cos|exp|ln|sqrt"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token class-name"><span class="token class-name">Token</span></span> LPAREN <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"LPAREN"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"\\("</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token class-name"><span class="token class-name">Token</span></span> RPAREN <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"RPAREN"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"\\)"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token class-name"><span class="token class-name">Token</span></span> PLUSMIN <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"PLUSMIN"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"[+-]"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token class-name"><span class="token class-name">Token</span></span> TIMESDIV <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"TIMESDIV"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"[*/]"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token class-name"><span class="token class-name">Token</span></span> CARET <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"CARET"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"\\^"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token class-name"><span class="token class-name">Token</span></span> INTEGER <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"INTEGER"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"[0-9]+"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token class-name"><span class="token class-name">Token</span></span> ID <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"ID"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"[a-zA-Z][a-zA-Z0-9_]*"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> З лістингу 3 видно, що клас <code class=" language-none">MathTokens</code>визначає послідовність констант типу <code class=" language-none">Token</code>. Кожній із них присвоюється значення об'єкта <code class=" language-none">Token</code>. Конструктор цього об'єкта отримує рядок-назву маркера, разом із регулярним виразом, що описує всі рядки символів, що належать до цього маркеру. Для ясності бажано, щоб рядкова назва маркера збігалася з назвою константи, але це не обов'язково. <img data-max-width="800" data-id="363409bf-80bd-4588-bc7b-8e81f36a3596" class="img-fluid" alt="Регулярні вирази у Java, частина 5 - 3" src="https://cdn.javarush.com/images/article/363409bf-80bd-4588-bc7b-8e81f36a3596/800.jpeg" style="width: 800px;">Позиція константи <code class=" language-none">Token</code>у списку маркерів є важливою. Розташовані вище списку константи <code class=" language-none">Token</code>мають пріоритет перед розташованими нижче. Наприклад, зустрівши <code class=" language-none">sin</code>, Lexan вибирає маркер <code class=" language-none">FUNC</code>замість <code class=" language-none">ID</code>. Якби маркер <code class=" language-none">ID</code>передував маркеру <code class=" language-none">FUNC</code>, то був би обраний він. 
<h2>Компіляція та запуск програми LexanDemo</h2>Завантажуваний код цієї статті включає архів <code class=" language-none">lexan.zip</code>, що містить всі файли дистрибутива Lexan. Розпакуйте цей архів і перейдіть в підкаталог <code class=" language-none">demos</code>кореневого каталогу <code class=" language-none">lexan</code>. <span class="text-bold">Якщо ви використовуєте Windows, виконайте наступну команду для компіляції файлів вихідного коду демо-програми:</span>
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java">javac <span class="token operator"><span class="token operator">-</span></span>cp <span class="token punctuation"><span class="token punctuation">.</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>\library\lexan<span class="token punctuation"><span class="token punctuation">.</span></span>jar <span class="token operator"><span class="token operator">*</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>java</code></pre><span class="text-bold">У разі успішної компіляції виконайте наступну команду для запуску демо-додатків:</span>
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class="  language-java">java <span class="token operator"><span class="token operator">-</span></span>cp <span class="token punctuation"><span class="token punctuation">.</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>\library\lexan<span class="token punctuation"><span class="token punctuation">.</span></span>jar<span class="token punctuation"><span class="token punctuation">;</span></span><span class="token punctuation"><span class="token punctuation">.</span></span> <span class="token class-name"><span class="token class-name">LexanDemo</span></span></code></pre><span class="text-bold">Ви повинні побачити такі результати:</span>
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java">FUNC<span class="token operator"><span class="token operator">:</span></span> sin
LPAREN<span class="token operator"><span class="token operator">:</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>
ID<span class="token operator"><span class="token operator">:</span></span> x
RPAREN<span class="token operator"><span class="token operator">:</span></span> <span class="token punctuation"><span class="token punctuation">)</span></span>
TIMESDIV<span class="token operator"><span class="token operator">:</span></span> <span class="token operator"><span class="token operator">*</span></span>
LPAREN<span class="token operator"><span class="token operator">:</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>
INTEGER<span class="token operator"><span class="token operator">:</span></span> <span class="token number"><span class="token number">1</span></span>
PLUSMIN<span class="token operator"><span class="token operator">:</span></span> <span class="token operator"><span class="token operator">+</span></span>
ID<span class="token operator"><span class="token operator">:</span></span> var_12
RPAREN<span class="token operator"><span class="token operator">:</span></span> <span class="token punctuation"><span class="token punctuation">)</span></span>
ONE<span class="token operator"><span class="token operator">:</span></span> <span class="token number"><span class="token number">1</span></span>
ZERO<span class="token operator"><span class="token operator">:</span></span> <span class="token number"><span class="token number">0</span></span>
ONE<span class="token operator"><span class="token operator">:</span></span> <span class="token number"><span class="token number">1</span></span>
ZERO<span class="token operator"><span class="token operator">:</span></span> <span class="token number"><span class="token number">0</span></span>
ONE<span class="token operator"><span class="token operator">:</span></span> <span class="token number"><span class="token number">1</span></span>
ONE<span class="token operator"><span class="token operator">:</span></span> <span class="token number"><span class="token number">1</span></span>
ONE<span class="token operator"><span class="token operator">:</span></span> <span class="token number"><span class="token number">1</span></span>
ZERO<span class="token operator"><span class="token operator">:</span></span> <span class="token number"><span class="token number">0</span></span>
<span class="token number"><span class="token number">1</span></span> <span class="token number"><span class="token number">20</span></span>
<span class="token operator"><span class="token operator">--</span></span><span class="token operator"><span class="token operator">^</span></span>
Неожиданный символ во входном тексте<span class="token operator"><span class="token operator">:</span></span> <span class="token number"><span class="token number">20</span></span></code></pre> Повідомлення <code class=" language-none">Неожиданный символ во входном тексте: 20</code>виникає в результаті генерації виключення <code class=" language-none">LexanException</code>, викликаного тим, що в класі <code class=" language-none">BinTokens</code>не описана константа <code class=" language-none">Token</code>зі значенням <code class=" language-none">2</code>як регулярний вираз. Зверніть увагу, що обробник винятків вивів отриману в результаті лексичного аналізу тексту позицію невідповідного символу. Повідомлення маркери відсутні виходить у результаті генерації винятку <code class=" language-none">LexException</code>, викликаного тим, що в класі <code class=" language-none">NoTokens</code>не описано жодних констант <code class=" language-none">Token</code>. 
<h2>За лаштунками</h2><code class=" language-none">Lexan</code>використовує як свій "движок" клас Lexan. Погляньте на реалізацію цього класу в лістингу 4 і відзначте внесок регулярних виразів у можливість повторного використання "движка". <span class="text-bold">Лістинг 4. Створення архітектури лексичного аналізатора на основі регулярних виразів</span>
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">ca<span class="token punctuation"><span class="token punctuation">.</span></span>javajeff<span class="token punctuation"><span class="token punctuation">.</span></span>lexan</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>lang<span class="token punctuation"><span class="token punctuation">.</span></span>reflect<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">Field</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>util<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">ArrayList</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>util<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">List</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>util<span class="token punctuation"><span class="token punctuation">.</span></span>regex<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">Matcher</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token comment"><span class="token comment">/**
 *  Лексический анализатор. Этот класс можно использовать для
 *  преобразования входного потока символов в выходной поток маркеров.
 *
 *  @Автор Джефф Фризен
 */</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">Lexan</span></span>
<span class="token punctuation"><span class="token punctuation">{</span></span>
   <span class="token keyword"><span class="token keyword">private</span></span> <span class="token class-name"><span class="token class-name">List</span></span><toklex> tokLexes<span class="token punctuation"><span class="token punctuation">;</span></span>

   <span class="token keyword"><span class="token keyword">private</span></span> <span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> values<span class="token punctuation"><span class="token punctuation">;</span></span>

   <span class="token comment"><span class="token comment">/**
    *  Инициализируем лексический анализатор набором об'єктов Token.
    *
    *  @параметры tokensClass – об'єкт Class класса, содержащего
    *       набор об'єктов Token
    *
    *  @генерирует исключение LexanException в случае невозможности
    *       формирования об'єкта Lexan, возможно, из-за отсутствия об'єктов
    *       Token в классе
    */</span></span>

   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">Lexan</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Class</span></span> tokensClass<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">LexanException</span></span>
   <span class="token punctuation"><span class="token punctuation">{</span></span>
      <span class="token keyword"><span class="token keyword">try</span></span>
      <span class="token punctuation"><span class="token punctuation">{</span></span>
         tokLexes <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ArrayList</span></span><span class="token generics"><span class="token punctuation"></span><span class="token generics"><span class="token punctuation"><span class="token punctuation">&lt;</span></span><span class="token punctuation"><span class="token punctuation">&gt;</span></span></span><span class="token punctuation"></span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
         <span class="token class-name"><span class="token class-name">List</span></span><token> _values <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ArrayList</span></span><span class="token generics"><span class="token punctuation"></span><span class="token generics"><span class="token punctuation"><span class="token punctuation">&lt;</span></span><span class="token punctuation"><span class="token punctuation">&gt;</span></span></span><span class="token punctuation"></span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
         <span class="token class-name"><span class="token class-name">Field</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> fields <span class="token operator"><span class="token operator">=</span></span> tokensClass<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getDeclaredFields</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
         <span class="token keyword"><span class="token keyword">for</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Field</span></span> field<span class="token operator"><span class="token operator">:</span></span> fields<span class="token punctuation"><span class="token punctuation">)</span></span>
            <span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>field<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getType</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getName</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">equals</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"ca.javajeff.lexan.Token"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
               _values<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">add</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> field<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">get</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">null</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
         values <span class="token operator"><span class="token operator">=</span></span> _values<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">toArray</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Token</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">]</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
         <span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>values<span class="token punctuation"><span class="token punctuation">.</span></span>length <span class="token operator"><span class="token operator">==</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
            <span class="token keyword"><span class="token keyword">throw</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">LexanException</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"маркеры отсутствуют"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      <span class="token punctuation"><span class="token punctuation">}</span></span>
      <span class="token keyword"><span class="token keyword">catch</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">IllegalAccessException</span></span> iae<span class="token punctuation"><span class="token punctuation">)</span></span>
      <span class="token punctuation"><span class="token punctuation">{</span></span>
         <span class="token keyword"><span class="token keyword">throw</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">LexanException</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>iae<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getMessage</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      <span class="token punctuation"><span class="token punctuation">}</span></span>

   <span class="token comment"><span class="token comment">/**
    * Получаем список TokLex'ов этого лексического анализатора.
    *
    *  @возвращает список TokLex'ов
    */</span></span>

   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">List</span></span><toklex> <span class="token function"><span class="token function">getTokLexes</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
   <span class="token punctuation"><span class="token punctuation">{</span></span>
      <span class="token keyword"><span class="token keyword">return</span></span> tokLexes<span class="token punctuation"><span class="token punctuation">;</span></span>
   <span class="token punctuation"><span class="token punctuation">}</span></span>

   <span class="token comment"><span class="token comment">/** * Выполняет лексический анализ входной строки [с помещением * результата] в список TokLex'ов. * * @параметры str – строка, подвергаемая лексическому анализу * * @генерирует исключение LexException: во входных данных обнаружен * неожиданный символ */</span></span>

   <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">lex</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span> str<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">LexException</span></span>
   <span class="token punctuation"><span class="token punctuation">{</span></span>
      <span class="token class-name"><span class="token class-name">String</span></span> s <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>str<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">trim</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">// удалить ведущие пробелы</span></span>
      <span class="token keyword"><span class="token keyword">int</span></span> index <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>str<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">length</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token operator"><span class="token operator">-</span></span> s<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">length</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      tokLexes<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">clear</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      <span class="token keyword"><span class="token keyword">while</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token operator"><span class="token operator">!</span></span>s<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">equals</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">""</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
      <span class="token punctuation"><span class="token punctuation">{</span></span>
         <span class="token keyword"><span class="token keyword">boolean</span></span> match <span class="token operator"><span class="token operator">=</span></span> <span class="token boolean"><span class="token boolean">false</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
         <span class="token keyword"><span class="token keyword">for</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">int</span></span> i <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> i <span class="token operator"><span class="token operator">&lt;</span></span> values<span class="token punctuation"><span class="token punctuation">.</span></span>length<span class="token punctuation"><span class="token punctuation">;</span></span> i<span class="token operator"><span class="token operator">++</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
         <span class="token punctuation"><span class="token punctuation">{</span></span>
            <span class="token class-name"><span class="token class-name">Token</span></span> token <span class="token operator"><span class="token operator">=</span></span> values<span class="token punctuation"><span class="token punctuation">[</span></span>i<span class="token punctuation"><span class="token punctuation">]</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
            <span class="token class-name"><span class="token class-name">Matcher</span></span> m <span class="token operator"><span class="token operator">=</span></span> token<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getPattern</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">matcher</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>s<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
            <span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>m<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">find</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
            <span class="token punctuation"><span class="token punctuation">{</span></span>
               match <span class="token operator"><span class="token operator">=</span></span> <span class="token boolean"><span class="token boolean">true</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
               tokLexes<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">add</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">TokLex</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>token<span class="token punctuation"><span class="token punctuation">,</span></span> m<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">group</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">trim</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
               <span class="token class-name"><span class="token class-name">String</span></span> t <span class="token operator"><span class="token operator">=</span></span> s<span class="token punctuation"><span class="token punctuation">;</span></span>
               s <span class="token operator"><span class="token operator">=</span></span> m<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">replaceFirst</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">""</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">trim</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">// удалить ведущие пробелы</span></span>
               index <span class="token operator"><span class="token operator">+=</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>t<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">length</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token operator"><span class="token operator">-</span></span> s<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">length</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
               <span class="token keyword"><span class="token keyword">break</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
            <span class="token punctuation"><span class="token punctuation">}</span></span>
         <span class="token punctuation"><span class="token punctuation">}</span></span>
         <span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token operator"><span class="token operator">!</span></span>match<span class="token punctuation"><span class="token punctuation">)</span></span>
            <span class="token keyword"><span class="token keyword">throw</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">LexException</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Неожиданный символ во входном тексте: "</span></span>
                                    <span class="token operator"><span class="token operator">+</span></span> s<span class="token punctuation"><span class="token punctuation">,</span></span> str<span class="token punctuation"><span class="token punctuation">,</span></span> index<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
      <span class="token punctuation"><span class="token punctuation">}</span></span>
   <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span>
</toklex></token></toklex></code></pre> Код методу <code class=" language-none">lex()</code>базується на коді, наведеному у повідомленні блогу <a href="http://cogitolearning.co.uk/2013/03/writing-a-parser-in-java-introduction/" target="_blank">"Пишемо синтаксичний аналізатор на мові Java: Генератор маркерів"</a> веб-сайту Cogito Learning. Прочитайте це повідомлення, щоб дізнатися більше про те, як Lexan використовує API Regex для компіляції коду. <a href="https://codegym.cc/welcome" target="_blank"><img data-max-width="1024" data-id="43855ae5-aed3-4e58-bbb2-e34e42081e71" class="img-fluid" alt="Регулярні вирази у Java, частина 5 - 4" src="https://cdn.javarush.com/images/article/43855ae5-aed3-4e58-bbb2-e34e42081e71/1024.jpeg" style="width: 1024px;"></a>
<h2>Висновок</h2>Регулярні вирази – корисний інструмент, який може стати у нагоді будь-якому розробнику. API Regex мови програмування Java спрощує їх використання у програмах та бібліотеках. Тепер, коли у вас вже є базове уявлення про регулярні вирази і цей API, загляньте в документацію SDK <code class=" language-none">java.util.regex</code>, щоб дізнатися ще більше про регулярні вирази і додаткові методи API Regex. 
<div class="table-container">
 <table>
  <tbody>
   <tr>
    <th>
     <p>Що ще почитати:</p></th>
   </tr>
   <tr>
    <td>
     <ul>
      <li><a href="https://codegym.cc/groups/posts/264-populjarno-o-ljambda-vihrazhenijakh-v-java-s-primerami-i-zadachami-chastjh-1-" target="_blank">Популярно про лямбда-вираження в Java. З прикладами та завданнями. Частина 1</a></li>
      <li><a href="https://codegym.cc/groups/posts/305-sozdanie-prosteyshego-web-proekta-v-intellij-idea-enterprise-edition-poshagovo-s-kartinkami" target="_blank">Створення найпростішого веб-проекту в IntelliJ Idea Enterprise. Покроково, з картинками</a></li>
      <li><a href="https://codegym.cc/groups/posts/234-luchshie-knigi-dlja-podgotovki-k-ehkzamenu-ocajp8-1z0-808-po-java-8" target="_blank">Кращі книги для підготовки до іспиту OCAJP8 (1Z0-808) з Java 8</a></li>
     </ul></td>
   </tr>
   <tr>
   </tr>
  </tbody>
 </table>
</div>