Рядки в Java (class java.lang.String)
<p>----------------------------------------</p>
Шлях програміста – складний та тривалий процес. І здебільшого починається він із програми, яка виводить Hello World на екран. Java не виняток (див. Lesson: ). Як бачимо, виведення повідомлення здійснюється з допомогою Якщо подивитися Java A
<p>----------------------------------------</p>
<h2>Вступ</h2>Шлях програміста – складний та тривалий процес. І здебільшого починається він із програми, яка виводить Hello World на екран. Java не виняток (див. Lesson: <a href="https://docs.oracle.com/javase/tutorial/getStarted/cupojava/index.html" target="_blank" rel="nofollow">The "Hello World!" Application</a> ). Як бачимо, виведення повідомлення здійснюється з допомогою <code class=" language-none">System.out.println("Hello World!");</code> Якщо подивитися Java API, то метод <a href="https://docs.oracle.com/javase/8/docs/api/java/io/PrintStream.html#println-java.lang.String-" target="_blank" rel="nofollow">System.out.println</a> приймає вхідним параметром <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" target="_blank" rel="nofollow">String</a> . Про цей тип даних і йтиметься. 
<h2>String як послідовність символів</h2>Власне, <strong>String</strong> у перекладі з англійської – рядок. Так і є тип String представляє текстовий рядок. А чим є текстовий рядок? Текстовий рядок – це якась упорядкована послідовність символів, які йдуть один за одним. Символ – char. Послідовність – sequence. Так що так, абсолютно правильно, String є реалізацією <code class=" language-none">java.lang.CharSequence</code>. А якщо заглянути всередину самого класу String, то всередині нього ніщо інше як масив char'ов: <code class=" language-none">private final char value[];</code> У <code class=" language-none">java.lang.CharSequence</code>досить простий контракт: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="3a95a4a2-be7c-47ab-b402-601dabba66c4" data-max-width="710" alt="Рядки в Java (class java.lang.String) - 1" src="https://cdn.javarush.com/images/article/3a95a4a2-be7c-47ab-b402-601dabba66c4/512.jpeg" style="width: 710px;">
 </div>
</div>У нас є метод отримання кількості елементів, отримання конкретного елемента та отримання набору елементів + ​​безпосередньо сам метод toString, який поверне this) Цікавіше розібратися в методах, які прийшли до нас у Java 8, а це: і Згадуємо Tutorial від Oracle <code class=" language-none">chars()</code>« <code class=" language-none">codePoints()</code> Primitive <a href="https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html" target="_blank" rel="nofollow">Data Types</a> », що char - це <code class=" language-none">single 16-bit Unicode character</code>. Тобто по суті char це просто тип розміром в половину типу int (32 біта), який представляє числа від 0 до 65535 (див. decimal значення <a href="https://simple.wikipedia.org/wiki/ASCII" target="_blank" rel="nofollow">ASCII Table</a> ). Тобто за бажання ми можемо char уявити у вигляді int. І Java 8 цим скористалися. Починаючи з 8 версії Java, у нас з'являється <strong>IntStream</strong>- стрим для роботи з примітивними int'ами. Тому в charSequence є можливість отримати IntStream, що представляє або char'и або codePoint'и. Перш ніж перейдемо до них, побачимо приклад, щоб показати всю зручність цього підходу. Скористаємося <a href="https://www.tutorialspoint.com/compile_java_online.php" target="_blank" rel="nofollow">Tutorialspoint online java compiler'ом</a> і виконаємо код: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span> <span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span>args<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">String</span></span> line <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"aaabccdddc"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span> line<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">chars</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">distinct</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">count</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Тепер таким нехитрим способом можна отримати кількість унікальних символів. 
<h2>CodePoints</h2>Отже, про chars ми побачабо. Тепер незрозуміло, що за кодові пункти такі. Поняття codePoint з'явилося тому, що коли Java з'явилася, вистачало 16 біт (половина int) щоб закодувати символ. Тому char в java представлений в форматі UTF-16 ("Unicode 88" specification). Пізніше з'явився Unicode 2.0, концепція якого полягала у поданні символу як сурогатної пари (2 чарів). Це дозволило розширити діапазон можливих значень значення int. Докладніше див. на stackoverflow: " <a href="https://stackoverflow.com/questions/1029897/comparing-a-char-to-a-code-point" target="_blank" rel="nofollow">Comparing a char to a code-point?</a> ". Про UTF-16 також зазначено і в JavaDoc до <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Character.html" target="_blank" rel="nofollow">Character</a> . Там же, в JavaDoc, сказано, що: <code class=" language-none">In this representation, supplementary characters are represented as a pair of char values, the first from the high-surrogates range, (\uD800-\uDBFF), the second from the low-surrogates range (\uDC00-\uDFFF).</code> На стандартних алфавітах досить важко (а може навіть не можна) відтворити це. Але символи буквами та цифрами не закінчуються. У японії придумали таку складну для кодувань штуку, як emoji – мову ідеограм та смайликів. Є про це цікава стаття на вікіпедії: « <a href="https://ru.wikipedia.org/wiki/%D0%AD%D0%BC%D0%BE%D0%B4%D0%B7%D0%B8" target="_blank" rel="nofollow">Емодзі</a> ». Знайдемо приклад emoji, наприклад такий: " <a href="https://emojipedia.org/ghost/" target="_blank" rel="nofollow">Emoji Ghost</a> ". Як бачимо, там навіть зазначений цей codePoint (значення = U+1F47B). Вказано його у шістнадцятковому форматі. Якщо перевести в десяткове число, то отримаємо 128 123. Це більше, ніж дозволяє 16 біт (тобто більше ніж 65 535). Скопіюємо його: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="d3638d24-218a-492c-9242-13e22020acff" data-max-width="710" alt="Рядки в Java (class java.lang.String) - 2" src="https://cdn.javarush.com/images/article/d3638d24-218a-492c-9242-13e22020acff/512.jpeg" style="width: 710px;">
 </div>
</div>На жаль, платформа CodeGym не підтримує такі символи у тексті. Тому, наприклад нижче потрібно буде в String вставити значення. Тому тепер нам буде зрозумілий простий тест: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span> <span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span>args<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
	    <span class="token class-name"><span class="token class-name">String</span></span> emojiString <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"Вставте сюда эмоджи через ctrl+v"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
	    <span class="token comment"><span class="token comment">//На один emojiString приходится 2 чара (т.к. не влезает в 16 бит)</span></span>
	    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>emojiString<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">codePoints</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">count</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">//1</span></span>
	    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>emojiString<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">chars</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">count</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">//2</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Як видно, в даному випадку 1 codePoint йде за 2 char'а. Ось така магія. 
<h2>Character</h2>Як ми побачабо вище, String'і Java складаються з char. Примітивний тип дозволяє зберігати значення, а ось обгортка <code class=" language-none">java.lang.Character</code>над примітивним типом дозволяє зробити багато корисного з цим символом. Наприклад, ми можемо перевести рядок у верхній регістр: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">String</span></span> line <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"организация объединённых наций"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token keyword"><span class="token keyword">char</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> chars <span class="token operator"><span class="token operator">=</span></span> line<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">toCharArray</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token keyword"><span class="token keyword">for</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">int</span></span> i <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> i <span class="token operator"><span class="token operator">&lt;</span></span> chars<span class="token punctuation"><span class="token punctuation">.</span></span>length<span class="token punctuation"><span class="token punctuation">;</span></span> i<span class="token operator"><span class="token operator">++</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>i <span class="token operator"><span class="token operator">==</span></span> <span class="token number"><span class="token number">0</span></span> <span class="token operator"><span class="token operator">||</span></span> chars<span class="token punctuation"><span class="token punctuation">[</span></span>i <span class="token operator"><span class="token operator">-</span></span> <span class="token number"><span class="token number">1</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> <span class="token operator"><span class="token operator">==</span></span> <span class="token string"><span class="token string">' '</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
            chars<span class="token punctuation"><span class="token punctuation">[</span></span>i<span class="token punctuation"><span class="token punctuation">]</span></span> <span class="token operator"><span class="token operator">=</span></span> <span class="token class-name"><span class="token class-name">Character</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">toUpperCase</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>chars<span class="token punctuation"><span class="token punctuation">[</span></span>i<span class="token punctuation"><span class="token punctuation">]</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token punctuation"><span class="token punctuation">}</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>chars<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Ну і різні цікавості: <code class=" language-none">isAlphabetic()</code>, <code class=" language-none">isLetter()</code>, <code class=" language-none">isSpaceChar()</code>, <code class=" language-none">isDigit()</code>, <code class=" language-none">isUpperCase()</code>( <code class=" language-none">isMirrored()</code>наприклад, дужки. '(' має дзеркальне відображення ')'). 
<h2>String Pool</h2>Рядки в Java незмінні, тобто константні. У тому числі про це вказано в JavaDoc класу <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" target="_blank" rel="nofollow">java.lang.String</a> . Друге і теж дуже важливе – рядки можуть задаватися літералами: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><code class="  language-java"><span class="token class-name"><span class="token class-name">String</span></span> literalString <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"Hello, World!"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">String</span></span> literalString <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"Hello, World!"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span></code></pre> Тобто будь-який рядок у лапках, як зазначено вище, насправді об'єкт. І тут напрошується питання - якщо ми так часто використовуємо рядки і вони часто можуть бути однаковими (наприклад, текст "Помилка" або "Виконано успішно"), чи не можна якось зробити так, щоб рядки не створювалися щоразу? До речі, у нас ще є Map'и, де ключем може бути рядок. Тоді нам точно не можна, щоб однакові рядки були різними об'єктами, інакше ми потім не зможемо з Map дістати об'єкт. Розробники Java подумали і придумали String Pool. Це місце, де зберігаються рядки, можна назвати це кешем рядків. Попадають туди «самі» не всі рядки, а лише рядки, вказані у коді літералом. До пула можна внести рядок і самому, але про це трохи пізніше. Отже, в пам'яті ми маємо десь цей кеш. Справедливе питання: а де цей пул? Відповідь на нього можна знайти на stackoverflow: «<a href="https://stackoverflow.com/questions/4918399/where-does-javas-string-constant-pool-live-the-heap-or-the-stack" target="_blank" rel="nofollow">Where does Java's String constant pool live, the heap or the stack? </a>». Розташований він у Heap пам'яті, в особливій runtime constant pool області. Runtime constant pool виділяється при створенні класу або інтерфейсу віртуальною машиною з <a href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.5.4" target="_blank" rel="nofollow">method area</a> - особливої ​​області в Heap, доступ до якої є у ​​всіх потоків усередині віртуальної машини Java. Що дає нам String pool? У цього є кілька переваг: 
<ul>
 <li>Не створюватимуться однотипні об'єкти</li>
 <li>Порівняння за посиланням швидше, ніж посимвольне порівняння через equals</li>
</ul>Але якщо нам хочеться внести створений об'єкт у цей кеш? Тоді, у нас є особливий метод: <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#intern--" target="_blank" rel="nofollow">String.intern</a> Цей метод додає рядок у String Pool. Варто зауважити, що це не просто якийсь кеш у вигляді масиву (як для Integer'ів). Метод intern вказаний як "native". Це означає, що сам метод реалізований іншою мовою (переважно c++). У випадку з базовими методами Java до них можуть застосовуватися різні оптимізації на рівні JVM. Загалом тут відбуватиметься магія. Про intern цікаво прочитати наступний пост: <a href="https://habr.com/post/79913/#comment_2345814" target="_blank" rel="nofollow">http://habr.com/post/79913/#comment_2345814</a> І начебто ідея хороша. Але як це позначиться на нас? Адже дійсно, позначиться) 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">String</span></span> test <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"literal"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">String</span></span> test2 <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"literal"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>test <span class="token operator"><span class="token operator">==</span></span> test2<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Як бачите, рядки однакові, але результат буде false. А все тому, що == порівнює не за значенням, а за посиланням. А ось так працює: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">String</span></span> test <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"literal"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">String</span></span> test2 <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"literal"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">intern</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>test <span class="token operator"><span class="token operator">==</span></span> test2<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Тільки зауважимо, що new String все одно ми зробимо. Тобто intern нам поверне String з кешу, а ось початковий String, яким ми шукали в кеші, буде викинутий на очищення, т.к. ніхто більше про нього не знає. В наявності зайве споживання ресурсів =( Тому, порівнювати рядки потрібно завжди через equals, щоб уникнути можливості від раптових і важко визначених помилок. 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">String</span></span> test <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"literal"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">String</span></span> test2 <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"literal"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">intern</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>test<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">equals</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>test2<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Equals виконує посимвольне порівняння рядків. 
<h2>Конкатенація</h2>Як ми пам'ятаємо, рядки можна складати. І як ми пам'ятаємо рядки у нас незмінні. То як же тоді це працює? Все вірно, створюється новий рядок, який складається із символів об'єктів, що складаються. Існує мільйон версій, як працює конкатенація через плюс. Хтось вважає, що буде щоразу новий об'єкт, хтось вважає, що буде ще щось. Але прав може бути хтось один. І цей хтось компілятор javac. Скористайтеся сервісом <a href="https://www.compilejava.net/" target="_blank" rel="nofollow">онлайн компілятора</a> та виконаємо: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">HelloWorld</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">String</span></span> helloMessage <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"Hello, "</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">String</span></span> target <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"World"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>helloMessage <span class="token operator"><span class="token operator">+</span></span> target<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Тепер збережемо це як zip архів, вийдемо в каталог і виконаємо: <code class=" language-none">javap –c HelloWorld</code> І тут ми дізнаємося все: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="e1718240-a526-4dab-8bb5-0185b20a59a1" data-max-width="710" alt="Рядки в Java (class java.lang.String) - 3" src="https://cdn.javarush.com/images/article/e1718240-a526-4dab-8bb5-0185b20a59a1/512.jpeg" style="width: 710px;">
 </div>
</div>У циклі, звичайно, краще робити конкатенацію через StringBuilder самим. І не тому, що якась магія, а щоб StringBuilder створювався до циклу, а в самому циклі відбувався тільки append. До речі, тут ще одна цікавість. Є чудова стаття: « <a href="https://habr.com/post/260767/" target="_blank" rel="nofollow">Обробка рядків у Java. Частина I: String, StringBuffer, StringBuilder</a> ». Багато корисного у коментарях. Наприклад, зазначено, що при конкатенації виду <code class=" language-none">new StringBuilder().append()...toString()</code>діє intrinsic оптимізація, що регулюється опцією -XX:+OptimizeStringConcat, яка за умовчанням включена. intrinsic - перекладається як "внутрішній". Такі речі JVM обробляє особливим чином, обробляючи їх як Native лише без додаткових витрат на JNI. Докладніше: " <a href="https://www.slideshare.net/RednaxelaFX/green-teajug-hotspotintrinsics02232013" target="_blank" rel="nofollow">Intrinsic Methods in HotSpot VM</a> ". 
<div class="email-subscription">
 <iframe frameborder="0" src="https://secure.esputnik.com.ua/4Q0Ef6d2SOs" width="100%" height="200" scrolling="no" data-savepage-key="0-2"></iframe>
</div>
<h2>StringBuilder та StringBuffer</h2>Як ми бачабо вище, StringBuilder дуже корисний інструмент. Рядки є незабутні, тобто. незмінними. А складати хочеться. Тому нам на допомогу дано 2 класи: StringBuilder і StringBuffer. Основна відмінність між ними в тому, що StringBuffer з'явився в JDK1.0, в той час як StringBuilder прийшов у java 1.5 як синхронізована версія StringBuffer, щоб зняти підвищені витрати на непотрібну синхронізацію методів. Обидва ці класи є реалізацією абстрактного класу AbstractStringBuilder - A mutable sequence of characters. Усередині зберігається масив чарів, який розширюється за правилом: value.length * 2 + 2. За замовчуванням розмір (capacity) у StringBuilder'а дорівнює 16. 
<h2>Comparable</h2>Рядки є comparable, тобто. реалізують метод compareTo. Виконується це з допомогою посимвольного порівняння. Цікаво, що із двох рядків вибирається мінімальна довжина і по ній виконується цикл. Тому compareTo поверне або різницю між int значеннями перших символів, що не збіглися, в межі найменшої з довжин рядків, або поверне різницю між довжинами рядків, якщо в межах мінімальної довжини рядка всі символи збігаються. Таке порівняння називається «лексикографічним». 
<h2>Робота з рядками Java</h2>String має безліч корисних методів: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="be4a7efb-b708-4433-b3b6-da38154099ec" data-max-width="710" alt="Рядки в Java (class java.lang.String) - 4" src="https://cdn.javarush.com/images/article/be4a7efb-b708-4433-b3b6-da38154099ec/512.jpeg" style="width: 710px;">
 </div>
</div>На роботу з рядками існує безліч завдань. Наприклад, на <a href="http://codingbat.com/java" target="_blank" rel="nofollow">Coding Bat</a> . Так само є курс на coursera: " <a href="https://ru.coursera.org/learn/algorithms-on-strings" target="_blank" rel="nofollow">Algorithms on Strings</a> ". 
<h2>Висновок</h2>Навіть невеликий огляд цього класу займає значне місце. А це ще не все. Настійно рекомендую до перегляду доповідь з JPoint 2015 року: Олексій Шипільов - Катехизис java.lang.String 
<div class="row">
 <div class="col col-md-10 col-lg-8">
  <div class="embed-responsive embed-responsive-16by9">
   <iframe width="560" height="315" src="https://www.youtube.com/embed/SZFe3m1DV1A" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen data-savepage-key="0-3"></iframe>
  </div>
 </div>
</div> #Viacheslav