Стек-трейс Java
<p>----------------------------------------</p>
Віртуальна Машина Java (надалі JVM) обробляючи код, запускає методи один за одним, починаючи з методу . Коли вона сягає чергового методу, говориться, що це метод перебуває в вершині стека. Після повного виконання методу він видаляється зі с
<p>----------------------------------------</p>
Віртуальна Машина Java (надалі JVM) обробляючи код, запускає методи один за одним, починаючи з методу <code class=" language-none">main</code>. Коли вона сягає чергового методу, говориться, що це метод перебуває в вершині стека. Після повного виконання методу він видаляється зі стека і змінюється наступним у черзі. Для демонстрації принципу наберіть цей код: <img data-id="eb0231c6-f6d4-4285-a48d-2c7c34750df3" data-max-width="850" alt="Стек-трейс Java - 1" src="https://cdn.javarush.com/images/article/eb0231c6-f6d4-4285-a48d-2c7c34750df3/800.jpeg" style="width: 850px;">
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">errorhandling</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> errorChecking <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Метод Main успешно запущен"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token function"><span class="token function">m1</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Метод Main заканчивает свою работу"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">m1</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Первый метод передаёт привет!(m1)"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token function"><span class="token function">m2</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">m2</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Второй метод передаёт привет(m2)"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> У нас три методи: метод <code class=" language-none">main</code>, метод <code class=" language-none">m1</code>і метод <code class=" language-none">m2</code>. Коли програма стартує, на вершині стека розташований метод <code class=" language-none">main</code>. Усередині методу <code class=" language-none">main</code>викликається метод <code class=" language-none">m1</code>. Викликаючись, він стрибає на верхівку стека. Метод <code class=" language-none">m1</code>у свою чергу викликає метод <code class=" language-none">m2</code>. Тепер вже метод <code class=" language-none">m2</code>стрибає на верхівку стека, тимчасово відстороняючи <code class=" language-none">m1</code>. На секунду уявіть це - <code class=" language-none">main</code>зверху <code class=" language-none">m1</code>і на вершині <code class=" language-none">m2</code>! Зробивши свої справи, <code class=" language-none">m2</code>завершується, і контроль повертається до <code class=" language-none">m1</code>. Метод <code class=" language-none">m1</code>, завершуючись, теж видаляється зі стека, і управління знову отримує метод <code class=" language-none">main</code>. Запустіть вашу програму та подивіться на вікно виводу: <em>Метод Main успішно запущений Перший метод передає привіт!(m1) Другий метод передає привіт(m2) Метод Main закінчує свою роботу</em> Якщо щось піде не так у методі <code class=" language-none">m2</code>, JVM (Віртуальна Машина Джава, ви пам'ятаєте, так?) буде шукати обробників помилок наприклад блок <code class=" language-none">try … catch</code>. Якщо методі <code class=" language-none">m1</code>оброблювача помилок немає, то виняток буде передано методу <code class=" language-none">m1</code>, сподіваючись, що він зможе її обробити. Якщо тут не виявить обробника помилок, то виняток знову перейде по стеку вгору, цього разу на метод <code class=" language-none">main</code>. Якщо метод <code class=" language-none">main</code>не взаємодіє з виключенням, ви отримаєте дивне повідомлення про помилку, надруковане у вікні виводу. Як приклад, приведіть ваш метод <code class=" language-none">m2</code>до такого виду: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">m2</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">int</span></span> x <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">10</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token keyword"><span class="token keyword">int</span></span> y <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token keyword"><span class="token keyword">double</span></span> z <span class="token operator"><span class="token operator">=</span></span> x <span class="token operator"><span class="token operator">/</span></span> y<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span> z <span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Method Two - m2"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Цей метод містить помилку поділу на нуль. А ось повний варіант програми, повірте зі своїм: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">errorhandling</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> errorChecking <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Метод Main успешно запущен"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token function"><span class="token function">m1</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Метод Main заканчивает свою работу"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">m1</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Первый метод передаёт привет!(m1)"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token function"><span class="token function">m2</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">m2</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">int</span></span> x <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">10</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token keyword"><span class="token keyword">int</span></span> y <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token keyword"><span class="token keyword">double</span></span> z <span class="token operator"><span class="token operator">=</span></span> x <span class="token operator"><span class="token operator">/</span></span> y<span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span> z <span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Method Two - m2"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Запустіть програму і подивіться, що видасть вам вікно виводу: <em>Метод Main успішно запущений Перший метод передає привіт!(m1) Exception in thread "main" java.lang. java:17&lt;/u&gt;) at errorhandling.errorChecking.m1(&lt;u&gt;Solution.java:11&lt;/u&gt;) at errorhandling.errorChecking.main(&lt;u&gt;&gt;Solution.java:5&lt;/u&gt;) Process finished with exit code 1</em> Ви дивитеся на щось так зване стек-трейс. Три рядки, підкреслені блакитним, посилаються на ваші методи, і можуть бути знайдені в: <code class=" language-none">ім'я_пакета.ім'я_класса.ім'я_метода</code> Перший згори рядок — це місце, де помилка виникла — у методі <code class=" language-none">m2</code>. Java простежила, що вона була оброблена <code class=" language-none">ArithmeticException</code>, яка виловлює помилки поділу на нуль. У методах <code class=" language-none">m2</code>і<code class=" language-none">m1</code><code class=" language-none">main</code>немає оброблювача помилок. Так що програма обробила її обробником помилок за умовчанням. Змініть метод <code class=" language-none">m1</code>на наступний: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">try</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Первый метод передаёт привет!(m1)"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token function"><span class="token function">m2</span></span><span class="token punctuation"><span class="token punctuation">(</span></span> <span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token keyword"><span class="token keyword">catch</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">ArithmeticException</span></span> err<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>err<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getMessage</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Тепер ми обернули метод <code class=" language-none">m2</code>у блок <code class=" language-none">try</code>. У частині <code class=" language-none">catch</code>, ми використовуємо тип виключення, який був виявлений у стек-трейсі - <code class=" language-none">ArithmeticException</code>. Запустіть код знову, і у вікні виводу побачите наступне: <em>Метод Main успішно запущений Перший метод</em> передає <em><strong>привіт</strong></em> ! Метод <code class=" language-none">m2</code>не було виконано повністю, а було зупинено, коли виникла помилка. Потім контроль було передано назад <code class=" language-none">m1</code>. Це сталося завдяки тому, що блок <code class=" language-none">catch</code>сам розпізнавав помилку, JVM не стала звертатися до стандартного оброблювача помилок, а вивела повідомлення, що знаходиться між фігурними дужками блоку.<code class=" language-none">catch</code>. Зверніть увагу, що саму програму не було зупинено. Контроль, як завжди перейшов до методу <code class=" language-none">main</code>, звідки <code class=" language-none">m1</code>був викликаний. І останній рядок методу <code class=" language-none">main</code>таки зміг вивести на екран " <em><strong>End Main method</strong></em> ". Це має дуже важливе значення. Якщо вам потрібно було значення з <code class=" language-none">m1</code>, для подальшої роботи десь у <code class=" language-none">main</code>. І якщо значення там не виявиться, то ваша програма може відпрацювати зовсім не так, як ви очікуєте. Коли ви побачите стек-трейс у вікні виводу, просто знайте, що перший рядок - це те місце, де проблема виникла, а решта рядків (якщо звичайно вони є), куди виняток було передано вгору по стеку, зазвичай закінчуючи методом <code class=" language-none">main</code>. Переклад із сайту <a href="http://www.homeandlearn.co.uk/java/java_stack_trace.html" rel="nofollow">homeandlearn.co.uk</a> Дякуємо: Сергію Сисоєву, Treefeed...