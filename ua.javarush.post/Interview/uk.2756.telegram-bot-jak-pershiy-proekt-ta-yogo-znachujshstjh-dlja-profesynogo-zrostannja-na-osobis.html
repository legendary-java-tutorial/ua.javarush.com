Telegram-бот як перший проект та його значущість для професійного зростання на особистому досвіді
<p>----------------------------------------</p>
Вітаю всіх! Розповім трохи про себе. Мені 24 роки, минулого року закінчив технічний ВНЗ і досі не маю досвіду роботи. Забігаючи наперед, хочу сказати, що спочатку в закладеному плані (складеному восени 2019 року) планував вихід на роботу в 
<p>----------------------------------------</p>
Вітаю всіх! Розповім трохи про себе. Мені 24 роки, минулого року закінчив технічний ВНЗ і досі не маю досвіду роботи. Забігаючи наперед, хочу сказати, що спочатку в закладеному плані (складеному восени 2019 року) планував вихід на роботу в березні-квітні 2020, але, на жаль, втрутився карантин, тому відклав все до середини літа і в майбутньому сподіваюся написати свою історію успіху. <img width="800" height="500" data-id="0607d860-346c-4f74-abbd-a48d163932b3" alt="Telegram-бот як перший проект та його значущість для професійного зростання на особистому досвіді - 1" src="https://cdn.javarush.com/images/article/0607d860-346c-4f74-abbd-a48d163932b3/1080.jpeg">До програмування мене ніколи не тягнуло. В університеті викладали програмування достатньо, але зацікавити мене це ремесло тоді не змогло. Були і процедурні мови (C), річний курс з ОВП (Java), бази даних, навіть асемблер та C++. Та чого таїти, до навчання в цілому я був байдужий, тому що більшість дисциплін, що викладаються, здавалися мені марними, придатними тільки для звітної відомості (в принципі це так і є). Після закінчення ВНЗ необхідно було вирішуватись: якихось навичок я не набув, а працювати треба. Довелося замислитися про самоосвіту (ох, як мінімум 2 повноцінних роки я вже прогав, сидівши склавши руки) і вибір сам упав на Java, тому що на курсі ОВП в університеті хтось із хлопців порадив курс codegym, а він, як ви знаєте присвячений саме мові Java. Зацікавило подання курсу. Так, я не любив тоді програмувати, бо одразу цю справу кидав, коли зустрічав якусь складність, а складнощів у програмуванні хоч греблю гати. Але в той же час я відчував, що хочу писати код, тому я вирішив зв'язати себе з програмуванням. Коротко розповім і про мій досвід на codegym. Почав я у серпні 2019, одразу купив передплату на місяць, але на 7 рівні зрозумів, що завдання даються важко. Відклав курс, взяв у руки Шілдта. Так паралельно і проходив курс упродовж 3 місяців. Дійшов до 20 рівня (це мій другий обліковий запис), майже повністю прочитав Шілдта, потім втомився від тутешніх завдань, у яких я перестав бачити практичну користь для себе. Заходив на codewars, leetcode, почав дивитися відеокурси. До речі, за 3 місяці я пройшов шлях від "Про ні, що таке масив? Як із ним працювати і чому так страшно" ? до детального вивчення вихідного коду класів колекцій (ArrayList, HashMap тощо). Грунтуючись на особистому досвіді, новачкам скажу: тут головне побороти таке почуття, яке виникає, якщо нічого не розумієш і нічого не можеш вирішити. Коли воно виникає, просто хочеться все кинути і здається, що ти надто тупий для цієї справи. Якщо переборювати такі моменти і морально відпочивати, то успіх прийде. Я думаю, що багато хто не справляється з цим, тому швидко кидає подібні починання. У результаті, у грудні 2019 року задумався про свій проект. Вирішив вибрати Telegram-бота, але ідеї не було. У той самий час одному знайомому знадобився функціонал своєї групи у телеграмі, що він хотів би автоматизувати. Він був у курсі, що я поглиблено вивчаю програмування і запропонував мені проект. Мені для досвіду та майбутнього резюме, йому - у розвиток групи. Я навіть дозволю собі процитувати його ідею: "<em>Нещодавно софтину хотів у програміста замовити, яка б завантажувала в обрану Хмару файли за прямими посиланнями. Це цікаво, тому що аналогів немає. І дуже зручно. Суть: копіюєш посилання, вставляєш у вікно і вибираєш потрібну Хмару (GDrive, Mail, Яндекс Диск і т.п), свого часу софт все робить на стороні сервера і користувачеві нічого не потрібно завантажувати на свою машину (особливо круто, коли в тебе збирання на SSD-накопичувачах). Думали зробити в web-інтерфейсі, щоб можна було запускати як з телефонів, так і з робочого столу... Можна в принципі через додаток реалізувати, а не через web-інтерфейс. Тобі таке під силу?</em>Таким чином, при кожному запиті бібліотека може розширюватися завдяки зусиллям користувачів. Надалі отримати інформацію про гру у зручному вигляді можна не заходячи до Google Play. Ви просто пишіть команду /library Тут_назва_ігри та отримуєте все, що потрібно. Але є кілька труднощів, про які я ще розповім. Спочатку просувався повільно, тому що паралельно почав проходити два курси по SQL. Банально було зрозуміти, як взагалі працює бот, і як обробляти запити. Зустрів товариша, якому теж було цікаво попрацювати над проектом. Перший варіант робота був готовий приблизно через місяць, але з товаришем виникли розбіжності (з мого боку). Я зайнявся частиною бота, яка відповідає за парсинг, а він безпосередньо працював над запитами до боту та їхньою обробкою. Він навіщось став ускладнювати робота, вводити якісь авторизації, вигадувати адмінів, додавати непотрібну функціональність, плюс мені не зовсім подобався стиль написання коду. На мій погляд, це не було потрібно в інформаційному боті. Так я вирішив, що напишу робота з нуля сам з необхідним мені функціоналом. Тепер розповім, що робить бот (з прикладу з коду проекту). Повний код проекту докладу наприкінці статті та, на жаль, повністю прокоментувати його фізично не зможу. Будь-яке повідомлення користувача, відправлене роботу, - це об'єкт класу Update. Він містить багато інформації (id повідомлення, id чату, унікальний id користувача тощо.). Є кілька типів update: це може бути текстове повідомлення, це може бути відповідь від телеграм-клавіатури (callback), фотографія, аудіо і т.д. Щоб користувач особливо не балувався, я обробляю лише текстові запити та callback'и від клавіатури. Якщо користувач надішле фотографію, робот його повідомить про те, що робити з нею він нічого не має наміру. У головному класі бота, в методі наUpdateReceived бот отримує апдейт. 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onUpdateReceived</span><span class="token punctuation">(</span><span class="token class-name">Update</span> update<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">UpdatesReceiver</span><span class="token punctuation">.</span><span class="token function">handleUpdates</span><span class="token punctuation">(</span>update<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre> який я передаю обробнику (власний клас UpdatesReceiver): 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">handleUpdates</span><span class="token punctuation">(</span><span class="token class-name">Update</span> update<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>update<span class="token punctuation">.</span><span class="token function">hasMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> update<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"[Update (id {}) типа \"Текстовое сообщение\"]"</span><span class="token punctuation">,</span> update<span class="token punctuation">.</span><span class="token function">getUpdateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">new</span> <span class="token class-name">TextMessageHandler</span><span class="token punctuation">(</span>update<span class="token punctuation">,</span> replyGenerator<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">handleTextMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>update<span class="token punctuation">.</span><span class="token function">hasCallbackQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//логгирование</span>
            <span class="token keyword">new</span> <span class="token class-name">CallbackQueryHandler</span><span class="token punctuation">(</span>update<span class="token punctuation">,</span> replyGenerator<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">handleCallBackQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
           <span class="token comment">//логгирование</span>
            replyGenerator<span class="token punctuation">.</span><span class="token function">sendTextMessage</span><span class="token punctuation">(</span>update<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getChatId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Я могу принимать только текстовые повідомлення!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre> UpdatesReceiver - це центральний обробник, який в залежності від типу апдейта передає керування в інший спеціалізований обробник: TextMessageHandler або CallbackQueryHandler, в конструктори яким я далі ланцюжком передаю update. Update - це найважливіше при роботі з роботом і його не можна втрачати, оскільки за допомогою інформації, що зберігається в апдейті, ми дізнаємося якому користувачеві і в який чат потрібно надсилати відповідь. Для створення відповідей користувачеві написав окремий клас. Він може надсилати звичайне текстове повідомлення, повідомлення з клавіатурою inline, повідомлення з картинкою і повідомлення з reply клавіатурою. Inline-клавіатура виглядає так: <img width="800" height="500" data-id="b5e34e7d-6dbd-4909-93ea-8b2f773fabd0" alt="Telegram-бот як перший проект та його значущість для професійного зростання на особистому досвіді - 1" src="https://cdn.javarush.com/images/article/b5e34e7d-6dbd-4909-93ea-8b2f773fabd0/1080.jpeg">Вона задає кнопки, натиснувши на які користувач відправляє callback'і серверу, які можна обробляти майже таким же чином, що і звичайні повідомлення. Для її "підтримки" потрібний свій обробник. Ми задаємо для кожної кнопки певну дію, яка потім записується в об'єкт Update. Тобто. Для кнопки "Вартість" ми задали опис "/price" для callback'а, який надалі ми можемо отримати з апдейту. Далі в окремому класі, я вже можу обробити цей callback: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleCallBackQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">String</span> call_data <span class="token operator">=</span> update<span class="token punctuation">.</span><span class="token function">getCallbackQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">long</span> message_id <span class="token operator">=</span> update<span class="token punctuation">.</span><span class="token function">getCallbackQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMessageId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">long</span> chat_id <span class="token operator">=</span> update<span class="token punctuation">.</span><span class="token function">getCallbackQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getChatId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>call_date<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">"/price"</span> <span class="token operator">:</span>
        <span class="token comment">//тут что-то сделать</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre> Reply-клавіатура виглядає так: <img width="800" height="500" data-id="f906d555-c6c0-46d7-a3ec-7de723c0d3a6" alt="Telegram-бот як перший проект та його значущість для професійного зростання на особистому досвіді - 2" src="https://cdn.javarush.com/images/article/f906d555-c6c0-46d7-a3ec-7de723c0d3a6/1080.jpeg">І, по суті, вона замінює користувачеві набір тексту. Натиснувши кнопку "Бібліотека", ви швидко відправите повідомлення "Бібліотека" боту. Для кожного типу клавіатури я написав свій клас, реалізувавши патерн "Будівельник" (Builder): <a href="https://github.com/miroha/Telegram-Bot/blob/master/src/main/java/bot/service/keyboards/builders/InlineKeyboardMarkupBuilder.java" target="_blank" rel="nofollow">inline</a> та <a href="https://github.com/miroha/Telegram-Bot/blob/master/src/main/java/bot/service/keyboards/builders/ReplyKeyboardMarkupBuilder.java" target="_blank" rel="nofollow">reply</a> . У підсумку можна по суті "намалювати" потрібну клавіатуру в залежності від вимог. Це дуже зручно, тому що клавіатури можуть бути різними, а принцип залишається тим же. Ось інтуїтивно зрозумілий метод для надсилання повідомлення з inline-клавіатурою: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">sendInlineKeyboardMessage</span><span class="token punctuation">(</span><span class="token keyword">long</span> chat_id<span class="token punctuation">,</span> <span class="token class-name">String</span> gameTitle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SendMessage</span> keyboard <span class="token operator">=</span> <span class="token class-name">InlineKeyboardMarkupBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>chat_id<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"Вы может узнать следующую информацию об игре "</span> <span class="token operator">+</span> gameTitle<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">button</span><span class="token punctuation">(</span><span class="token string">"Стоимость "</span> <span class="token operator">+</span> <span class="token string">"\uD83D\uDCB0"</span><span class="token punctuation">,</span> <span class="token string">"/price "</span> <span class="token operator">+</span> gameTitle<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">button</span><span class="token punctuation">(</span><span class="token string">"Обновлено "</span> <span class="token operator">+</span> <span class="token string">"\uD83D\uDDD3"</span><span class="token punctuation">,</span> <span class="token string">"/updated "</span> <span class="token operator">+</span> gameTitle<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">button</span><span class="token punctuation">(</span><span class="token string">"Версия "</span> <span class="token operator">+</span> <span class="token string">"\uD83D\uDEE0"</span><span class="token punctuation">,</span> <span class="token string">"/version "</span> <span class="token operator">+</span> gameTitle<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">endRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">button</span><span class="token punctuation">(</span><span class="token string">"Требования "</span> <span class="token operator">+</span> <span class="token string">"\uD83D\uDCF5"</span><span class="token punctuation">,</span> <span class="token string">"/requirements "</span> <span class="token operator">+</span> gameTitle<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">button</span><span class="token punctuation">(</span><span class="token string">"Покупки "</span> <span class="token operator">+</span> <span class="token string">"\uD83D\uDED2"</span><span class="token punctuation">,</span> <span class="token string">"/iap "</span> <span class="token operator">+</span> gameTitle<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">button</span><span class="token punctuation">(</span><span class="token string">"Размер "</span> <span class="token operator">+</span> <span class="token string">"\uD83D\uDD0E"</span><span class="token punctuation">,</span> <span class="token string">"/size "</span> <span class="token operator">+</span> gameTitle<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">endRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">button</span><span class="token punctuation">(</span><span class="token string">"Получить всю информацию об игре"</span> <span class="token operator">+</span> <span class="token string">"\uD83D\uDD79"</span><span class="token punctuation">,</span> <span class="token string">"/all "</span> <span class="token operator">+</span> gameTitle<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">endRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">button</span><span class="token punctuation">(</span><span class="token string">"Скрыть клавиатуру"</span><span class="token punctuation">,</span> <span class="token string">"close"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">endRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">execute</span><span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TelegramApiException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"[Не удалось отправить сообщение с -inline- клавиатурой]: {}"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre> Для надання роботі суворого функціоналу, були придумані спеціальні команди через символ слеша: /library, /help, /game і т.д. Інакше довелося б обробляти всяке сміття, яке могло написати користувач. Власне, для цього було написано MessageHandler: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">ChatCommands</span><span class="token punctuation">.</span>START<span class="token punctuation">.</span><span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     replyGenerator<span class="token punctuation">.</span><span class="token function">sendTextMessage</span><span class="token punctuation">(</span>chat_id<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">StartMessageHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     replyGenerator<span class="token punctuation">.</span><span class="token function">sendReplyKeyboardMessage</span><span class="token punctuation">(</span>chat_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">ChatCommands</span><span class="token punctuation">.</span>HELP<span class="token punctuation">.</span><span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token operator">||</span> message<span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span><span class="token string">"Помощь"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      replyGenerator<span class="token punctuation">.</span><span class="token function">sendTextMessage</span><span class="token punctuation">(</span>chat_id<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">HelpMessageHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre> Таким чином, залежно від того, яку команду ви відправите боту, в роботу включатиметься спеціальний обробник. Йдемо далі і розглянемо роботу парсера та бібліотеки. Якщо надіслати боту посилання на гру в магазині Google Play, автоматично спрацює спеціальний <a href="https://github.com/miroha/Telegram-Bot/blob/master/src/main/java/bot/service/updates/handlers/commands/GameMessageHandler.java" target="_blank" rel="nofollow">handler</a> . У відповідь користувач отримає інформацію про гру у такому вигляді: <img width="800" height="500" data-id="655ea5ba-0ff5-40d1-a97b-c00d70acfb72" alt="Telegram-бот як перший проект та його значущість для професійного зростання на особистому досвіді - 3" src="https://cdn.javarush.com/images/article/655ea5ba-0ff5-40d1-a97b-c00d70acfb72/1080.jpeg">Разом з цим, буде викликаний метод, який спробує додати гру в бібліотеку бота (спочатку в локальну карту, потім -&gt; json файл). Якщо гра вже є в бібліотеці, буде здійснено перевірку (як у звичайній хешмапі), і якщо дані полів (наприклад, номер версії змінився), то гра в бібліотеці буде перезаписана. Якщо змін не буде виявлено, то ніяких записів здійснюватися не буде. Якщо гри в бібліотеці взагалі не було, то вона спочатку записується в локальну карту (об'єкт виду <a href="https://github.com/miroha/Telegram-Bot/blob/master/src/main/java/library/googleplay/GooglePlayGame.java" target="_blank" rel="nofollow">тик</a> ), а потім пишеться в json файл, так як при непередбаченому закритті програми на сервері дані будуть втрачені, а за допомогою файлу їх завжди можна буде прочитати. Власне, бібліотека при старті програми завжди вперше завантажується з файлу зі static блоку: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token class-name">TypeFactory</span> typeFactory <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">getTypeFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MapType</span> mapType <span class="token operator">=</span> typeFactory<span class="token punctuation">.</span><span class="token function">constructMapType</span><span class="token punctuation">(</span><span class="token class-name">ConcurrentSkipListMap</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">GooglePlayGame</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Path</span> path <span class="token operator">=</span> <span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>LIBRARY_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">createDirectories</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">createFile</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
                log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"[Файл библиотеки создан]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token class-name">ConcurrentMap</span><span class="token operator">&lt;</span>string<span class="token punctuation">,</span> googleplaygame<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span> temporary <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>LIBRARY_PATH<span class="token punctuation">)</span><span class="token punctuation">,</span> mapType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                games<span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span>temporary<span class="token punctuation">)</span><span class="token punctuation">;</span>
                log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"[Количество игр в загруженной библиотеке] = "</span> <span class="token operator">+</span> games<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"[Ошибка при чтении/записи файлу] {}"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre> Тут додатково доводиться читати дані з файлу в тимчасову карту, яку потім копіювати в повноцінну, щоб зберегти нечутливість до регістру при пошуку гри у файлі (написавши tITan QuEST, бот все одно знайде гру Titan Quest в бібліотеці). Іншого рішення знайти не вдалося, такими є особливості десеріалізації з використанням Jackson. Отже, при кожному запиті за посиланням гра по можливості додається до бібліотеки, і бібліотека тим самим розширюється. Далі інформацію про конкретну гру можна дістати за командою <strong>/library Назва_Ігри.</strong>Можна дізнатися як певний параметр (наприклад, поточну версію), і всі параметри відразу. Це реалізовано за допомогою клавіатури inline, яка була розглянута раніше. У ході роботи застосовував і навички, здобуті тут під час вирішення завдань. Наприклад, список назв випадкових ігор, що знаходяться в бібліотеці (опція доступна за командою /library): 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">getRandomTitles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">LibraryService</span><span class="token punctuation">.</span><span class="token function">getLibrary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token class-name">LibraryService</span><span class="token punctuation">.</span><span class="token function">getLibrary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>string<span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">LibraryService</span><span class="token punctuation">.</span><span class="token function">getLibrary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">shuffle</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>string<span class="token punctuation">&gt;</span></span> randomKeys <span class="token operator">=</span> keys<span class="token punctuation">.</span><span class="token function">subList</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> randomKeys<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre> Як бот обробляє посилання? Він перевіряє їх на приналежність до Google Play (хост, протокол, порт): 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">GooglePlayCorrectURL</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> VALID_HOST <span class="token operator">=</span> <span class="token string">"play.google.com"</span><span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> VALID_PROTOCOL <span class="token operator">=</span> <span class="token string">"https"</span><span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> VALID_PORT <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isLinkValid</span><span class="token punctuation">(</span><span class="token class-name">URI</span> link<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">isHostExist</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isProtocolExist</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> link<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> VALID_PORT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isProtocolExist</span><span class="token punctuation">(</span><span class="token class-name">URI</span> link<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>link<span class="token punctuation">.</span><span class="token function">getScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> link<span class="token punctuation">.</span><span class="token function">getScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>VALID_PROTOCOL<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isHostExist</span><span class="token punctuation">(</span><span class="token class-name">URI</span> link<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>link<span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> link<span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>VALID_HOST<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span></code></pre> Якщо все гаразд, то бот підключається за посиланням за допомогою бібліотеки Soup, яка дозволяє дістати HTML-код сторінки, що підлягає подальшому аналізу та парсингу. Обдурити бота неправильним або шкідливим посиланням не вдасться. 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">GooglePlayCorrectURL</span><span class="token punctuation">.</span><span class="token function">isLinkValid</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>link<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"apps"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InvalidGooglePlayLinkException</span><span class="token punctuation">(</span><span class="token string">"К сожалению, бот работает исключительно с играми. Введите другую ссылку."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     URL <span class="token operator">=</span> <span class="token function">forceToRusLocalization</span><span class="token punctuation">(</span>URL<span class="token punctuation">)</span><span class="token punctuation">;</span>
     document <span class="token operator">=</span> <span class="token class-name">Jsoup</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>URL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
     <span class="token keyword">else</span> <span class="token punctuation">{</span>
         <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NotGooglePlayLinkException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre> Тут довелося вирішувати проблему з регіональними налаштуваннями. Робот підключається до магазину Google Play із сервера, який знаходиться в Європі, тому сторінка в магазині Google Play відкривається відповідною мовою. Довелося писати мабоцю, яка примусово здійснює "редирект" на російську версію сторінки (проект все-таки націлений був на нашу аудиторію). Для цього в кінці посилання потрібно акуратно дописати в GET запиті до Google Play параметр hl: <strong>&amp;hl=ru</strong> . 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">forceToRusLocalization</span><span class="token punctuation">(</span><span class="token class-name">String</span> URL<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>URL<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">"&amp;hl=ru"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> URL<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>URL<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"&amp;hl="</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                URL <span class="token operator">=</span> URL<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>
                        URL<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>URL<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token string">"&amp;hl=ru"</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"&amp;hl=ru"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                URL <span class="token operator">+=</span> <span class="token string">"&amp;hl=ru"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> URL<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre> Після вдалого підключення ми отримуємо HTML-документ, готовий для аналізу та парсингу, але це вже виходить за межі цієї статті. Код парсера <a href="https://github.com/miroha/Telegram-Bot/blob/master/src/main/java/parser/googleplay/GooglePlayParser.java" target="_blank" rel="nofollow">тут</a>. Власне парсер дістає потрібну інформацію та створює об'єкт з грою, який надалі у разі потреби додається до бібліотеки. &lt;h2&gt;Підсумок&lt;/h2&gt;Бот підтримує кілька команд, в яких закладена певна функціональність. Він отримує повідомлення від користувача та зіставляє їх зі своїми командами. Якщо це посилання або команда /game + посилання, він перевіряє це посилання на приналежність Google Play. Якщо посилання коректне, він здійснює підключення за допомогою Soup та отримує HTML-документ. Цей документ аналізується на основі написаного парсера. З документа витягується необхідна інформація про гру, і далі об'єкт із грою заповнюється цими даними. Далі об'єкт з грою поміщається в локальне сховище (якщо ігри там ще немає) і відразу записується у файл для уникнення втрат даних. Записану в бібліотеку гру (назва гри – ключ для карти, об'єкт з грою – значення для карти), можна отримати за командою /library Назва_гри. Якщо вказана гра буде знайдена в бібліотеці бота, то користувачеві повернеться inline-клавіатура, за допомогою якої він може отримати інформацію про гру. Якщо ігри не знайдено, необхідно або переконатися в правильності написання назви (вона повинна повністю відповідати назві гри в магазині Google Play за винятком регістру), або додати гру до бібліотеки, надіславши боту посилання на гру. Деплой бота я здійснював на heroku і для тих, хто в майбутньому планує написати свого бота і розмістити його безкоштовно на heroku, дам кілька рекомендацій для вирішення труднощів, з якими ви можете зіткнутися (бо з ними я зіткнувся сам). На жаль, через особливості heroku, бібліотека робота постійно "обнулюється" раз на 24 години. Мій тариф не підтримує зберігання файлів на серверах heroku, тому він просто підтягує мій файл із іграми з гітхабу. Рішень було кілька: використовувати БД, або шукати інший сервер, який зберігав би цей файл із грою. Я поки що вирішив нічого не робити, тому що насправді бот не такий вже й корисний. Він мені був необхідний швидше для отримання повноцінного досвіду, чого я в принципі досяг. Отже, рекомендації з heroku: Він мені був необхідний швидше для отримання повноцінного досвіду, чого я в принципі досяг. Отже, рекомендації з heroku: Він мені був необхідний швидше для отримання повноцінного досвіду, чого я в принципі досяг. Отже, рекомендації з heroku: 
<ol>
 <li>
  <p>Реєструватися на heroku швидше за все доведеться за допомогою VPN, якщо ви живете в Росії.</p></li>
 <li>
  <p>У корінь проекту необхідно покласти файл без розширення під назвою Procfile. Його вміст має бути таким: <a href="https://github.com/miroha/Telegram-Bot/blob/master/Procfile" target="_blank" rel="nofollow">https://github.com/miroha/Telegram-Bot/blob/master/Procfile</a></p></li>
 <li>
  <p>У pom.xml додати наступні рядки за <a href="https://github.com/miroha/Telegram-Bot/blob/master/pom.xml" target="_blank" rel="nofollow">зразком</a> , де в тезі mainClass вказати шлях до класу, який містить main метод: bot.BotApplication (якщо клас BotApplication лежить у папці bot).</p></li>
 <li>
  <p>Не здійснювати якихось складання проекту за допомогою команд mvn package і т.д., heroku все збере за вас сам.</p>
  <p></p></li>
 <li>
  <p>Бажано додати в проект gitignore, наприклад такий:</p>
  <pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"># <span class="token class-name">Log</span> file
<span class="token operator">*</span><span class="token punctuation">.</span>log

# <span class="token class-name">Compiled</span> resources
target

# <span class="token class-name">Tests</span>
test

# IDEA files
<span class="token punctuation">.</span>idea
<span class="token operator">*</span><span class="token punctuation">.</span>iml</code></pre></li>
 <li>
  <p>Власне завантажити проект на github, а далі підключити репозиторій в heroku (або використовуйте інші способи, там їх 3, якщо не помиляюся).</p></li>
 <li>
  <p>Якщо завантаження пройшло успішно ("Build succeeded"), обов'язково зайдіть у Configure Dynos:</p><img width="800" height="500" data-id="8829ff47-cf7f-4f44-be9a-e3f9e814f45c" alt="Telegram-бот як перший проект та його значущість для професійного зростання на особистому досвіді - 4" src="https://cdn.javarush.com/images/article/8829ff47-cf7f-4f44-be9a-e3f9e814f45c/1080.jpeg">
  <p>і перемкніть повзунок, а потім переконайтеся, що він у положенні ON (через те, що я це не зробив, мій бот не працював і я пару днів ламав голову і зробив дуже багато зайвих рухів тіла).</p></li>
 <li>
  <p>Ховайте токен бота на гітхабі. Для цього необхідно отримувати токен із змінної оточення:</p>
  <pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Bot</span> <span class="token keyword">extends</span> <span class="token class-name">TelegramLongPollingBot</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> BOT_TOKEN <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string">"TOKEN"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getBotToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> BOT_TOKEN<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span></code></pre>
  <p>А потім після деплою бота, задати цю змінну в dashboard'e heroku у вкладці Settings (праворуч від TOKEN буде поле VALUE, туди і копіюйте токен вашого бота):</p><img width="800" height="500" data-id="d27cb5b9-f6f1-41aa-8c0a-20ae588b81b1" alt="Telegram-бот як перший проект та його значущість для професійного зростання на особистому досвіді - 5" src="https://cdn.javarush.com/images/article/d27cb5b9-f6f1-41aa-8c0a-20ae588b81b1/1080.jpeg"></li>
</ol>Отже, за 2 місяці роботи над власним проектом я: 
<ul>
 <li>отримав повністю робочий проект, написаний Java;</li>
 <li>навчився працювати зі стороннім API (Telegram Bot API);</li>
 <li>на практиці заглибився в серіалізацію, багато попрацював із JSON та бібліотекою Jackson (спочатку використовував GSON, але з нею були проблеми);</li>
 <li>зміцнив свої навички під час роботи з файлуми, познайомився з Java NIO;</li>
 <li>навчився працювати з конфігураційними .xml файлуми та привчив себе до логування;</li>
 <li>покращив володіння середовищем розробки (IDEA);</li>
 <li>навчився працювати з git і пізнав цінність gitignore;</li>
 <li>отримав навички у парсингу веб-сторінок (бібліотека Soup);</li>
 <li>вивчив та використав кілька патернів проектування;</li>
 <li>розвинув у собі почуття та бажання покращувати код (рефакторинг);</li>
 <li>навчився знаходити рішення в мережі та не соромитися ставити запитання, на які не вдалося знайти відповіді.</li>
</ul><a href="https://codegym.cc/welcome" target="_blank" rel="nofollow"><img width="800" height="500" data-id="61bf8f5d-dbac-4c9c-a298-1a6c652d4dd7" alt="Telegram-бот як перший проект та його значущість для професійного зростання на особистому досвіді - 7" src="https://cdn.javarush.com/images/article/61bf8f5d-dbac-4c9c-a298-1a6c652d4dd7/1080.jpeg"></a>Я не знаю, наскільки корисним чи марним вийшов бот, наскільки красивий/некрасивий код, але досвід, який я отримав, напевно того коштував. В мене виникло почуття відповідальності за свій проект. Його постійно хочеться покращувати, додавати щось нове. Коли я зміг його запустити і переконатися, що все працює так, як я і хотів, я випробував справжній кайф. Хіба це не головне? Отримувати задоволення від того, чим ти займаєшся і радіти кожному працюючому рядку коду, як останній шоколадці. Тому якщо ви освоюєте програмування, то моя вам порада: не засиджуйтесь тут до 40 рівня, а починайте власний проект якомога раніше. Якщо комусь цікаво, вихідний код проекту знаходиться тут (переписаний під Spring): <a href="https://github.com/miroha/GooglePlayGames-TelegramBot" target="_blank" rel="nofollow">https://github.com/miroha/GooglePlayGames-TelegramBot</a> Останні місяці два я майже не вивчаю новий матеріал, оскільки мені здається досяг глухого кута. Без роботи вже не бачу куди розвиватися, хіба що вчити Spring Framework, чим я і планую зайнятися найближчого місяця. А потім спробую переписати бота з використанням цього фреймворку. Готовий відповісти на будь-які запитання. :) Усім успіхів! <strong>UPDATE від 07.07.2020</strong> Репозиторій з ботом на чистій Java був втрачений (я його видаляв, копія залишилася на іншій локальній машині), але завантажив переписаного бота під Spring Boot: <a href="https://github.com/miroha/GooglePlayGames-TelegramBot" target="_blank" rel="nofollow">https://github.com/miroha/GooglePlayGames-TelegramBot</a>