Автоупаковка та розпакування в Java
<p>----------------------------------------</p>
<h2>Вступ</h2>Мова програмування, як і мова якою говорять люди, живе і змінюється, в ньому з'являються нові явища, щоб мовою було користуватися зручніше. А як ми знаємо мову має зручно висловлювати наші думки. Отже, Java SE 5 був представле
<p>----------------------------------------</p>
&lt;h2&gt;Вступ&lt;/h2&gt;Мова програмування, як і мова якою говорять люди, живе і змінюється, в ньому з'являються нові явища, щоб мовою було користуватися зручніше. А як ми знаємо мову має зручно висловлювати наші думки. 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="6b70aa99-910c-4f5e-86a7-39c28367db0f" data-max-width="710" alt="Автоупаковка та розпакування в Java - 1" src="https://cdn.javarush.com/images/article/6b70aa99-910c-4f5e-86a7-39c28367db0f/512.jpeg" style="width: 710px;">
 </div>
</div> Отже, Java SE 5 був представлений механізм упаковки/розпакування (boxing/unboxing). І особливості цього засобу виразів думок присвячений окремому tutorial від Oracle: <a href="https://docs.oracle.com/javase/tutorial/java/data/autoboxing.html" target="_blank" rel="nofollow">Autoboxing and Unboxing</a> . &lt;h2&gt;Автоупаковка Boxing&lt;/h2&gt;Давайте, розглянемо приклад автоупаковки Boxing. Спочатку подивимося, як воно працює. Скористаємося сайтом <a href="https://www.compilejava.net/" target="_blank" rel="nofollow">compilejava.net</a> та створимо клас: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">App</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">Integer</span></span> portNumber <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">8080</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>args<span class="token punctuation"><span class="token punctuation">.</span></span>length <span class="token operator"><span class="token operator">!=</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
            portNumber <span class="token operator"><span class="token operator">=</span></span> <span class="token class-name"><span class="token class-name">Integer</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">valueOf</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>args<span class="token punctuation"><span class="token punctuation">[</span></span><span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">]</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token punctuation"><span class="token punctuation">}</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Port number is: "</span></span> <span class="token operator"><span class="token operator">+</span></span> portNumber<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Простенький код. Можемо вказати вхідний параметр та змінити значення порту. Як бачимо, т.к. ми зчитуємо значення порту з <code class=" language-none">String</code>параметрів, ми отримуємо <code class=" language-none">Integer</code>шляхом отримання через <code class=" language-none">Integer.valueOf</code>. Тому ми змушені вказувати його не примітивним типом, а як об'єктний тип <code class=" language-none">Integer</code>. І тут отримуємо з одного боку, у нас змінна об'єктна, а значення за умовчанням – примітив. І вона працює. Але ж ми не віримо в магію? Давайте заглянемо "під капот", що називається. Скачаємо з compilejava.net вихідний код, натиснувши "Download ZIP". Після цього витягнемо завантажений архів у каталог і перейдемо до нього. Тепер виконаємо: <code class=" language-none">javap -c -p App.class</code>де App.class – скомпільований class файл для вашого класу. Ми побачимо вміст на кшталт такого: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="9760970d-a540-45a8-b6dd-2541004f03b3" data-max-width="710" alt="Автоупаковка та розпакування в Java - 2" src="https://cdn.javarush.com/images/article/9760970d-a540-45a8-b6dd-2541004f03b3/512.jpeg" style="width: 710px;">
 </div>
</div> Цей той самий горезвісний «байткод». Але важливе нам зараз те, що ми бачимо. Спочатку в стек виконання методу поміщається примітив 8080, а далі виконується <strong>Integer.valueOf</strong> . Це і є та магія boxing. А всередині магія виглядає так: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="83713716-eeaf-4387-a88c-a9dcb09b987f" data-max-width="710" alt="Автоупаковка та розпакування в Java - 3" src="https://cdn.javarush.com/images/article/83713716-eeaf-4387-a88c-a9dcb09b987f/512.jpeg" style="width: 710px;">
 </div>
</div> Тобто по суті буде взято новий <code class=" language-none">Integer</code>або буде отримано <code class=" language-none">Integer</code>з кешу (кеш ніщо інше як просто масив Integer) залежно від величини значення числа. Звичайно, <code class=" language-none">Integer</code>не одному так пощастило. Є цілий список примітивних типів, що співвідносяться, і їх обгорток (класів, що представляють примітиви у світі ОВП). Даний список наведений у самому низу Tutorial від Oracle: <a href="https://docs.oracle.com/javase/tutorial/java/data/autoboxing.html" target="_blank" rel="nofollow">Autoboxing and Unboxing</a> . Варто відразу зазначити, що масиви з примітивів не мають «обгортки» без підключення будь-яких сторонніх бібліотек. Тобто. <code class=" language-none">Arrays.asList</code>не зробить з <code class=" language-none">int[]</code>нас <code class=" language-none">List</code>з <code class=" language-none">Integer</code>'ів. &lt;h2&gt;Розпакування Unboxing&lt;/h2&gt;Зворотний процес до boxing називається unboxing розпакування. Розглянемо приклад розпакування: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">App</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>args<span class="token punctuation"><span class="token punctuation">.</span></span>length <span class="token operator"><span class="token operator">==</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
            <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Please, enter params"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
            <span class="token keyword"><span class="token keyword">return</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token punctuation"><span class="token punctuation">}</span></span>
      	<span class="token keyword"><span class="token keyword">int</span></span> value <span class="token operator"><span class="token operator">=</span></span> <span class="token class-name"><span class="token class-name">Math</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">abs</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Integer</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">valueOf</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>args<span class="token punctuation"><span class="token punctuation">[</span></span><span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">]</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Absolute value is: "</span></span> <span class="token operator"><span class="token operator">+</span></span> value<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre><code class=" language-none">Math.abs</code>приймає лише примітиви. Що ж робити? У класу обгортки є на цей випадок спеціальний метод, який повертає примітив. Наприклад, для <code class=" language-none">Integer</code>цього метод <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html#intValue--" target="_blank" rel="nofollow">intValue</a> . Якщо ми подивимось у байткод, то так і є: 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="7ec79891-d8f3-43c0-be62-e8f3c44ed7fd" data-max-width="710" alt="Автоупаковка та розпакування в Java - 4" src="https://cdn.javarush.com/images/article/7ec79891-d8f3-43c0-be62-e8f3c44ed7fd/512.jpeg" style="width: 710px;">
 </div>
</div> Як видно, жодної магії. Все в рамках Java. Просто воно працює «само». Для нашої зручності. &lt;h2&gt;Граблі&lt;/h2&gt; 
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="56e603b6-b7a9-4d2e-b2b8-90335e137214" data-max-width="710" alt="Автоупаковка та розпакування в Java - 5" src="https://cdn.javarush.com/images/article/56e603b6-b7a9-4d2e-b2b8-90335e137214/512.jpeg" style="width: 710px;">
 </div>
</div> Будь-який інструмент при неправильному використанні стає грізною зброєю проти себе. Та механізм автопакування та розпакування boxing/unboxing у Java не виняток. Перше, очевидне, порівняння через <code class=" language-none">==</code>. Думаю, це зрозуміло, але розберемо ще раз: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">Integer</span></span> inCacheValue <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">127</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">Integer</span></span> inCacheValue2 <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">127</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">Integer</span></span> notInCache <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">128</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">// new Integer(129)</span></span>
    <span class="token class-name"><span class="token class-name">Integer</span></span> notInCache2 <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">128</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">// new Integer(129)</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>inCacheValue <span class="token operator"><span class="token operator">==</span></span> inCacheValue2<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">//true</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>notInCache <span class="token operator"><span class="token operator">==</span></span> notInCache2<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">//false</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> У першому випадку значення береться з кеша <code class=" language-none">Integer</code>значень (див. пояснення Boxing вище), а в другому буде створюватися щоразу новий об'єкт. Але тут варто обмовитися. Ця поведінка залежить від верхньої межі кешу ( <strong>java.lang.Integer.IntegerCache.high</strong> ). Крім того, цей кордон може змінитися і через інші налаштування. На цю тему можна ознайомитися з обговоренням на stackoverflow: <a href="https://stackoverflow.com/questions/15052216/how-large-is-the-integer-cache" target="_blank" rel="nofollow">How large is the Integer cache? </a> Звичайно, об'єкти потрібно порівнювати через equals: <code class=" language-none">System.out.println(notInCache.equals(notInCache2));</code> Друга проблема, пов'язана з тим самим механізмом – продуктивність. Будь-яка упаковка в Java дорівнює створення нового об'єкта. Якщо число не входить у значення з кешу (тобто -128 до 127), то щоразу створюватиметься новий об'єкт. Якщо раптом упаковка (тобто boxing) вироблятиметься у циклі, це викличе величезний приріст непотрібних об'єктів і споживання ресурсів працювати збирача сміття. Тому, не варто надто безрозсудно ставитися до цього. Треті не менш хворі граблі випливають із того ж механізму: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">check</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Integer</span></span> value<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>value <span class="token operator"><span class="token operator">&lt;=</span></span> <span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">throw</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">IllegalStateException</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Value is too small"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> У цьому коді людина явно намагалася не пройти повз помилку. Але тут немає перевірки на <code class=" language-none">null</code>. Якщо на вхід прийде <code class=" language-none">null</code>, то замість зрозумілої помилки ми отримаємо невиразний <code class=" language-none">NullPointerException</code>. Тому що для порівняння Java спробує виконати <code class=" language-none">value.intValue</code>та впаде, т.к. <code class=" language-none">value</code>буде <code class=" language-none">null</code>. &lt;h2&gt;Висновок&lt;/h2&gt;Механізм boxing/unboxing дозволяє програмісту писати менше коду і навіть часом не думати про перетворення з примітивів на об'єкти і назад. Але це не означає, що слід забувати, як це працює. Інакше можна припуститися помилки, яка може спливти не відразу. Не варто покладатися на частини системи, які не повністю під нашим контролем (наприклад кордон integer). Але й не варто забувати про всі переваги класів-оберток (начебто<code class=" language-none">Integer</code>). Часто ці класи-обертки мають набір додаткових статичних методів, які зроблять ваше життя кращим, а код виразнішим. Ось приклад у наздогін: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">int</span></span> first <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">1</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token keyword"><span class="token keyword">int</span></span> second <span class="token operator"><span class="token operator">=</span></span> <span class="token number"><span class="token number">5</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Integer</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">max</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>first<span class="token punctuation"><span class="token punctuation">,</span></span> second<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Character</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">toLowerCase</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">'S'</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Так само правильний висновок із усього – немає магії, є якась реалізація. І не скрізь завжди буде те, що ми очікуємо. Наприклад, тут немає упаковки: <code class=" language-none">System.out.println("The number is " + 8);</code> Приклад вище компілятором буде соптимизирован в один рядок. Тобто наче ви написали «The number is 8». І в прикладі нижче також не буде упаковки: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"The number is "</span></span> <span class="token operator"><span class="token operator">+</span></span> <span class="token class-name"><span class="token class-name">Math</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">abs</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token operator"><span class="token operator">-</span></span><span class="token number"><span class="token number">2</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Як же так, коли у нас <code class=" language-none">println</code>приймає на вхід об'єкт і потрібно з'єднати рядки. Рядки… так, саме тому немає упаковки як такої. Є <code class=" language-none">Integer</code>статичні методи, але з них рівня <code class=" language-none">package</code>. Тобто ми їх не можемо використовувати, а в самій Java вони можуть активно використовуватися. Ось тут саме такий випадок. Буде викликаний метод getChars, який у складі робить масив символів. Знову ж таки, ніякої магії, тільки Java ). Тож у будь-якій незрозумілій ситуації варто просто подивитися реалізацію і хоч щось та й стане на свої місця. #Viacheslav