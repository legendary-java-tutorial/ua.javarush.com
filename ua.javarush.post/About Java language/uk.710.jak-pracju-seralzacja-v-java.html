Як працює серіалізація в Java
<p>----------------------------------------</p>
У цій статті ми розповімо, що таке серіалізація і як вона працює у Java Серіалізація об'єкта - це здатність об'єкта зберігати повну копію його та будь-яких інших об'єктів, на які він посилається, використовуючи потік виводу (наприклад, у зо
<p>----------------------------------------</p>
У цій статті ми розповімо, що таке серіалізація і як вона працює у Java <img data-id="55f2ffdd-554d-4852-9a99-7884ca3d7aa2" data-max-width="850" alt="Як працює серіалізація в Java - 1" src="https://cdn.javarush.com/images/article/55f2ffdd-554d-4852-9a99-7884ca3d7aa2/800.jpeg" style="width: 850px;">
<h2>Вступ</h2>Серіалізація об'єкта - це здатність об'єкта зберігати повну копію його та будь-яких інших об'єктів, на які він посилається, використовуючи потік виводу (наприклад, у зовнішній файл). Таким чином, об'єкт може бути відтворений із серіалізованої (збереженої) копії трохи пізніше, коли це буде потрібно. Серіалізація об'єктів, як нова можливість введена в JDK 1.1, надає функцію для перетворення груп або окремих об'єктів, потік бітів або масив байтів, для зберігання або передачі по мережі. І як було сказано, даний потік бітів або масив байтів можна перетворити назад в об'єкти Java. Головним чином це відбувається автоматично завдяки класам <code class=" language-none">ObjectInputStream</code>та <code class=" language-none">ObjectOutputStream</code>. Програміст може вирішити реалізувати цю функцію шляхом реалізації інтерфейсу<code class=" language-none">Serializable</code>під час створення класу. Процес серіалізації також відомий як <strong>маршалінг</strong> об'єкта, десеріалізація ж відома як <strong>демаршалінг</strong> . Серіалізація це механізм, що надає можливість об'єкту зберегти свою копію та всі інші об'єкти, на які посилається даний об'єкт, у зовнішній файл за допомогою класу <code class=" language-none">ObjectOutputStream</code>. Збережені можуть бути структури даних, діаграми, об'єкти класу <code class=" language-none">JFrame</code>або будь-які інші об'єкти незалежно від їх типу. У той же час, серіалізація зберігає інформацію про те, якого типу об'єкта, щоб у подальшому, при десеріалізації, ця інформація використовувалася для відтворення точного типу об'єкта, яким він був. Отже, серіалізація надає такі можливості: 
<ul>
 <li>Система зберігання об'єктів, тобто: збереження їх властивостей у зовнішній файл, диск або базу даних.</li>
 <li>Система дзвінків віддалених процедур.</li>
 <li>Система розподілу об'єктів, наприклад, у програмних компонентах типу COM, COBRA.</li>
 <li>Система ідентифікації змінних даних у часі.</li>
</ul>Щоб повністю зрозуміти концепцію серіалізації, треба мати чітке розуміння двох інших концепцій — персистентності об'єктів і потоків. Тут ми трохи розповімо про кожну з них, щоби згадати. Повне пояснення щодо них, вимагало б окремому розділі кожної з цих концепцій. 
<h2>Потоки:</h2>Кожна програма повинна записувати свої дані до місця зберігання або каналу, і кожна програма повинна зчитувати дані з каналу або місця зберігання. У Java ці канали, куди програми записують і звідки програми зчитують дані, називаються <strong>Потоками ( <code class=" language-none">Stream</code>)</strong> . <img data-id="9063e091-6730-4369-b0a7-ca3237278540" data-max-width="650" alt="Як працює серіалізація в Java - 2" src="https://cdn.javarush.com/images/article/9063e091-6730-4369-b0a7-ca3237278540/512.jpeg" style="width: 650px;">
<center>
 <em>Малюнок 1. Графічне подання Потоків</em>
</center> Потоки в основному поділяються на два типи: 
<ul>
 <li>Байтові класи-потоки звані *Streams</li>
 <li>Символьні класи-потоки звані *Reader та *Writer</li>
</ul>Кожен потік запису даних містить набір методів запису. І кожен потік зчитування даних, відповідно, має подібний набір методів читання. Як тільки потік створюється, всі ці методи мають бути викликані. 
<h2>Персистентність</h2>Персистентність об'єкта - це здатність об'єкта жити або по-іншому - "пережити" виконання програми. Це означає, що будь-який об'єкт, створений у часі виконання, знищується "сміттярем" JVM, щоразу, коли цей об'єкт далі перестає використовуватися. Але у разі реалізації API персистентності, дані об'єкти не будуть знищуватись "сміттярем" JVM, замість чого їм буде дозволено "жити", що також дає можливість доступу до них при наступному запуску програми. Іншими словами, персистенція означає існування часу життя об'єкта, незалежно від часу життя програми, яка запущена. Один із способів реалізації персистентності це зберігання об'єктів де-небудь у зовнішньому файлі або в базі даних, а потім відновлення їх у пізніший час, використовуючи дані файли чи базу даних як джерела. Тут серіалізація і входить у гру. Будь-який неперсистентний об'єкт існує так довго, як довго працює JVM. Серіалізовані об'єкти — це просто об'єкти, перетворені на потоки, які потім зберігаються у зовнішній файл або передаються через мережу для зберігання та відновлення. 
<h2>Реалізація інтерфейсу Serializable</h2>Будь-який клас має реалізовувати інтерфейс <code class=" language-none">java.io.Serializable</code>для серіалізації об'єктів цього класу. Інтерфейс <code class=" language-none">Serializable</code>не має методів і тільки маркерує клас, щоб можна було його ідентифікувати як серіалізований. Тільки поля об'єкта серіалізованого класу можна зберегти. Методи чи конструктори не зберігаються, як частини серіалізованого потоку. Якщо будь-який об'єкт діє як посилання інший об'єкт, то поля цього об'єкта також сериализованны, якщо клас цього об'єкта реалізує інтерфейс <code class=" language-none">Serializable</code>. Іншими словами, граф цього об'єкта, що отримується таким чином, серіалізуємо повністю. Граф об'єкта включає дерево чи структуру полів об'єкта та його подоб'єктов. Два головних класи, які допомагають реалізувати інтерфейс <code class=" language-none">Seriliazable</code>: 
<ul>
 <li><code class=" language-none">ObjectInputStream</code></li>
 <li><code class=" language-none">ObjectOutputStream</code></li>
</ul><em>Лістинг 1. Приклад простого класу, щоб показати серіалізацію</em>
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>io<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token operator"><span class="token operator">*</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">RandomClass</span></span> <span class="token keyword"><span class="token keyword">implements</span></span> <span class="token class-name"><span class="token class-name">Serializable</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
 <span class="token comment"><span class="token comment">// Генерация рандомного значения</span></span>
 <span class="token keyword"><span class="token keyword">private</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">int</span></span> <span class="token function"><span class="token function">r</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">return</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">int</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Math</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">random</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token operator"><span class="token operator">*</span></span> <span class="token number"><span class="token number">10</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
 <span class="token punctuation"><span class="token punctuation">}</span></span>
    <span class="token keyword"><span class="token keyword">private</span></span> <span class="token keyword"><span class="token keyword">int</span></span> data<span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token comment"><span class="token comment">// Конструктор</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">RandomClass</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        datafile <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token keyword"><span class="token keyword">int</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token function"><span class="token function">r</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">]</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token keyword"><span class="token keyword">for</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">int</span></span> i<span class="token operator"><span class="token operator">=</span></span><span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> i<span class="token operator"><span class="token operator">&lt;</span></span>datafile<span class="token punctuation"><span class="token punctuation">.</span></span>length<span class="token punctuation"><span class="token punctuation">;</span></span> i<span class="token operator"><span class="token operator">++</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>
        datafile<span class="token punctuation"><span class="token punctuation">[</span></span>i<span class="token punctuation"><span class="token punctuation">]</span></span><span class="token operator"><span class="token operator">=</span></span><span class="token function"><span class="token function">r</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
 <span class="token punctuation"><span class="token punctuation">}</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">printout</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
 <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"This RandomClass has "</span></span><span class="token operator"><span class="token operator">+</span></span>datafile<span class="token punctuation"><span class="token punctuation">.</span></span>length<span class="token operator"><span class="token operator">+</span></span><span class="token string"><span class="token string">" random integers"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
 <span class="token keyword"><span class="token keyword">for</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">int</span></span> i<span class="token operator"><span class="token operator">=</span></span><span class="token number"><span class="token number">0</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> i<span class="token operator"><span class="token operator">&lt;</span></span>datafile<span class="token punctuation"><span class="token punctuation">.</span></span>length<span class="token punctuation"><span class="token punctuation">;</span></span> i<span class="token operator"><span class="token operator">++</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">print</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>datafile<span class="token punctuation"><span class="token punctuation">[</span></span>i<span class="token punctuation"><span class="token punctuation">]</span></span><span class="token operator"><span class="token operator">+</span></span><span class="token string"><span class="token string">":"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> У наведеному вище коді створюється клас, який є серіалізується, т.к. "промаркований" інтерфейсом серіалізації. Клас створює масив випадкових цілих чисел, коли створюється його екземпляр. Наведений нижче код показує можливість запису об'єктів у потік, використовуючи клас <code class=" language-none">ObjectOutputStream</code>. Програма має масив цілих чисел, але для серіалізації ми не повинні перебирати її внутрішні об'єкти. Інтерфейс <code class=" language-none">Seriliazable</code>піклується про це автоматично. <em>Лістинг 2. Простий приклад серіалізації об'єктів для виведення файлу</em>
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>io<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token operator"><span class="token operator">*</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>util<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token operator"><span class="token operator">*</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">OutSerialize</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> main <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span> args<span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">IOException</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token class-name"><span class="token class-name">RandomClass</span></span> rc1 <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">RandomClass</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">RandomClass</span></span> rc2 <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">RandomClass</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token comment"><span class="token comment">//создание цепи потоков с потоком вывода об'єкта в конце</span></span>
<span class="token class-name"><span class="token class-name">ObjectOutputStream</span></span> out <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ObjectOutputStream</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">FileOutputStream</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"objects.dat"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">Date</span></span> now <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Date</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">currentTimeMillis</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token comment"><span class="token comment">//java.util.* был импортирован для использования класса Date</span></span>
        out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">writeObject</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>now<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">writeObject</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>rc1<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">writeObject</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>rc2<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">close</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"I have written:"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"A Date object: "</span></span><span class="token operator"><span class="token operator">+</span></span>now<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Two Group of randoms"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
rc1<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">printout</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
rc2<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">printout</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
 <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Код нижче демонструє можливості класу <code class=" language-none">ObjectInputStream</code>, який зчитує серіалізовані дані із зовнішнього файлу до програми. Зауважте, що об'єкти зчитуються в тому самому порядку, в якому були записані у файл. <em>Лістинг 3. Читання серіалізованих об'єктів або Десеріалізація</em>
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>io<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token operator"><span class="token operator">*</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>util<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token operator"><span class="token operator">*</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">InSerialize</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
 <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> main <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span> args<span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span>  <span class="token class-name"><span class="token class-name">IOException</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">ClassNotFoundException</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token class-name"><span class="token class-name">ObjectInputStream</span></span> in <span class="token operator"><span class="token operator">=</span></span>  <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ObjectInputStream</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">FileInputStream</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"objects.dat"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
 <span class="token class-name"><span class="token class-name">Date</span></span> d1 <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Date</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>in<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">readObject</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
 <span class="token class-name"><span class="token class-name">RandomClass</span></span> rc1 <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">RandomClass</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>in<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">readObject</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">RandomClass</span></span> rc2 <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">RandomClass</span></span><span class="token punctuation"><span class="token punctuation">)</span></span>in<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">readObject</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"I have read:"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"A Date object: "</span></span><span class="token operator"><span class="token operator">+</span></span>d1<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Two Group of randoms"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    rc1<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">printout</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
rc2<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">printout</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
 <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Майже всі класи Java можуть бути серіалізованими, включаючи класи AWT. Фрейм, який є вікном містить набір графічних компонентів. Якщо кадр серіалізований, механізм серіалізації піклується про це і серіалізує всі його компоненти та дані (позицію, зміст і т.д.). Деякі об'єкти класів Java не можуть бути серіалізовані, тому що містять дані, що посилаються на короткочасні ресурси операційних систем. Наприклад класи <code class=" language-none">java.io.FileInputStream</code>та <code class=" language-none">java.lang.Thread</code>. Якщо об'єкт містить посилання на елементи, що не серіалізуються, вся операція серіалізації зазнає невдачі і буде викинуто виняток <code class=" language-none">NotSerializableException</code>. Якщо будь-який об'єкт посилається на посилання несеріалізованого об'єкта, його можна серіалізувати використовуючи ключове слово <strong>transient</strong> . <em>Лістинг 4. Створення об'єктів, що серіалізуються, використовуючи ключове слово <strong>transient</strong></em>
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">Sclass</span></span> <span class="token keyword"><span class="token keyword">implements</span></span> <span class="token class-name"><span class="token class-name">Serializable</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">transient</span></span> <span class="token class-name"><span class="token class-name">Thread</span></span> newThread<span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token comment"><span class="token comment">//помните, что поток(поток параллельного исполнения) по умолчанию не сериализуемый класс</span></span>
    <span class="token keyword"><span class="token keyword">private</span></span> <span class="token class-name"><span class="token class-name">String</span></span> studentID<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token keyword"><span class="token keyword">private</span></span> <span class="token keyword"><span class="token keyword">int</span></span> sum<span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre>
<h2>Безпека у Серіалізації</h2>Серіалізація класу в Java передбачає передачу всіх його даних у зовнішній файл або базу даних через потік. Ми можемо обмежити дані, які будуть серіалізовані, коли того забажаємо. Є два способи зробити це: 
<ul>
 <li>Кожен параметр класу оголошений як <strong>transient</strong> , не серіалізуються (за замовчуванням усі параметри класу серіалізуються)</li>
 <li>Або кожен параметр класу, який ми хочемо серіалізувати, позначається тегом <code class=" language-none">Externalizable</code>(за замовчуванням параметри не серіалізуються).</li>
</ul>Поле даних не буде серіалізоване за допомогою <code class=" language-none">ObjectOutputStream</code>, коли воно буде викликане для об'єкта, якщо це поле даних даного об'єкта позначено як <strong>transient</strong> . Наприклад: <code class=" language-none">private transient String password</code>. З іншого боку, для явного оголошення даних об'єкта як серіалізується, ми повинні промаркувати клас як <code class=" language-none">ExternalizablewriteExternal</code>і <code class=" language-none">readExteranl</code>для запису та читання даних цього об'єкта явно. 
<h2>Висновок</h2>Особливість серіалізації об'єктів використана у багатьох розподілених системах як спосіб передачі даних. Але серіалізація розкриває приховані деталі, таким чином руйнуючи справжність абстрактних типів даних, що руйнує інкапсуляцію. У той же час приємно знати, що дані серіалізованого об'єкта, ті самі дані, що були у вихідному, оригінальному об'єкті. Це також відмінна можливість реалізації інтерфейсу <code class=" language-none">ObjectInputValidation</code>і перевизначення методу <code class=" language-none">validateObject()</code>, навіть якщо використовуються кілька рядків коду. Якщо об'єкт не знайдено, ми можемо належним чином викинути виняток <code class=" language-none">InvalidObjectException</code>. Оригінал статті: <a href="http://mrbool.com/how-serialization-works-in-java/28129" rel="nofollow" target="_blank">How serialization works in Java</a>