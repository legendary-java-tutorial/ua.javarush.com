Створюємо телеграм-бота з використанням Spring Boot Pt.3: Quiz Bot
<p>----------------------------------------</p>
На жаль, перша версія статті не пролізла до ліміту символів, так що закінчую тут: QuizHandler:
<p>----------------------------------------</p>
<a href="https://codegym.cc/groups/posts/2959-sozdaem-telegram-bota-s-ispoljhzovaniem-spring-boot" target="_blank" rel="nofollow">ЧАСТИНА 1 </a> <a href="https://codegym.cc/groups/posts/2966-sozdaem-telegram-bota-s-ispoljhzovaniem-spring-boot-pt2-quiz-bot" target="_blank" rel="nofollow">ЧАСТИНА 2</a> На жаль, перша версія статті не пролізла до ліміту символів, так що закінчую тут: QuizHandler: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>whiskels<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span>bot<span class="token punctuation">.</span>handler</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whiskels<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span>bot<span class="token punctuation">.</span></span><span class="token class-name">State</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whiskels<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">Question</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whiskels<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">User</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whiskels<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">JpaQuestionRepository</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>whiskels<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">JpaUserRepository</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span>telegrambots<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>api<span class="token punctuation">.</span>methods<span class="token punctuation">.</span></span><span class="token class-name">PartialBotApiMethod</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span>telegrambots<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>api<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>replykeyboard<span class="token punctuation">.</span></span><span class="token class-name">InlineKeyboardMarkup</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span>telegrambots<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>api<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>replykeyboard<span class="token punctuation">.</span>buttons<span class="token punctuation">.</span></span><span class="token class-name">InlineKeyboardButton</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collections</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">com<span class="token punctuation">.</span>whiskels<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">TelegramUtil</span><span class="token punctuation">.</span>createInlineKeyboardButton<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">com<span class="token punctuation">.</span>whiskels<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">TelegramUtil</span><span class="token punctuation">.</span>createMessageTemplate<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuizHandler</span> <span class="token keyword">implements</span> <span class="token class-name">Handler</span> <span class="token punctuation">{</span>
    <span class="token comment">//Храним поддерживаемые CallBackQuery в виде констант</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> QUIZ_CORRECT <span class="token operator">=</span> <span class="token string">"/quiz_correct"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> QUIZ_INCORRECT <span class="token operator">=</span> <span class="token string">"/quiz_incorrect"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> QUIZ_START <span class="token operator">=</span> <span class="token string">"/quiz_start"</span><span class="token punctuation">;</span>
    <span class="token comment">//Храним варианты ответа</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>string<span class="token punctuation">&gt;</span></span> OPTIONS <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JpaUserRepository</span> userRepository<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JpaQuestionRepository</span> questionRepository<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">QuizHandler</span><span class="token punctuation">(</span><span class="token class-name">JpaUserRepository</span> userRepository<span class="token punctuation">,</span> <span class="token class-name">JpaQuestionRepository</span> questionRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository <span class="token operator">=</span> userRepository<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>questionRepository <span class="token operator">=</span> questionRepository<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>partialbotapimethod<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span><span class="token operator">=</span><span class="token string">""</span> serializable<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;&gt;</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>QUIZ_CORRECT<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// действие на коллбек с правильным ответом</span>
            <span class="token keyword">return</span> <span class="token function">correctAnswer</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>QUIZ_INCORRECT<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// действие на коллбек с неправильным ответом</span>
            <span class="token keyword">return</span> <span class="token function">incorrectAnswer</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">startNewQuiz</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>partialbotapimethod<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span><span class="token operator">=</span><span class="token string">""</span> serializable<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;&gt;</span> <span class="token function">correctAnswer</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"correct"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> currentScore <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span>currentScore<span class="token punctuation">)</span><span class="token punctuation">;</span>
        userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">nextQuestion</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>partialbotapimethod<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span><span class="token operator">=</span><span class="token string">""</span> serializable<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;&gt;</span> <span class="token function">incorrectAnswer</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> currentScore <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Обновляем лучший итог</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getHighScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> currentScore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            user<span class="token punctuation">.</span><span class="token function">setHighScore</span><span class="token punctuation">(</span>currentScore<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Меняем статус пользователя</span>
        user<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setBotState</span><span class="token punctuation">(</span><span class="token class-name">State</span><span class="token punctuation">.</span>NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Создаем кнопку для повторного начала игры</span>
        <span class="token class-name">InlineKeyboardMarkup</span> inlineKeyboardMarkup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InlineKeyboardMarkup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>inlinekeyboardbutton<span class="token punctuation">&gt;</span></span> inlineKeyboardButtonsRowOne <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>
                <span class="token function">createInlineKeyboardButton</span><span class="token punctuation">(</span><span class="token string">"Try again?"</span><span class="token punctuation">,</span> QUIZ_START<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        inlineKeyboardMarkup<span class="token punctuation">.</span><span class="token function">setKeyboard</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>inlineKeyboardButtonsRowOne<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token function">createMessageTemplate</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Incorrect!%nYou scored *%d* points!"</span><span class="token punctuation">,</span> currentScore<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setReplyMarkup</span><span class="token punctuation">(</span>inlineKeyboardMarkup<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>partialbotapimethod<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span><span class="token operator">=</span><span class="token string">""</span> serializable<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;&gt;</span> <span class="token function">startNewQuiz</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        user<span class="token punctuation">.</span><span class="token function">setBotState</span><span class="token punctuation">(</span><span class="token class-name">State</span><span class="token punctuation">.</span>PLAYING_QUIZ<span class="token punctuation">)</span><span class="token punctuation">;</span>
        userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">nextQuestion</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>partialbotapimethod<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span><span class="token operator">=</span><span class="token string">""</span> serializable<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;&gt;</span> <span class="token function">nextQuestion</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Question</span> question <span class="token operator">=</span> questionRepository<span class="token punctuation">.</span><span class="token function">getRandomQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Собираем список возможных вариантов ответа</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>string<span class="token punctuation">&gt;</span></span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>question<span class="token punctuation">.</span><span class="token function">getCorrectAnswer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> question<span class="token punctuation">.</span><span class="token function">getOptionOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> question<span class="token punctuation">.</span><span class="token function">getOptionTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> question<span class="token punctuation">.</span><span class="token function">getOptionThree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Перемешиваем</span>
        <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">shuffle</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Начинаем формировать сообщение с вопроса</span>
        <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>question<span class="token punctuation">.</span><span class="token function">getQuestion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"*\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">InlineKeyboardMarkup</span> inlineKeyboardMarkup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InlineKeyboardMarkup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Создаем два ряда кнопок</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>inlinekeyboardbutton<span class="token punctuation">&gt;</span></span> inlineKeyboardButtonsRowOne <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>inlinekeyboardbutton<span class="token punctuation">&gt;</span></span> inlineKeyboardButtonsRowTwo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Формируем сообщение и записываем CallBackData на кнопки</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> options<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">InlineKeyboardButton</span> button <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InlineKeyboardButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">final</span> <span class="token class-name">String</span> callbackData <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span>question<span class="token punctuation">.</span><span class="token function">getCorrectAnswer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> QUIZ_CORRECT <span class="token operator">:</span> QUIZ_INCORRECT<span class="token punctuation">;</span>

            button<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>OPTIONS<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">setCallbackData</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%s %d"</span><span class="token punctuation">,</span> callbackData<span class="token punctuation">,</span> question<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                inlineKeyboardButtonsRowOne<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                inlineKeyboardButtonsRowTwo<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>OPTIONS<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">". "</span> <span class="token operator">+</span> options<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        inlineKeyboardMarkup<span class="token punctuation">.</span><span class="token function">setKeyboard</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>inlineKeyboardButtonsRowOne<span class="token punctuation">,</span> inlineKeyboardButtonsRowTwo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token function">createMessageTemplate</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setReplyMarkup</span><span class="token punctuation">(</span>inlineKeyboardMarkup<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
 <strong></strong>   <span class="token keyword">public</span> <span class="token class-name">State</span> <span class="token function">operatedBotState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>string<span class="token punctuation">&gt;</span></span> <span class="token function">operatedCallBackQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>QUIZ_START<span class="token punctuation">,</span> QUIZ_CORRECT<span class="token punctuation">,</span> QUIZ_INCORRECT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>&lt;h3&gt;Заповнюємо базу даних&lt;/h3&gt;Тут ми запишемо наші питання за аналогією зі скриптом ініціалізації БД. 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java">DELETE
<span class="token class-name">FROM</span> java_quiz<span class="token punctuation">;</span>

INSERT <span class="token class-name">INTO</span> java_quiz <span class="token punctuation">(</span>question<span class="token punctuation">,</span> answer_correct<span class="token punctuation">,</span> option1<span class="token punctuation">,</span> option2<span class="token punctuation">,</span> option3<span class="token punctuation">)</span>
VALUES <span class="token punctuation">(</span><span class="token string">'What is a correct syntax to output "Hello World" in Java?'</span><span class="token punctuation">,</span> <span class="token string">'System.out.println("Hello World!");'</span><span class="token punctuation">,</span>
        <span class="token string">'print("Hello World!");'</span><span class="token punctuation">,</span> <span class="token string">'sout("Hello World!");'</span><span class="token punctuation">,</span> <span class="token string">'Systemout.print("Hello world!");'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token string">'What is the correct way to create an object called foo of Bar class?'</span><span class="token punctuation">,</span> <span class="token string">'Bar foo = new Bar();'</span><span class="token punctuation">,</span>
        <span class="token string">'Foo bar = new Foo();'</span><span class="token punctuation">,</span> <span class="token string">'Bar foo() = new Foo();'</span><span class="token punctuation">,</span> <span class="token string">'Foo bar() = new Bar();'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token string">'Which operator can be used to compare two values?'</span><span class="token punctuation">,</span> <span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token string">'='</span><span class="token punctuation">,</span> <span class="token string">'&amp;'</span><span class="token punctuation">,</span> <span class="token string">'==='</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token string">'Which method can be used to return a string in upper case letters?'</span><span class="token punctuation">,</span> <span class="token string">'toUpperCase()'</span><span class="token punctuation">,</span> <span class="token string">'camelCase()'</span><span class="token punctuation">,</span>
        <span class="token string">'upperCase()'</span><span class="token punctuation">,</span> <span class="token string">'formatUpper()'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token string">'Which method can be used to find the length of a string?'</span><span class="token punctuation">,</span> <span class="token string">'length()'</span><span class="token punctuation">,</span> <span class="token string">'getSize()'</span><span class="token punctuation">,</span> <span class="token string">'len()'</span><span class="token punctuation">,</span> <span class="token string">'getLength()'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token string">'Which data type is used to create a variable that should store text?'</span><span class="token punctuation">,</span> <span class="token string">'String'</span><span class="token punctuation">,</span> <span class="token string">'Text'</span><span class="token punctuation">,</span> <span class="token string">'Varchar'</span><span class="token punctuation">,</span> <span class="token string">'const'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token string">'How to insert a comment?'</span><span class="token punctuation">,</span> <span class="token string">'// like this'</span><span class="token punctuation">,</span> <span class="token string">'# like this'</span><span class="token punctuation">,</span> <span class="token string">'&lt;-- like this --&gt;'</span><span class="token punctuation">,</span> <span class="token string">'/ like this'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> Залишилось тільки поправити application.yaml: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java">bot<span class="token operator">:</span>
  name<span class="token operator">:</span> <span class="token class-name">JavaQuiz</span>
  token<span class="token operator">:</span> <span class="token number">1234567</span><span class="token operator">:</span><span class="token class-name">AAF0Wru1Z60p8vPtKihx3odbwSv9O0y_</span><span class="token operator">-</span>MM
spring<span class="token operator">:</span>
  datasource<span class="token operator">:</span>
    url<span class="token operator">:</span> jdbc<span class="token operator">:</span>postgresql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>ec2<span class="token operator">-</span><span class="token number">54</span><span class="token operator">-</span><span class="token number">75</span><span class="token operator">-</span><span class="token number">199</span><span class="token operator">-</span><span class="token number">252.</span>eu<span class="token operator">-</span>west<span class="token operator">-</span><span class="token number">1.</span>compute<span class="token punctuation">.</span>amazonaws<span class="token punctuation">.</span>com<span class="token operator">:</span><span class="token number">5432</span><span class="token operator">/</span>d5p9skg6nin3mh<span class="token operator">?</span>user<span class="token operator">=</span>bozuqwnhjhoubl<span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">8</span>a40050de8a0014c14df49aeaac5880f1ac633cc20c78a4cc3b32323231
    driver<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">-</span>name<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>postgresql<span class="token punctuation">.</span></span>Driver</span>
    initialization<span class="token operator">-</span>mode<span class="token operator">:</span> never
  jpa<span class="token operator">:</span>
    database<span class="token operator">-</span>platform<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>dialect<span class="token punctuation">.</span></span>PostgreSQLDialect</span>
    show<span class="token operator">-</span>sql<span class="token operator">:</span> <span class="token boolean">true</span>
    hibernate<span class="token operator">:</span>
      ddl<span class="token operator">-</span>auto<span class="token operator">:</span> update</code></pre> URL бази даних відрізняється від того, що вказано в полі URI на Heroku, так що ось коротка шпаргалка про те, як його скласти: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java">jdbc<span class="token operator">:</span>postgresql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">{</span><span class="token class-name">Host</span><span class="token punctuation">}</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token class-name">Port</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token punctuation">{</span><span class="token class-name">Database</span><span class="token punctuation">}</span><span class="token operator">?</span>user<span class="token operator">=</span><span class="token punctuation">{</span><span class="token class-name">User</span><span class="token punctuation">}</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token punctuation">{</span><span class="token class-name">Password</span><span class="token punctuation">}</span></code></pre> Якщо ми все зробабо правильно, то запускаючи main не побачимо стектрейсу, навіть навпаки: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token punctuation">.</span>   ____          _            __ _ _
 <span class="token operator">/</span>\\ <span class="token operator">/</span> ___<span class="token string">'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '</span>_ <span class="token operator">|</span> <span class="token string">'_| | '</span>_ \<span class="token operator">/</span> _` <span class="token operator">|</span> \ \ \ \
 \\<span class="token operator">/</span>  ___<span class="token punctuation">)</span><span class="token operator">|</span> <span class="token operator">|</span>_<span class="token punctuation">)</span><span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">||</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span>  <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
  '  <span class="token operator">|</span>____<span class="token operator">|</span> <span class="token punctuation">.</span>__<span class="token operator">|</span>_<span class="token operator">|</span> <span class="token operator">|</span>_<span class="token operator">|</span>_<span class="token operator">|</span> <span class="token operator">|</span>_\__<span class="token punctuation">,</span> <span class="token operator">|</span> <span class="token operator">/</span> <span class="token operator">/</span> <span class="token operator">/</span> <span class="token operator">/</span>
 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">|</span>_<span class="token operator">|=</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">|</span>___<span class="token operator">/=</span><span class="token operator">/</span>_<span class="token operator">/</span>_<span class="token operator">/</span>_<span class="token operator">/</span>
 <span class="token operator">::</span> <span class="token class-name">Spring</span> <span class="token class-name">Boot</span> <span class="token operator">::</span>        <span class="token punctuation">(</span>v2<span class="token punctuation">.</span><span class="token number">2.4</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">)</span>

<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">43.081</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>whiskels<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span></span>App</span>                <span class="token operator">:</span> <span class="token class-name">Starting</span> <span class="token class-name">App</span> on <span class="token class-name">Kuzmin</span> <span class="token keyword">with</span> <span class="token class-name">PID</span> <span class="token number">14536</span> <span class="token punctuation">(</span><span class="token class-name">D</span><span class="token operator">:</span>\utilities\forCodeGym\target\classes started by whiskels in <span class="token class-name">D</span><span class="token operator">:</span>\utilities\forCodeGym<span class="token punctuation">)</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">43.087</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>whiskels<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span></span>App</span>                <span class="token operator">:</span> <span class="token class-name">No</span> active profile set<span class="token punctuation">,</span> falling back <span class="token keyword">to</span> <span class="token keyword">default</span> profiles<span class="token operator">:</span> <span class="token keyword">default</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">44.014</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token punctuation">.</span>s<span class="token punctuation">.</span>d<span class="token punctuation">.</span>r<span class="token punctuation">.</span>c<span class="token punctuation">.</span>RepositoryConfigurationDelegate <span class="token operator">:</span> <span class="token class-name">Bootstrapping</span> <span class="token class-name">Spring</span> <span class="token class-name">Data</span> JPA repositories in DEFAULT mode<span class="token punctuation">.</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">44.131</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token punctuation">.</span>s<span class="token punctuation">.</span>d<span class="token punctuation">.</span>r<span class="token punctuation">.</span>c<span class="token punctuation">.</span>RepositoryConfigurationDelegate <span class="token operator">:</span> <span class="token class-name">Finished</span> <span class="token class-name">Spring</span> <span class="token class-name">Data</span> repository scanning in <span class="token number">102</span>ms<span class="token punctuation">.</span> <span class="token class-name">Found</span> <span class="token number">2</span> JPA repository interfaces<span class="token punctuation">.</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">44.774</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>LogHelper</span>  <span class="token operator">:</span> HHH000204<span class="token operator">:</span> <span class="token class-name">Processing</span> <span class="token class-name">PersistenceUnitInfo</span> <span class="token punctuation">[</span>name<span class="token operator">:</span> <span class="token keyword">default</span><span class="token punctuation">]</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">44.885</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span></span>Version</span>                    <span class="token operator">:</span> HHH000412<span class="token operator">:</span> <span class="token class-name">Hibernate</span> <span class="token class-name">Core</span> <span class="token punctuation">{</span><span class="token number">5.4</span><span class="token number">.10</span><span class="token punctuation">.</span>Final<span class="token punctuation">}</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">45.053</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>common<span class="token punctuation">.</span></span>Version</span>   <span class="token operator">:</span> HCANN000001<span class="token operator">:</span> <span class="token class-name">Hibernate</span> <span class="token class-name">Commons</span> <span class="token class-name">Annotations</span> <span class="token punctuation">{</span><span class="token number">5.1</span><span class="token number">.0</span><span class="token punctuation">.</span>Final<span class="token punctuation">}</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">45.278</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>zaxxer<span class="token punctuation">.</span>hikari<span class="token punctuation">.</span></span>HikariDataSource</span>       <span class="token operator">:</span> <span class="token class-name">HikariPool</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token class-name">Starting</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">46.770</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>zaxxer<span class="token punctuation">.</span>hikari<span class="token punctuation">.</span></span>HikariDataSource</span>       <span class="token operator">:</span> <span class="token class-name">HikariPool</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token class-name">Start</span> completed<span class="token punctuation">.</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">46.790</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>dialect<span class="token punctuation">.</span></span>Dialect</span>            <span class="token operator">:</span> HHH000400<span class="token operator">:</span> <span class="token class-name">Using</span> dialect<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>dialect<span class="token punctuation">.</span></span>PostgreSQLDialect</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">49.731</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">o<span class="token punctuation">.</span>h<span class="token punctuation">.</span>e<span class="token punctuation">.</span>t<span class="token punctuation">.</span>j<span class="token punctuation">.</span>p<span class="token punctuation">.</span>i<span class="token punctuation">.</span></span>JtaPlatformInitiator</span>       <span class="token operator">:</span> HHH000490<span class="token operator">:</span> <span class="token class-name">Using</span> <span class="token class-name">JtaPlatform</span> implementation<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>engine<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>jta<span class="token punctuation">.</span>platform<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span>NoJtaPlatform</span><span class="token punctuation">]</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">49.741</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">j<span class="token punctuation">.</span></span>LocalContainerEntityManagerFactoryBean</span> <span class="token operator">:</span> <span class="token class-name">Initialized</span> JPA <span class="token class-name">EntityManagerFactory</span> <span class="token keyword">for</span> persistence unit <span class="token string">'default'</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">50.817</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>g<span class="token punctuation">.</span>x<span class="token punctuation">.</span>bots<span class="token punctuation">.</span></span>TelegramBotAutoConfiguration</span>  <span class="token operator">:</span> <span class="token class-name">Starting</span> auto config <span class="token keyword">for</span> telegram bots
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">50.830</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>g<span class="token punctuation">.</span>x<span class="token punctuation">.</span>bots<span class="token punctuation">.</span></span>TelegramBotAutoConfiguration</span>  <span class="token operator">:</span> <span class="token class-name">Initializing</span> API without webhook support
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">50.831</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">c<span class="token punctuation">.</span>g<span class="token punctuation">.</span>x<span class="token punctuation">.</span>bots<span class="token punctuation">.</span></span>TelegramBotAutoConfiguration</span>  <span class="token operator">:</span> <span class="token class-name">Registering</span> polling bot<span class="token operator">:</span> <span class="token class-name">JavaQuiz</span>
<span class="token number">2020</span><span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span><span class="token number">02</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">51.556</span>  INFO <span class="token number">14536</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token punctuation">[</span>           main<span class="token punctuation">]</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>whiskels<span class="token punctuation">.</span>telegram<span class="token punctuation">.</span></span>App</span>                <span class="token operator">:</span> <span class="token class-name">Started</span> <span class="token class-name">App</span> in <span class="token number">9.196</span> seconds <span class="token punctuation">(</span>JVM running <span class="token keyword">for</span> <span class="token number">10.023</span><span class="token punctuation">)</span></code></pre> Спробуємо поспілкуватись з нашим ботом: Знайомимося <img width="800" height="500" data-id="d31dc326-d9d5-4113-9288-eb2e4a826771" alt="Створюємо телеграм-бота з використанням Spring Boot Pt.3: Quiz Bot - 1" src="https://cdn.javarush.com/images/article/d31dc326-d9d5-4113-9288-eb2e4a826771/1080.jpeg">Граємо <img width="800" height="500" data-id="e24bb142-f83c-4da8-9de4-344064ac4e17" alt="Створюємо телеграм-бота з використанням Spring Boot Pt.3: Quiz Bot - 2" src="https://cdn.javarush.com/images/article/e24bb142-f83c-4da8-9de4-344064ac4e17/1080.jpeg">Просимо допомоги <img width="800" height="500" data-id="2c70d2d8-6a67-4a97-8417-2c98d13e42f6" alt="Створюємо телеграм-бота з використанням Spring Boot Pt.3: Quiz Bot - 3" src="https://cdn.javarush.com/images/article/2c70d2d8-6a67-4a97-8417-2c98d13e42f6/1080.jpeg">Готово! Ми написали квіз-бота. Тепер ми маємо величезну роботу — треба:
<ul>
 <li>розібратися в написаному сьогодні коді;</li>
 <li>почитати документацію Spring Data;</li>
 <li>додати логер;</li>
 <li>зайнятися рефакторингом;</li>
 <li>застосувати патерни проектування;</li>
 <li>зробити можливим просити допомогу не тільки за State.NONE;</li>
 <li>додати новий функціонал;</li>
 <li>списки лідерів;</li>
 <li>видавати лише унікальні питання;</li>
 <li>категорії питань.</li>
</ul>Сподіваюся, ця подвійна стаття була вам корисною. Якщо так - ставте зірочку в <a href="https://github.com/whiskels/TelegramNotifierBot" target="_blank" rel="nofollow">моєму репозиторії</a> , мені буде приємно! У разі виникнення питань — обговоримо їх у коментарях. І насамкінець — схема проекту: <img width="800" height="500" data-id="8301b6fd-7fd3-4cd3-b3b3-b5d44a13f105" alt="Створюємо телеграм-бота з використанням Spring Boot Pt.3: Quiz Bot - 4" src="https://cdn.javarush.com/images/article/8301b6fd-7fd3-4cd3-b3b3-b5d44a13f105/1080.jpeg"> UPDATE 12.10: Код проекту виклав на <a href="https://github.com/whiskels/simpleQuizBot" target="_blank" rel="nofollow">гіт</a> as is без змін