Частина 3. Створюємо скелет нашої бази, перші SQL команди з прикладів java.sql.
<p>----------------------------------------</p>
Повернемося до Java-додатку. Варіант попередньої частини був створений в -стилі, щоб проконтролювати коректність початкових дій. Ми реалізуємо триланкову (тришарову) архітектуру, яку в англомовній літературі часто називають . Її коротка сут
<p>----------------------------------------</p>
<em><strong><a href="https://codegym.cc/groups/posts/1952-vvedenie-v-sql" target="_blank">Перша частина</a></strong></em> <a href="https://codegym.cc/groups/posts/1970-chastjh-2-struktura-subd-tablicih-i-tipih-dannihkh-sozdaem-skelet-nashey-bazih-pervihe-sql-koma" target="_blank"><em><strong> Друга частина</strong></em></a>
<div class="row justify-content-center jr-image-wrap">
 <div class="col-12 col-sm-10 col-md-8">
  <img data-id="4bb3cf32-35f6-4077-8e7a-55eed711c20d" data-max-width="710" alt="Частина 3. Створюємо скелет нашої бази, перші SQL команди з прикладів java.sql.  - 1" src="https://cdn.javarush.com/images/article/4bb3cf32-35f6-4077-8e7a-55eed711c20d/512.jpeg" style="width: 710px;">
 </div>
</div>
<h2>Java додаток</h2>
<h3>3-tier організація</h3>Повернемося до Java-додатку. Варіант попередньої частини був створений в <em>HelloWorld</em> -стилі, щоб проконтролювати коректність початкових дій. Ми реалізуємо триланкову (тришарову) архітектуру, яку в англомовній літературі часто називають <em><strong>3tier/3layer</strong></em> . Її коротка суть така: 
<ul>
 <li>Усі сутності оформлені у вигляді моделей (Model). Це об'єкти, які містять: 
  <ul>
   <li>Набір атрибутів (приватні поля класу).</li>
   <li>Конструктор(и).</li>
   <li>Сетери та гетери для встановлення/читання атрибутів.</li>
   <li>Важливо, що іншого коду, крім перерахованого вище в них немає. Часто такі об'єкти називають <strong>POJO</strong> (Plain Old Java Object).</li>
  </ul></li>
 <li>Всю логіку роботи з моделями продає шар Service. Він формує бізнес-правила для моделей. Наприклад, обробка запитів від Java-програми. Серед аргументів запитів і результатів, що повертаються, часто виступають моделі (або їх колекції).</li>
 <li>Шар Repository — «посередник» між СУБД та Service, що працює безпосередньо з базою даних, та відповідає за взаємодію з нею.</li>
</ul><img data-id="3c6bed90-e57e-4cf0-a6a7-ff9f9b41d76e" data-max-width="550" alt="Частина 3. Створюємо скелет нашої бази, перші SQL команди з прикладів java.sql.  - 2" src="https://cdn.javarush.com/images/article/3c6bed90-e57e-4cf0-a6a7-ff9f9b41d76e/512.jpeg" style="width: 550px;"> Навіщо нам взагалі потрібно складати такий конгломерат? Річ у тім, кожен шар максимально ізольований від інших. Якщо замість БД у нас буде набір текстових файлів, нам досить поміняти тільки реалізацію <em>Repository</em> , не чіпаючи решту коду. Аналогічно ми можемо підключити/додати інший <em>Service</em> з мінімальними змінами. Для великих систем ми можемо віддати реалізацію різних верств різним людям або експериментувати, комбінуючи оптимальні реалізації різних шарів. Створимо пакети <strong><em>model</em></strong> , <em><strong>repository</strong></em> , <em><strong>service</strong></em> для нашої програми, де будуть відповідні класи. До шару Service ми повернемося в наступних частинах, а поки що приділимо увагу моделям та репозиторіям. <img data-id="d8cd2197-d73c-42f2-bb9c-c751e4737f6d" data-max-width="300" alt="Частина 3. Створюємо скелет нашої бази, перші SQL команди з прикладів java.sql.  - 3" src="https://cdn.javarush.com/images/article/d8cd2197-d73c-42f2-bb9c-c751e4737f6d/256.jpeg" style="width: 300px;">
<h3>Model</h3>Усі наші сутності (акції, трейдери, курси та дії трейдерів) та їх табличні еквіваленти мають спільну рису – штучний первинний ключ. Тому оформимо базовий клас <code class=" language-none"><strong>BaseModel</strong></code>. Усі моделі будуть успадковуватись від нього. 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">sql<span class="token punctuation"><span class="token punctuation">.</span></span>demo<span class="token punctuation"><span class="token punctuation">.</span></span>model</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>util<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">Objects</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token comment"><span class="token comment">// Базовый класс модели, имеющий ключ id</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">BaseModel</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">protected</span></span> <span class="token keyword"><span class="token keyword">long</span></span> id<span class="token punctuation"><span class="token punctuation">;</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">long</span></span> <span class="token function"><span class="token function">getId</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">return</span></span> id<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">setId</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">long</span></span> id<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">this</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>id <span class="token operator"><span class="token operator">=</span></span> id<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">BaseModel</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span><span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">BaseModel</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">long</span></span> id<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">this</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>id <span class="token operator"><span class="token operator">=</span></span> id<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token annotation punctuation"><span class="token annotation punctuation">@Override</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">boolean</span></span> <span class="token function"><span class="token function">equals</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">Object</span></span> o<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">this</span></span> <span class="token operator"><span class="token operator">==</span></span> o<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">return</span></span> <span class="token boolean"><span class="token boolean">true</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>o <span class="token operator"><span class="token operator">==</span></span> <span class="token keyword"><span class="token keyword">null</span></span> <span class="token operator"><span class="token operator">||</span></span> <span class="token function"><span class="token function">getClass</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token operator"><span class="token operator">!=</span></span> o<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getClass</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">return</span></span> <span class="token boolean"><span class="token boolean">false</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">BaseModel</span></span> baseModel <span class="token operator"><span class="token operator">=</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">BaseModel</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> o<span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token keyword"><span class="token keyword">return</span></span> id <span class="token operator"><span class="token operator">==</span></span> baseModel<span class="token punctuation"><span class="token punctuation">.</span></span>id<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token annotation punctuation"><span class="token annotation punctuation">@Override</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">int</span></span> <span class="token function"><span class="token function">hashCode</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">return</span></span> <span class="token class-name"><span class="token class-name">Objects</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">hash</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>id<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Нижче наведено модель акції для прикладу. Інші лістинги моделей ви можете подивитися за посиланням на github-репозиторій наприкінці статті. 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">sql<span class="token punctuation"><span class="token punctuation">.</span></span>demo<span class="token punctuation"><span class="token punctuation">.</span></span>model</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>math<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">BigDecimal</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token comment"><span class="token comment">// Модель акции</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">Share</span></span> <span class="token keyword"><span class="token keyword">extends</span></span> <span class="token class-name"><span class="token class-name">BaseModel</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token comment"><span class="token comment">// поля SQL таблицы и соответствующие им поля модели</span></span>
    <span class="token comment"><span class="token comment">// типы данных SQL</span></span>
    <span class="token keyword"><span class="token keyword">private</span></span> <span class="token class-name"><span class="token class-name">String</span></span> name<span class="token punctuation"><span class="token punctuation">;</span></span>    <span class="token comment"><span class="token comment">// Наименование</span></span>
    <span class="token keyword"><span class="token keyword">private</span></span> <span class="token class-name"><span class="token class-name">BigDecimal</span></span> startPrice<span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">// Начальная цена</span></span>
    <span class="token keyword"><span class="token keyword">private</span></span> <span class="token keyword"><span class="token keyword">int</span></span> changeProbability<span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">// Вероятность смены курса (в процентах)</span></span>
    <span class="token keyword"><span class="token keyword">private</span></span> <span class="token keyword"><span class="token keyword">int</span></span> delta<span class="token punctuation"><span class="token punctuation">;</span></span>   <span class="token comment"><span class="token comment">// Максимальное колебание (в процентах)стоимости акции в результате торгов</span></span>


    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">Share</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">Share</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">long</span></span> id<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">String</span></span> name<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">BigDecimal</span></span> startPrice<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token keyword"><span class="token keyword">int</span></span> changeProbability<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token keyword"><span class="token keyword">int</span></span> delta<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">super</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>id<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token keyword"><span class="token keyword">this</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>name <span class="token operator"><span class="token operator">=</span></span> name<span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token keyword"><span class="token keyword">this</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>startPrice <span class="token operator"><span class="token operator">=</span></span> startPrice<span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token keyword"><span class="token keyword">this</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>changeProbability <span class="token operator"><span class="token operator">=</span></span> changeProbability<span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token keyword"><span class="token keyword">this</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>delta <span class="token operator"><span class="token operator">=</span></span> delta<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">String</span></span> <span class="token function"><span class="token function">getName</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">return</span></span> name<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">setName</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span> name<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">this</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>name <span class="token operator"><span class="token operator">=</span></span> name<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token punctuation"><span class="token punctuation">.</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token punctuation"><span class="token punctuation">.</span></span> оставшиеся сеттеры<span class="token operator"><span class="token operator">/</span></span>геттеры
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre>
<h3>JDBC</h3>У першій частині ми навчабося встановлювати з'єднання з БД та закривати його. Тепер ходімо далі. Етапи роботи з JDBC відображені на наступній схемі: <img data-id="aca4b8be-2f31-4acb-bf88-39edd8b8e3d2" data-max-width="550" alt="Частина 3. Створюємо скелет нашої бази, перші SQL команди з прикладів java.sql.  - 4" src="https://cdn.javarush.com/images/article/aca4b8be-2f31-4acb-bf88-39edd8b8e3d2/512.jpeg" style="width: 550px;">
<ul>
 <li><code class=" language-none"><strong>Class.forName()</strong></code>завантажує клас та реєструє його в DriverManager;</li>
 <li><code class=" language-none"><strong>DriverManager.getConnection()</strong></code>поверне <code class=" language-none">Connection</code>– з'єднання із зазначеною в аргументі методу базою даних та використанням відповідного JDBC драйвера (який був завантажений з використанням <code class=" language-none">Class.forName()</code>).</li>
 <li><code class=" language-none"><strong>createStatement()</strong></code>поверне нам <code class=" language-none">Statement</code>– об'єкт, з урахуванням якого можна формувати запити до БД. Існують також: 
  <ul>
   <il>
    <code class=" language-none"><strong>CallableStatement</strong></code>для виклику власних СУБД SQL-функцій та процедур (їх називають збереженими). 
    <li><code class=" language-none"><strong>PreparedStatement</strong></code>що полегшує створення параметризованих та пакетних запитів.</li>
   </il>
  </ul></li>
 <li>Маючи «на руках» <code class=" language-none">statement</code>дозволить <code class=" language-none"><strong>execute()</strong></code>відправити запит у вигляді команди мови запитів SQL безпосередньо на виконання СУБД і поверне відповідь у вигляді <code class=" language-none">ResultSet</code>. Для зручності існують: 
  <ul>
   <li><code class=" language-none"><strong>executeQuery()</strong></code>– для читання даних із СУБД.</li><il>
    <code class=" language-none"><strong>executeUpdate()</strong></code>– для модифікації даних у СУБД.
   </il>
  </ul></li>
 <li>Безпосередньо відповідь сервера як <code class=" language-none"><strong><strong>ResultSet</strong></strong></code>можна обробити, ітеруючи його через <code class=" language-none"><strong>first()</strong></code>, <code class=" language-none"><strong>last()</strong></code>, <code class=" language-none"><strong>next()</strong></code>тощо. Окремі поля результати ми можемо отримати через гетери: <code class=" language-none">getInteger()</code>, <code class=" language-none">getString()</code>…</li>
</ul> Слід пам'ятати, що після роботи з СУБД задля економії ресурсів бажано закрити у себе (у правильному порядку!) об'єкти <code class=" language-none">ResultSet</code>, <code class=" language-none">Statement</code>й <code class=" language-none">Connection</code>у економії ресурсів. Пам'ятайте, закриваючи об'єкт, що стоїть у послідовності на схемі, ви каскадно закриєте всі породжені в процесі роботи з ним об'єкти. Таким чином, закриття з'єднання (Connection) призведе до закриття всіх його <code class=" language-none">Statement</code>та всіх <code class=" language-none">ResultSet</code>, отриманих за їх допомогою. 
<h3>Реалізація Repository</h3>Після теоретичної JDBC-частини перейдемо до реалізації репозиторію. Архітектурно реалізуємо його так: 
<ul>
 <li>Найбільш загальні частини роботи з СУБД винесемо до загального предка – <code class=" language-none"><strong>BaseTable</strong></code>;</li>
 <li>Логічні операції, які ми виконуватимемо, оголосимо в інтерфейсі <code class=" language-none"><strong>TableOperation</strong></code>;</li>
</ul><img data-id="10789bd8-783d-45a9-be6d-193a29700bb6" data-max-width="550" alt="Частина 3. Створюємо скелет нашої бази, перші SQL команди з прикладів java.sql.  - 5" src="https://cdn.javarush.com/images/article/10789bd8-783d-45a9-be6d-193a29700bb6/512.jpeg" style="width: 550px;"> Новий репозиторій успадковуватиметься від класу <code class=" language-none">BaseTable</code>та реалізовуватиме інтерфейс <code class=" language-none">TableOperation</code>. Таким чином, нам необхідно прописати реалізацію методів, оголошених в інтерфейсі <code class=" language-none">TableOperation</code>. При цьому ми можемо використовувати методи батьківського класу <code class=" language-none">BaseTable</code>. На даний момент в інтерфейсі оголошено методи створення таблиць: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">sql<span class="token punctuation"><span class="token punctuation">.</span></span>demo<span class="token punctuation"><span class="token punctuation">.</span></span>repository</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>sql<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">SQLException</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token comment"><span class="token comment">// Операции с таблицями</span></span>
<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">interface</span></span> <span class="token class-name"><span class="token class-name">TableOperations</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">createTable</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">SQLException</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">// создание таблицы</span></span>
    <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">createForeignKeys</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">SQLException</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">// создание связей между таблицями</span></span>
    <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">createExtraConstraints</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">SQLException</span></span><span class="token punctuation"><span class="token punctuation">;</span></span> <span class="token comment"><span class="token comment">// создание дополнительных правил для значений полей таблиц</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> У міру вивчення матеріалу список об'яв методів буде розширюватися ( <code class=" language-none">read()</code>, <code class=" language-none">update()</code>….). Нові можливості здійснюватимемо за два кроки: 
<ol>
 <li>Додамо чергову можливість роботи з таблицею як нового методу інтерфейсу.</li>
 <li>Далі, в класах, що імплементують інтерфейс, опишемо програмну реалізацію в нових методах, породжених інтерфейсом.</li>
</ol> Приклад репозиторію для <code class=" language-none">Share</code>(акцій). Основна логіка знаходиться в командах створення таблиць із зазначенням типів даних SQL для полів та додавання обмежень: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">sql<span class="token punctuation"><span class="token punctuation">.</span></span>demo<span class="token punctuation"><span class="token punctuation">.</span></span>repository</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>sql<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">SQLException</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">Shares</span></span> <span class="token keyword"><span class="token keyword">extends</span></span> <span class="token class-name"><span class="token class-name">BaseTable</span></span> <span class="token keyword"><span class="token keyword">implements</span></span> <span class="token class-name"><span class="token class-name">TableOperations</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>

    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">Shares</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">SQLException</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">super</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"shares"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token annotation punctuation"><span class="token annotation punctuation">@Override</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">createTable</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">SQLException</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">super</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">executeSqlStatement</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"CREATE TABLE shares("</span></span> <span class="token operator"><span class="token operator">+</span></span>
                <span class="token string"><span class="token string">"id BIGINT AUTO_INCREMENT PRIMARY KEY,"</span></span> <span class="token operator"><span class="token operator">+</span></span>
                <span class="token string"><span class="token string">"name VARCHAR(255) NOT NULL,"</span></span> <span class="token operator"><span class="token operator">+</span></span>
                <span class="token string"><span class="token string">"startPrice DECIMAL(15,2) NOT NULL DEFAULT 10,"</span></span> <span class="token operator"><span class="token operator">+</span></span>
                <span class="token string"><span class="token string">"changeProbability INTEGER NOT NULL DEFAULT 25,"</span></span><span class="token operator"><span class="token operator">+</span></span>
                <span class="token string"><span class="token string">"delta INTEGER NOT NULL DEFAULT 15)"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token string"><span class="token string">"Создана таблиця "</span></span> <span class="token operator"><span class="token operator">+</span></span> tableName<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token annotation punctuation"><span class="token annotation punctuation">@Override</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">createForeignKeys</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">SQLException</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token annotation punctuation"><span class="token annotation punctuation">@Override</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">createExtraConstraints</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">SQLException</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">super</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">executeSqlStatement</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>
                <span class="token string"><span class="token string">" ALTER TABLE shares ADD CONSTRAINT check_shares_delta CHECK(delta &lt;= 100 and delta &gt; 0)"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span>
                <span class="token string"><span class="token string">"Cоздано ограничение для shares, поле delta = [1,100]"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token keyword"><span class="token keyword">super</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">executeSqlStatement</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>
                <span class="token string"><span class="token string">" ALTER TABLE shares ADD CONSTRAINT check_shares_changeProbability "</span></span> <span class="token operator"><span class="token operator">+</span></span>
                        <span class="token string"><span class="token string">"CHECK(changeProbability &lt;= 100 and changeProbability &gt; 0)"</span></span><span class="token punctuation"><span class="token punctuation">,</span></span>
                <span class="token string"><span class="token string">"Cоздано ограничение для shares, поле changeProbability = 1..100"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Лістинги інших репозиторіїв та батьківського класу доступні за посиланням на github-репозиторій наприкінці статті. Зрозуміло, можна зробити інший дизайн програми або ретельніший рефакторинг програми: винести спільні частини в батьківський клас, виділити загальні методи і так далі. Але основна мета циклу статей – безпосередня робота з базою даних, так що за бажання дизайн програми тощо, ви можете виконати самостійно. Поточна структура проекту: <img data-id="071a4f82-c42a-467a-a7c5-942b4db3b868" data-max-width="300" alt="Частина 3. Створюємо скелет нашої бази, перші SQL команди з прикладів java.sql.  - 6" src="https://cdn.javarush.com/images/article/071a4f82-c42a-467a-a7c5-942b4db3b868/256.jpeg" style="width: 300px;"> Окрім репозиторіїв та моделей, ми додатково створабо клас <code class=" language-none">StockExchangeDB</code>для загального управління нашою емуляцією. На цьому етапі ми керуємо репозиторіями (у наступних частинах перейдемо на послуги). Оголошуємо їх, запускаємо створення таблиць: 
<pre class=" line-numbers  language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class="  language-java"><span class="token keyword"><span class="token keyword">package</span></span> <span class="token namespace"><span class="token namespace">sql<span class="token punctuation"><span class="token punctuation">.</span></span>demo</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">org<span class="token punctuation"><span class="token punctuation">.</span></span>h2<span class="token punctuation"><span class="token punctuation">.</span></span>tools<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token class-name"><span class="token class-name">DeleteDbFiles</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">sql<span class="token punctuation"><span class="token punctuation">.</span></span>demo<span class="token punctuation"><span class="token punctuation">.</span></span>repository<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token operator"><span class="token operator">*</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
<span class="token keyword"><span class="token keyword">import</span></span> <span class="token namespace"><span class="token namespace">java<span class="token punctuation"><span class="token punctuation">.</span></span>sql<span class="token punctuation"><span class="token punctuation">.</span></span></span><span class="token punctuation"></span></span><span class="token operator"><span class="token operator">*</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

<span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">class</span></span> <span class="token class-name"><span class="token class-name">StockExchangeDB</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
    <span class="token comment"><span class="token comment">// Блок объявления констант</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token class-name"><span class="token class-name">String</span></span> DB_DIR <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"c:/JavaPrj/SQLDemo/db"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token class-name"><span class="token class-name">String</span></span> DB_FILE <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"stockExchange"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token class-name"><span class="token class-name">String</span></span> DB_URL <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"jdbc:h2:/"</span></span> <span class="token operator"><span class="token operator">+</span></span> DB_DIR <span class="token operator"><span class="token operator">+</span></span> <span class="token string"><span class="token string">"/"</span></span> <span class="token operator"><span class="token operator">+</span></span> DB_FILE<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">final</span></span> <span class="token class-name"><span class="token class-name">String</span></span> <span class="token class-name"><span class="token class-name">DB_Driver</span></span> <span class="token operator"><span class="token operator">=</span></span> <span class="token string"><span class="token string">"org.h2.Driver"</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>

    <span class="token comment"><span class="token comment">// Таблицы СУБД</span></span>
    <span class="token class-name"><span class="token class-name">Traiders</span></span> traiders<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">ShareRates</span></span> shareRates<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">Shares</span></span> shares<span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token class-name"><span class="token class-name">TraiderShareActions</span></span> traiderShareActions<span class="token punctuation"><span class="token punctuation">;</span></span>

    <span class="token comment"><span class="token comment">// Получить новое соединение с БД</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token class-name"><span class="token class-name">Connection</span></span> <span class="token function"><span class="token function">getConnection</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">SQLException</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">return</span></span> <span class="token class-name"><span class="token class-name">DriverManager</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">getConnection</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>DB_URL<span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token comment"><span class="token comment">// Инициализация</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">StockExchangeDB</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token keyword"><span class="token keyword">boolean</span></span> renew<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">SQLException</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">ClassNotFoundException</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">if</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span>renew<span class="token punctuation"><span class="token punctuation">)</span></span>
            <span class="token class-name"><span class="token class-name">DeleteDbFiles</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">execute</span></span><span class="token punctuation"><span class="token punctuation">(</span></span>DB_DIR<span class="token punctuation"><span class="token punctuation">,</span></span> DB_FILE<span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token boolean"><span class="token boolean">false</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token class-name"><span class="token class-name">Class</span></span><span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">forName</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">DB_Driver</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token comment"><span class="token comment">// Инициализируем таблицы</span></span>
        traiders <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Traiders</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        shares <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">Shares</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        shareRates <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">ShareRates</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        traiderShareActions <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">TraiderShareActions</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token comment"><span class="token comment">// Инициализация по умолчанию, без удаления файлу БД</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token class-name"><span class="token class-name">StockExchangeDB</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">SQLException</span></span><span class="token punctuation"><span class="token punctuation">,</span></span> <span class="token class-name"><span class="token class-name">ClassNotFoundException</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">this</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token boolean"><span class="token boolean">false</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>

    <span class="token comment"><span class="token comment">// створення всех таблиц и внешних ключей</span></span>
    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">createTablesAndForeignKeys</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token keyword"><span class="token keyword">throws</span></span> <span class="token class-name"><span class="token class-name">SQLException</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        shares<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createTable</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        shareRates<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createTable</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        traiders<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createTable</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        traiderShareActions<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createTable</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token comment"><span class="token comment">// створення ограничений на поля таблиц</span></span>
        traiderShareActions<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createExtraConstraints</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        shares<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createExtraConstraints</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token comment"><span class="token comment">// створення внешних ключей (связи между таблицями)</span></span>
        shareRates<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createForeignKeys</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        traiderShareActions<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createForeignKeys</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>


    <span class="token keyword"><span class="token keyword">public</span></span> <span class="token keyword"><span class="token keyword">static</span></span> <span class="token keyword"><span class="token keyword">void</span></span> <span class="token function"><span class="token function">main</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">String</span></span><span class="token punctuation"><span class="token punctuation">[</span></span><span class="token punctuation"><span class="token punctuation">]</span></span> args<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
        <span class="token keyword"><span class="token keyword">try</span></span><span class="token punctuation"><span class="token punctuation">{</span></span>
            <span class="token class-name"><span class="token class-name">StockExchangeDB</span></span> stockExchangeDB <span class="token operator"><span class="token operator">=</span></span> <span class="token keyword"><span class="token keyword">new</span></span> <span class="token class-name"><span class="token class-name">StockExchangeDB</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token boolean"><span class="token boolean">true</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
            stockExchangeDB<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">createTablesAndForeignKeys</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token punctuation"><span class="token punctuation">}</span></span> <span class="token keyword"><span class="token keyword">catch</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">SQLException</span></span> e<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
            e<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">printStackTrace</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
            <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"Ошибка SQL !"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token punctuation"><span class="token punctuation">}</span></span> <span class="token keyword"><span class="token keyword">catch</span></span> <span class="token punctuation"><span class="token punctuation">(</span></span><span class="token class-name"><span class="token class-name">ClassNotFoundException</span></span> e<span class="token punctuation"><span class="token punctuation">)</span></span> <span class="token punctuation"><span class="token punctuation">{</span></span>
            <span class="token class-name"><span class="token class-name">System</span></span><span class="token punctuation"><span class="token punctuation">.</span></span>out<span class="token punctuation"><span class="token punctuation">.</span></span><span class="token function"><span class="token function">println</span></span><span class="token punctuation"><span class="token punctuation">(</span></span><span class="token string"><span class="token string">"JDBC драйвер для СУБД не найден!"</span></span><span class="token punctuation"><span class="token punctuation">)</span></span><span class="token punctuation"><span class="token punctuation">;</span></span>
        <span class="token punctuation"><span class="token punctuation">}</span></span>
    <span class="token punctuation"><span class="token punctuation">}</span></span>
<span class="token punctuation"><span class="token punctuation">}</span></span></code></pre> Результат виконання: <img data-id="a4458135-c0fc-495d-9d16-d9d01885b8d1" data-max-width="550" alt="Частина 3. Створюємо скелет нашої бази, перші SQL команди з прикладів java.sql.  - 7" src="https://cdn.javarush.com/images/article/a4458135-c0fc-495d-9d16-d9d01885b8d1/512.jpeg" style="width: 550px;">
<h3>Резюме</h3>У <a href="https://codegym.cc/groups/posts/1970-chastjh-2-struktura-subd-tablicih-i-tipih-dannihkh-sozdaem-skelet-nashey-bazih-pervihe-sql-koma" target="_blank">другій</a> та третій частині статті ми дізналися: 
<ul>
 <li>Типи даних SQL.</li>
 <li>Таблиці БД.</li>
 <li>Проектування БД: структур таблиць та відносин між ними.</li>
 <li>Мова запитів SQL у частині створення таблиць БД, встановлення обмежень на поля та зв'язків між таблицями.</li>
 <li>Більше про взаємодію з JDBC.</li>
 <li>Триланкова (тришарова) Model/Repository/Service архітектура програми роботи з даними.</li>
</ul>
<h3>Корисні посилання</h3>
<ul>
 <li><a href="http://www.h2database.com/h2.pdf" rel="nofollow" target="_blank">H2 Database Engine (English)</a> ;</li>
 <li><a href="http://www.h2database.com/html/grammar.html" rel="nofollow" target="_blank">Опис команд SQL (English)</a> ;</li>
 <li><a href="http://www.h2database.com/html/datatypes.html" rel="nofollow" target="_blank">Типи даних H2(English)</a> ;</li>
 <li><a href="https://www.drupal.org/docs/develop/coding-standards/list-of-sql-reserved-words" rel="nofollow" target="_blank">Список зарезервованих слів SQL</a> ;</li>
 <li>Книга " <a href="https://www.sql.ru/docs/sql/u_sql/index.shtml" rel="nofollow" target="_blank">Розуміння SQL (Understanding SQL)</a> " Мартіна Грабера;</li>
 <li><a href="https://www.ibm.com/developerworks/ru/library/j-jtp0114/index.html" rel="nofollow" target="_blank">Основи роботи з BigDecimal</a> ;</li>
 <li><a href="https://github.com/SadykovMR/jdbc-start/tree/26180844f31928c7fcda610f3b4e5c0245a4a9f2" rel="nofollow" target="_blank">GitHub репозиторій</a></li>
</ul>