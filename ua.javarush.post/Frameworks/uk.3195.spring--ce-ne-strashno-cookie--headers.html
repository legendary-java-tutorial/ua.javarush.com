Spring – це не страшно. Cookie & Headers
<p>----------------------------------------</p>
Повторення – мати вчення! Тому, на підставі минулих статей, давайте створимо новий web spring-boot-проект: MobilePhonePayment (Оплата мобільного телефону) Підключіть h2, Lombok. Створіть шар сутностей: Створіть шар сервісів з методами: - по
<p>----------------------------------------</p>
<a href="https://codegym.cc/groups/posts/3092-spring-ehto-nestrashno" target="_blank" rel="nofollow"><strong>ЗМІСТ ЦИКЛУ СТАТТІВ</strong></a> Повторення – мати вчення! Тому, на підставі минулих статей, давайте створимо новий web spring-boot-проект: MobilePhonePayment (Оплата мобільного телефону) Підключіть h2, Lombok. Створіть шар сутностей: <em> BalancePhoneEntity Integer id; Integer numberPhone; String nameCustomer; Integer balance; </em> Створіть шар сервісів з методами: - пошук усіх записів у базі - пошук запису по id - пошук запису за номером телефону - пошук запису на ім'я користувача (повинен повертати лист записів, імена можу і збігатися) 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BalanceEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByNameCustomer</span><span class="token punctuation">(</span><span class="token class-name">String</span> nameCustomer<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> balanceRepository<span class="token punctuation">.</span><span class="token function">findAllByNameCustomer</span><span class="token punctuation">(</span>nameCustomer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> - Додавання запису до бази - Видалення запису з бази за id - Бізнесовий метод: Поповнення балансу телефону – метод повинен приймати номер телефону, суму (тип Integer) та збільшувати баланс відповідного номера на вказану суму. 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addingMoneyToBalance</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> phoneNumber<span class="token punctuation">,</span> <span class="token class-name">Integer</span> sum<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">BalanceDto</span> byPhoneNumber <span class="token operator">=</span> <span class="token function">findByPhoneNumber</span><span class="token punctuation">(</span>phoneNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
    byPhoneNumber<span class="token punctuation">.</span><span class="token function">setBalance</span><span class="token punctuation">(</span>byPhoneNumber<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">save</span><span class="token punctuation">(</span>byPhoneNumber<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//метод save() – добавление, реализован в сервисе</span>
<span class="token punctuation">}</span></code></pre> Не забудьте реалізувати мапінг з DTO до Entity і назад. Dto буде аналогічним до Entity: <em>BalancePhoneDto Integer id; Integer numberPhone; String nameCustomer; Integer balance; </em> Создайте слой DTO, создайте класс InitiateUtils и наполните базу данными: <em>id 1, numberPhone 555000, balance 100, customer Іван id 2, numberPhone 444000, balance 250, customer Марья id 3, numberPhone 111000, balance 60, customer Іван</em> Создайте рест-контроллер, але не поспішайте наповнювати його методами. Якщо слідувати минулій статті, то метод виведення всіх записів повинен був вийти приблизно так (рекомендую зараз подивитися в коментарі до статті - конкретно на коментар Василя Бабіна): 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//поиск записи по id - старая версія</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/find-phone/{id}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BalanceDto</span><span class="token punctuation">&gt;</span></span> <span class="token function">findPhone</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">BalanceDto</span> balanceDto <span class="token operator">=</span> balanceService<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> balanceDto <span class="token operator">!=</span> <span class="token keyword">null</span>
            <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>balanceDto<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>OK<span class="token punctuation">)</span>
            <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>NOT_FOUND<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Є інший спосіб використання ResponseEntity без використання конструктора. Його ми і далі використовуватимемо. ResponseEntity надає два вкладені інтерфейси компонувальника: HeadersBuilder та його підінтерфейс, BodyBuilder. Отже, ми можемо отримати доступ до їх можливостей за допомогою статичних методів ResponseEntity. Почитати більше можна <a href="https://www.codeflow.site/ru/article/spring-response-entity" target="_blank" rel="nofollow">в цій статті</a> . Методи рест-контролера можна реалізувати так: 1) Виведення запису по id 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//поиск записи по id</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/find-number-phoneById/{id}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">findNumberPhoneById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">BalanceDto</span> balanceDto <span class="token operator">=</span> balanceService<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> balanceDto <span class="token operator">!=</span> <span class="token keyword">null</span>
            <span class="token operator">?</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>balanceDto<span class="token punctuation">)</span>
            <span class="token operator">:</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>NOT_FOUND<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Тестуємо в Postman (Про нього говорабо у минулій статті, ось ще <a href="https://losst.ru/kak-polzovatsya-postman#2_%D0%9F%D0%B5%D1%80%D0%B5%D0%B4%D0%B0%D1%87%D0%B0_%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D0%BE%D0%B2" target="_blank" rel="nofollow">невеликий гайд за цією програмою</a> ). Запускаємо, вибираємо тип запиту GET, у рядку URL пишемо: http://localhost:8080/find-number-phoneById/1 – параметр id ми передали у рядку запиту, на виведенні отримаємо запис з id рівним 1. Після додавання нового коду, не забуваємо перезапускати проект😇 2) Виведення записів на ім'я 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//поиск записи по имени пользователя</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/find-number-phoneByName/{name}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">findNumberPhone</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BalanceDto</span><span class="token punctuation">&gt;</span></span> balanceDto <span class="token operator">=</span> balanceService<span class="token punctuation">.</span><span class="token function">findByNameCustomer</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> balanceDto <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span>  <span class="token operator">!</span>balanceDto<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token operator">?</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>balanceDto<span class="token punctuation">)</span>
            <span class="token operator">:</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>NOT_FOUND<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Створимо новий запит, вибираємо тип запиту GET, у рядку URL пишемо: http://localhost:8080/ find-number-phoneByName/Іван – параметр name ми передали у рядку запиту, на виведенні отримаємо лист записів із nameCustomer рівним Іван. Можливо на висновку ви отримаєте щось схоже на це: %D1%8D%D1%82%D0%BE%20%D0%BD%D0%B5%20%D0%BE%D1%88%D0%B8%D0% B1%D0%BA%D0%B0 Це не помилка - це особливості кодування запитів, <a href="https://www.design-sites.ru/utility/url-encoding.php" target="_blank" rel="nofollow">почитайте про це</a> . А ось тут написано <a href="https://ru.stackoverflow.com/questions/564068/postman-%D0%BF%D0%B5%D1%80%D0%B5%D1%81%D1%82%D0%B0%D0%BB-%D0%BD%D0%BE%D1%80%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE-%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D1%82%D1%8C-%D0%BA%D0%BE%D0%B4%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D1%83" target="_blank" rel="nofollow">як налаштувати Postman щоб цього не відбувалося. </a> 3) Виведення всіх записів: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//поиск всех записей</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/findAll"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BalanceDto</span><span class="token punctuation">&gt;</span></span> balanceDto <span class="token operator">=</span> balanceService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> balanceDto <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span>  <span class="token operator">!</span>balanceDto<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token operator">?</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>balanceDto<span class="token punctuation">)</span>
            <span class="token operator">:</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>NOT_FOUND<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Створюємо новий запит, вибираємо тип запиту GET, у рядку URL пишемо: http://localhost:8080/findAll – параметрів тут жодних не передаємо. 4) Додавання нового запису: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//добавление новой записи</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/entry"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">entryNumber</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">BalanceDto</span> dto<span class="token punctuation">)</span><span class="token punctuation">{</span>
    balanceService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>CREATED<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Створюємо новий запит, вибираємо тип запиту POST, у рядку URL пишемо: http://localhost:8080/entry. У цьому запиті нам потрібно передати об'єкт у форматі JSON. У вікні запиту переходимо на вкладку Body, встановлюємо прапор на raw, поруч із Text натискаємо стрілку та вибираємо JSON. У вікно копіюємо наступний JSON: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token punctuation">{</span>
        <span class="token string">"numberPhone"</span><span class="token operator">:</span> <span class="token number">767676</span><span class="token punctuation">,</span>
        <span class="token string">"nameCustomer"</span><span class="token operator">:</span> <span class="token string">"Саша"</span><span class="token punctuation">,</span>
        <span class="token string">"balance"</span><span class="token operator">:</span> <span class="token number">100</span>
<span class="token punctuation">}</span></code></pre> Натискаємо виконати запит у відповіді приходить статус CREATED. Тепер зробіть ще раз запит на findAll і переконайтеся, що з'явився новий запис. 5) Видалення запису з id 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//удаление записи по id</span>
<span class="token annotation punctuation">@DeleteMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/delete-phoneById/{id}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    balanceService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Створюємо новий запит, вибираємо тип запиту DELETE, у рядку URL пишемо: http://localhost:8080/delete-phoneById/4 – параметр id ми передали у рядку запиту, На виводі отримаємо статус OK. Тепер зробіть ще раз запит на findAll і переконайтеся, що Сашко зник. 6) Зміна номера за id 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//изменение номера телефона по id</span>
<span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/change"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">changeNumberPhone</span><span class="token punctuation">(</span>
<span class="token comment">//можно добавлять несколько параметров в запит</span>
        <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">,</span> <span class="token comment">//добавабо один параметр</span>
        <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"phoneNumber"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> phoneNumber<span class="token punctuation">)</span> <span class="token comment">//добавабо второй параметр</span>
 <span class="token punctuation">{</span>
    <span class="token class-name">BalanceDto</span> byId <span class="token operator">=</span> balanceService<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    byId<span class="token punctuation">.</span><span class="token function">setNumberPhone</span><span class="token punctuation">(</span>phoneNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
    balanceService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>byId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Створюємо новий запит, вибираємо тип запиту PUT, у рядку URL пишемо: http://localhost:8080/change . У цьому запиті кілька параметрів, і ми їх, як бачите, не передаємо в рядку запиту як раніше. Для параметрів у методі використовується інструкція @RequestParam. Щоб передати параметри через Postman, необхідно у вікні запиту перейти на вкладку Params, в колонці Key вказуємо найменування параметра (id), в колонці Value вказуємо значення (1). З другим параметром чинимо так само, Key = phoneNumber, Value = 888000. Зверніть увагу на рядок запиту, Postman змінив його щоб передати параметри правильно. На виводі отримаємо статус OK. Тепер зробіть ще раз запит на findAll і переконайтеся, що номер телефону перший запис змінився. 7) Поповнення балансу телефону 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/add"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">addingMoney</span><span class="token punctuation">(</span>
        <span class="token comment">//можно добавлять несколько параемров в запит</span>
        <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"phoneNumber"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> phoneNumber<span class="token punctuation">,</span><span class="token comment">//добавабо один параметр</span>
        <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"sum"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> sum<span class="token punctuation">)</span> <span class="token comment">//добавабо второй параметр</span>
<span class="token punctuation">{</span>
    balanceService<span class="token punctuation">.</span><span class="token function">addingMoneyToBalance</span><span class="token punctuation">(</span>phoneNumber<span class="token punctuation">,</span> sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Створюємо новий запит, вибираємо тип запиту PUT, у рядку URL пишемо: http://localhost:8080/add. Значення phoneNumber ставимо рівним 888 000, sum рівним 130. На виведенні отримаємо статус OK. Тепер зробіть ще раз запит на findAll і переконайтеся, що баланс першого запису змінився. 8) PUT через тіло запиту - так робити краще, щоб не відкривати передані дані 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/add"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">addingMoney</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">BalanceDto</span> dto<span class="token punctuation">)</span><span class="token punctuation">{</span>
    balanceService<span class="token punctuation">.</span><span class="token function">addingMoneyToBalance</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span>getPhoneNumber<span class="token punctuation">,</span> dto<span class="token punctuation">.</span>getSum<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Передаємо JSON 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token punctuation">{</span>
        <span class="token string">"numberPhone"</span><span class="token operator">:</span> <span class="token number">888000</span><span class="token punctuation">,</span>
       <span class="token comment">//  "nameCustomer" можно вообще не указывать</span>
        <span class="token string">"balance"</span><span class="token operator">:</span> <span class="token number">130</span>
<span class="token punctuation">}</span></code></pre><strong>Нарешті переходимо до Cookie. </strong> Що таке <a href="https://browser.yandex.ru/help/personal-data-protection/cookies.html" target="_blank" rel="nofollow">Cookie</a> . Просто кажучи: Cookie зберігають дані, отримані один раз браузером від програми, які потім можна використовувати багато разів на сайті. Потрібно знати дві базові речі: як записати та як прочитати Cookie. <em>Як записати:</em> Весь Spring Web MVC реалізований поверх Servlet API, який побудований навколо двох об'єктів - запит від клієнта обертається в HttpSerlvetRequest, а відповідь формується із заповненого вашим кодом HttpServletResponse. Маючи доступ до цих об'єктів, ви отримуєте повний контроль над усією HTTP сесією. Spring web дозволяє звертатися до цих об'єктів безпосередньо. Зазвичай Cookie створимо в контролері метод 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//записать куки</span>
 <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/set-cookie"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">setCookie</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
     <span class="token class-name">Cookie</span> cookie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cookie</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"Come_to_the_dark_side"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//создаем об'єкт Cookie,</span>
     <span class="token comment">//в конструкторе указываем значения для name и value</span>
     cookie<span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//устанавливаем путь</span>
     cookie<span class="token punctuation">.</span><span class="token function">setMaxAge</span><span class="token punctuation">(</span><span class="token number">86400</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//здесь устанавливается время жизни куки</span>
     response<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//добавляем Cookie в запит</span>
     response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/plain"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//устанавливаем контекст</span>
     <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//получилось як бы два раза статус ответа установабо, выбирайте якой вариант лучше</span>
 <span class="token punctuation">}</span></code></pre> Зробимо GET запит у Postman на адресау: http://localhost:8080/set-cookie на виході отримаємо OK. Над океєм знайдіть напис Cookie(1), перейшовши ним ви побачите ті Cookie що ми передали. Ім'я: data, значення: Come_to_the_dark_side. Інформація щодо основних можливостей класу <a href="http://espressocode.top/javax-servlet-http-cookie-class-java/" target="_blank" rel="nofollow">Cookie в java. </a> <em>Як прочитати:</em> Прочитати ще легше 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//прочитать куки</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/get-cookie"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">readCookie</span><span class="token punctuation">(</span><span class="token annotation punctuation">@CookieValue</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"data"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> У @ CookieValue вказуємо ім'я Cookie, значення яких будемо зчитувати, та виводимо прочитане значення у відповіді. <em>Come_to_the_dark_side </em> <strong>Тепер настав зоряний час Header</strong> ( <a href="https://code.tutsplus.com/ru/tutorials/http-headers-for-dummies--net-8039" target="_blank" rel="nofollow">заголовків</a> , не дивіться що стаття про PHP), почитати досить корисно : Для початку подивимося, як можна прочитати заголовки: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//прочитать заголовки</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/get-headers"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestHeader</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> headers<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//представляет заголовки ввиде мапы,</span>
    <span class="token comment">//где ключ это наименование заголовка, а значення мапы - это значення заголовка</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Основну роботу перебирає <em>@RequestHeader Map&lt;String, String&gt;</em> , він представляє заголовки як карти, де ключ це найменування заголовка, а значення карти - це значення заголовка. Тестувати цей метод цікавіше за допомогою браузера, відкриваємо браузер, набираємо в пошуковому рядку http://localhost:8080/get-headers, на виході отримуємо список заголовків. Погуглить про кожен заголовок, щоб зрозуміти, навіщо вони потрібні. <a href="https://ru.wikipedia.org/wiki/%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%B7%D0%B0%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BA%D0%BE%D0%B2_HTTP" target="_blank" rel="nofollow">Вікіпедія</a> також пропонує список заголовків. <em>«Якщо хтось щось прочитав, то це хтось записав» - старовинна програмістська приказка. </em> Давайте запишемо заголовок 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//записать заголовок</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/set-header"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"name-header"</span><span class="token punctuation">,</span><span class="token string">"value-header"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Тут ми використовували спеціальний метод <em>header</em> класу <em>ResponseEntity</em> . Де "name-header" - це назва заголовка, а "value-header" - це значення заголовка. Є й інші варіанти роботи із заголовками 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//еще варианты работы с заголовками</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/set-headers"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">setHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">HttpHeaders</span> httpHeaders <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//создаем об'єкт</span>
    <span class="token comment">//который имплементирует мапу MultiValueMap&lt;String, String&gt;</span>
    <span class="token comment">//наполняем ее парами ключ-значення</span>
    <span class="token comment">//можно наполнить своими заголовками через метод add</span>
    httpHeaders<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"customer-header"</span><span class="token punctuation">,</span> <span class="token string">"value-header1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//HttpHeaders так же предлагает большой выбор стандартных заголовков</span>
    <span class="token comment">//Посмотрите на них набрав в IDEA HttpHeaders.</span>
    httpHeaders<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">HttpHeaders</span><span class="token punctuation">.</span>FROM<span class="token punctuation">,</span> <span class="token string">"russia"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//можно изменить существующий заголовок, вызвав для него сет-метод</span>
    httpHeaders<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//або получить значення конкретного заголовка</span>
    <span class="token class-name">Long</span> date <span class="token operator">=</span> httpHeaders<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span>
            <span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">headers</span><span class="token punctuation">(</span>httpHeaders<span class="token punctuation">)</span><span class="token comment">//здесь метод принимающий MultiValueMap&lt;String, String&gt;</span>
            <span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Тут використовується вже інший метод класу <em>ResponseEntity,</em> який набуває значення типу <em>MultiValueMap&lt;String, String&gt;</em> . Перевірити як це працює, також інформативніше буде у браузері. Переходимо на адресау http://localhost:8080/set-headers, отримуємо відповідь, що статус ОК. Якщо ви молодець і використовуєте гугл хром, то натисніть клавіші <em>Ctrl + Shift + I</em> і переходьте в «Інструменти розробника», далі шукайте у верхній панелі вкладку <em>Network</em> , натиснувши її шукайте запис: <em>set-headers</em> (якщо її немає оновіть сторінку) натискаємо на її і у вікні вибираємо вкладку <em>Headers</em> і в <em>ResponseHeaders</em>бачимо наші заголовки. Для знайомства із заголовками поки що достатньо. А тепер прочитайте: <a href="https://habr.com/ru/post/675716/" target="_blank" rel="nofollow">Вивчаємо ResponseEntity&lt;!--?--&gt; і позбавляємося його в контролерах Spring</a> На цьому дозвольте відкланятися 🤓, до нових зустрічей…