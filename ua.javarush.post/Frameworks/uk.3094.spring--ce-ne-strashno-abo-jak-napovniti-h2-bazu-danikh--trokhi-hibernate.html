Spring – це не страшно, або як наповнити h2 базу даних (і трохи Hibernate)
<p>----------------------------------------</p>
Продовжуємо наш проект. Як створити Підключаємо . Цього разу літер буде більше, п'ять хвилин не обійдемося. У минулій статті я радив почитати про Spring або кілька , або хоча б про що таке біни, контекст, сутності, впровадження залежностей 
<p>----------------------------------------</p>
<a href="https://codegym.cc/groups/posts/3092-spring-ehto-nestrashno" target="_blank" rel="nofollow"><strong>ЗМІСТ ЦИКЛУ СТАТТІВ</strong></a> Продовжуємо наш проект. Як створити<a href="https://codegym.cc/groups/posts/3092-spring-ehto-nestrashno" target="_blank" rel="nofollow"> веб-проект. </a> Підключаємо<a href="https://codegym.cc/groups/posts/3093-spring-ehto-nestrashno-ili-kak-podkljuchitjh-bazu-dannihkh-dlja-studencheskogo-proekta-za-5-min" target="_blank" rel="nofollow"> базу до свого веб-проекту</a> . Цього разу літер буде більше, п'ять хвабон не обійдемося. У минулій статті я радив почитати про Spring <a href="https://beginner-mercenary.blogspot.com/" target="_blank" rel="nofollow"> кілька сторінок</a> або кілька<a href="https://codegym.cc/groups/posts/spring-framework-java-1" target="_blank" rel="nofollow"> статей</a> , або хоча б<a href="https://codegym.cc/groups/posts/1763-36-urovenjh---tozhe-ne-nashjel-otvetih-na-voprosih-iz-sobesedovaniy" target="_blank" rel="nofollow"> погуглити</a> про що таке біни, контекст, сутності, впровадження залежностей у spring, способи конфігурації бінів. Якщо ні, то раджу це зробити одразу зараз чи після цієї статті. Перед тим як заповнювати нашу h2 базу. Необхідно створити клас утиліту для запуску в ній методів заповнення бази. У пакеті
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush</code></pre> Створюємо пакет для утиліт 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java">utils</code></pre> І саму утиліту: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">CommandLineRunner</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span> <span class="token comment">//анотація помечает бин як сервис</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InitiateUtils</span> <span class="token keyword">implements</span> <span class="token class-name">CommandLineRunner</span> <span class="token punctuation">{</span> <span class="token comment">//имплементируем интерфейс CommandLineRunner (командная строка запуска)</span>

    <span class="token annotation punctuation">@Override</span>
<span class="token comment">//переопределяем метод который позволит</span>
<span class="token comment">//нам выполнять методы нашего програми при запуске</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"run"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//проверим что это работает</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Запустимо програму і в консоль виведеться <em>"run"</em> . Нам потрібна ця утиліта, як альтернатива класу Applications, оскільки він повинен відповідати тільки за запуск програми. Створимо сутності. Сутність – це бін, мета якого зберігати деякі дані. У пакеті
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush</code></pre> Створюємо пакет для сутностей 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java">entities</code></pre> І саму сутність, нехай це буде фрукти: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>entities</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">GenericGenerator</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Entity</span><span class="token comment">//помечаем бин як сущность</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"fruit_table"</span><span class="token punctuation">)</span><span class="token comment">//в этой аннотации можно указать ім'я создаваемой таблицы</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FruitEntity</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span><span class="token comment">//анотація из пакета avax.persistence.*, помечает поле як id</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"id_fruit"</span><span class="token punctuation">)</span><span class="token comment">//в этой аннотации можно указать ім'я поля</span>
    <span class="token annotation punctuation">@GenericGenerator</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"generator"</span><span class="token punctuation">,</span> strategy <span class="token operator">=</span> <span class="token string">"increment"</span><span class="token punctuation">)</span><span class="token comment">//незаметно добрались до hibernate,</span>
<span class="token comment">// здесь указывается что id будет автоматически увеличиваться при новых записях</span>
    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>generator <span class="token operator">=</span> <span class="token string">"generator"</span><span class="token punctuation">)</span><span class="token comment">//анотація генерации id</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"fruit_name"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> fruitName<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"provider_code"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> providerCode<span class="token punctuation">;</span>

   <span class="token comment">//что бы в с классом можно было совершать манипуляции создается</span>
  <span class="token comment">//пустой конструктор, геттеры, сеттеры и переопределяется метод toString()</span>

  <span class="token keyword">public</span> <span class="token class-name">FruitEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//пустой конструктор</span>

 <span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> id<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

 <span class="token comment">//геттеры, сеттеры</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getFruitName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fruitName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">FruitEntity</span> <span class="token function">setFruitName</span><span class="token punctuation">(</span><span class="token class-name">String</span> fruitName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fruitName <span class="token operator">=</span> fruitName<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getProviderCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> providerCode<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">FruitEntity</span> <span class="token function">setProviderCode</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> providerCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>providerCode <span class="token operator">=</span> providerCode<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//переопределяем toString()</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"FruitEntity{"</span> <span class="token operator">+</span>
            <span class="token string">"id="</span> <span class="token operator">+</span> id <span class="token operator">+</span>
            <span class="token string">", fruitName='"</span> <span class="token operator">+</span> fruitName <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
            <span class="token string">", providerCode="</span> <span class="token operator">+</span> providerCode <span class="token operator">+</span>
            <span class="token string">'}'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Конструктор, геттери, сеттери і toString() не обов'язково писати руками, можна швидко <a href="https://fooobar.com/questions/31217/how-to-automatically-generate-getters-and-setters-in-android-studio" target="_blank" rel="nofollow">нагенерувати</a> . Гаразд, сутність у нас взаємодіє з базою і зберігає дані з БД. Сутність при справі. Але хтось має оперувати сутністю в додатку. Для цього вигадали "репозиторій". У пакеті
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush</code></pre> Створюємо пакет для репозиторіїв 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java">repositories</code></pre> І сам репозиторій 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>repositories</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">JpaRepository</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Repository</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">FruitEntity</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Repository</span><span class="token comment">//помечаем что этот бин - репозиторий</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">FruitRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FruitEntity</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token comment">//репозиторий является интерфейсом, который наследуется от другого интерфейса JpaRepository&lt;&gt;</span>
<span class="token comment">//для него необходимо указать с якой сущность он должен работать, у нас это FruitEntity</span>
<span class="token comment">//и тип данных у поля id данной сущности, у нас это Integer</span>
<span class="token punctuation">}</span></code></pre> Питання, чому тіло інтерфейсу порожнє, немає жодного методу, що він оголошує? Для відповіді затиснемо Ctrl і клікнемо на JpaRepository і подивимося що він і сам успадковується від PagingAndSortingRepository&lt;t, ""&gt; і QueryByExampleExecutor&lt;&gt;, вони теж оголошують якісь методи. Не буду сюди копіювати методи самі по дивіться. Оскільки репозиторій це інтерфейс, він ні чого не робить, він тільки оголошує методи, необхідний ще хтось, щоб ці методи реалізувати. Для цього придумано "сервіс". У пакеті
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush</code></pre> Створюємо пакет для сервісів 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java">services</code></pre> І сам сервіс 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>services</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span><span class="token comment">//помечаем что этот бин - сервис</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FruitService</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre> Зараз ми дійшли до важливого моменту: "Як і навіщо заінжектити бін" (впровадити залежність). Якщо ви не розумієте про що це я, то прошу вас почитати на цю тему, зараз чи після, особливо зверніть увагу на способи "інжекта", скільки їх, який краще, який гірший, і чому. Ми використовуємо один із способів. Нам потрібно щоб "сервіс" як то був пов'язаний з "репозиторієм". Доповнюємо наш сервіс анотацією та змінною. 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>services</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>repositories<span class="token punctuation">.</span></span><span class="token class-name">FruitRepository</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FruitService</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">FruitRepository</span> fruitRepository<span class="token punctuation">;</span>  <span class="token comment">//final переменная репозитория</span>

<span class="token keyword">public</span> <span class="token class-name">FruitService</span><span class="token punctuation">(</span><span class="token class-name">FruitRepository</span> fruitRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//внедрабо зависимость через конструктор</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fruitRepository <span class="token operator">=</span> fruitRepository<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre> Тепер можна реалізувати метод із "репозиторію" Доповнюємо "сервіс" 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>services</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">FruitEntity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>repositories<span class="token punctuation">.</span></span><span class="token class-name">FruitRepository</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FruitService</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">FruitRepository</span> fruitRepository<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token class-name">FruitService</span><span class="token punctuation">(</span><span class="token class-name">FruitRepository</span> fruitRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//внедабо зависимость</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fruitRepository <span class="token operator">=</span> fruitRepository<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//создали публичный метод (название любое может быть)</span>
<span class="token comment">//на вход принимает сущность и сохраняет ее в базу</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">FruitEntity</span> fruitEntity<span class="token punctuation">)</span><span class="token punctuation">{</span>
        fruitRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>fruitEntity<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//реализовали метод внедренного бина</span>
    <span class="token punctuation">}</span>

<span class="token comment">//возвращает лист всех сущностей из базы</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FruitEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token keyword">return</span> fruitRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//реализовали метод внедренного бина</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Залишилося тільки реалізувати це у нашій утиліті Переходимо до класу InitiateUtils 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">CommandLineRunner</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">FruitEntity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">FruitService</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InitiateUtils</span> <span class="token keyword">implements</span> <span class="token class-name">CommandLineRunner</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">FruitService</span> fruitService<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token class-name">InitiateUtils</span> <span class="token punctuation">(</span><span class="token class-name">FruitService</span> fruitService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//незабываем конструктор для внедрения</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span> fruitService <span class="token operator">=</span> fruitService<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

<span class="token comment">//создаем несколько сущностей фруктов, через сеттеры заполняем поля</span>
        <span class="token class-name">FruitEntity</span> fruitEntity1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FruitEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fruitEntity1<span class="token punctuation">.</span><span class="token function">setFruitName</span><span class="token punctuation">(</span><span class="token string">"fruit1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fruitEntity1<span class="token punctuation">.</span><span class="token function">setProviderCode</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">FruitEntity</span> fruitEntity2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FruitEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fruitEntity2<span class="token punctuation">.</span><span class="token function">setFruitName</span><span class="token punctuation">(</span><span class="token string">"fruit2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fruitEntity2<span class="token punctuation">.</span><span class="token function">setProviderCode</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">FruitEntity</span> fruitEntity3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FruitEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fruitEntity3<span class="token punctuation">.</span><span class="token function">setFruitName</span><span class="token punctuation">(</span><span class="token string">"fruit3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fruitEntity3<span class="token punctuation">.</span><span class="token function">setProviderCode</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//с помощью переменной сервиса вызываем методы сохранения в базу, по разу для одного об'єкта</span>
        fruitService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>fruitEntity1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        fruitService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>fruitEntity2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        fruitService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>fruitEntity3<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//здесь вытаскиваем базу обратно</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FruitEntity</span><span class="token punctuation">&gt;</span></span> all <span class="token operator">=</span> fruitService<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//и выводим что получилось</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">FruitEntity</span> entity <span class="token operator">:</span> all<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><em>Висновок у консоль: FruitEntity(id=1, fruitName=fruit1, providerCode=1) FruitEntity(id=2, fruitName=fruit2, providerCode=2) FruitEntity(id=3, fruitName=fruit3, providerCode=3</em> ) закінчити. "Секундочку!" - Вигукне найуважніший читач - "А де ж тут все-таки Hibernate?" А Hibernate виступає тут у ролі борця невидимого фронту, він зробив дуже важливу річ: створив нам структури БД. Ось коли ми в "сутності" написали поля, і помітабо потрібними інструкціями, Hibernate зробив свою справу. Насправді, при розробці на промі ви навряд займатиметеся структурою БД, все вже буде створено і розгорнуто за вас. Але в таких невеликих проектах Hibernate зі своїм умінням робити структури БД просто не замінимо, звичайно, це його не єдиний плюс,<a href="http://java-online.ru/hibernate-entities.xhtml" target="_blank" rel="nofollow"></a>(У цьому проекті ми не будемо їх використовувати). Давайте привітаємося з цим скромним трудягою: зайдемо в IDEA у структуру проекту (зліва таке дерево з папочками та файликами), там знайдемо External Libraries розкриємо його та серед інших бібліотек побачимо 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span><code class=" language-java"><span class="token class-name">Maven</span><span class="token operator">:</span> org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>common<span class="token operator">:</span>hibernate<span class="token operator">-</span>commons<span class="token operator">-</span>annotations<span class="token operator">:</span><span class="token number">5.1</span><span class="token number">.0</span><span class="token punctuation">.</span>Final
<span class="token class-name">Maven</span><span class="token operator">:</span> org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>validator<span class="token operator">:</span>hibernate<span class="token operator">-</span>validator<span class="token operator">:</span><span class="token number">6.0</span><span class="token number">.17</span><span class="token punctuation">.</span>Final
<span class="token class-name">Maven</span><span class="token operator">:</span> org<span class="token punctuation">.</span>hibernate<span class="token operator">:</span>hibernate<span class="token operator">-</span>core<span class="token operator">:</span><span class="token number">5.4</span><span class="token number">.6</span><span class="token punctuation">.</span>Final</code></pre> Зокрема Hibernate був викачаний для нас мавеном і 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>data<span class="token operator">-</span>jpa<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span></code></pre> Насправді містер Hiber провів ще одну приховану операцію, але про неї поговоримо в наступній статті. Ось тепер точно все. Як тренування пропоную вам самим реалізувати метод saveAll() для <em>FruitEntity</em> , який збереже всі сутності в базу за один раз. <a href="https://codegym.cc/groups/posts/3124-spring--ehto-ne-strashno-koroche-lombok" target="_blank" rel="nofollow">Далі дивимося як скоротити код проекту за допомогою бібліотеки Lombok</a>