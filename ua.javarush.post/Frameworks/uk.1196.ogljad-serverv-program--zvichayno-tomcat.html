Огляд серверів програм і, звичайно, Tomcat
<p>----------------------------------------</p>
Дорогі джаварашівці, що я хочу розглянути у цій статті? Я просто хочу зробити невеликий огляд тієї частини серверів додатків, які заслуговують на увагу хоча б тим, що є безкоштовними і доступний їх вихідний код. Я виходитиму з того, що ваша
<p>----------------------------------------</p>
Дорогі джаварашівці, що я хочу розглянути у цій статті? Я просто хочу зробити невеликий огляд тієї частини серверів додатків, які заслуговують на увагу хоча б тим, що є безкоштовними і доступний їх вихідний код. Я виходитиму з того, що ваша система подібна до моєї. У мене стоїть Windows 7 64 біта, крім того, у мене стоїть JDK 1.7 і JDK 1.8, а змінна оточення <em>JAVA_HOME</em> посилається на останній з них. У моєму випадку це означає, що в <em>JAVA_HOME</em> прописаний шлях <em>C: Program Files Java Jdk1.8.0_31. </em> <img data-id="220d3e29-1c4a-435e-ab8e-e5bfa63c0900" data-max-width="850" alt="Огляд серверів додатків і, звичайно, Tomcat - 1" src="https://cdn.javarush.com/images/article/220d3e29-1c4a-435e-ab8e-e5bfa63c0900/800.jpeg" style="width: 850px;">Щоб у вас при повторенні нижче описаного виникало якнайменше питань типу «а чому у мене не вийшло, може я щось не так роблю?», я намагатимуся описувати кожну дію, яку я робив на своїй машині. Починаємо… 
<h2>Кастинг, тобто. відбір</h2>Для початку потрібно відібрати сервери програм для нашого огляду. І тому на вікіпедії дивимося статтю <a href="https://en.wikipedia.org/wiki/List_of_application_servers" rel="nofollow" target="_blank">Comparison of application servers</a> (англ., т.к. інший немає). Там є табличка з купою серверів додатків, але нас інтерес представляють лише ті, які, з одного боку, opensource, з другого, підтримують JavaEE на повну, тобто. стовпець <em>Java EE compatibility</em> у цій таблиці повинен містити рядок типу <em>Full Platform</em> . З цього списку, в якому є і <em>WildFly</em> і <em>JBoss</em> відразу можна викинути останній, т.к. це просто стара назва і старі версії <em>WildFly</em> . В результаті отримуємо наступний список серверів, які заслуговують на нашу увагу: 
<ol>
 <li><strong>Glassfish</strong> (не пропрієтарний, а той, що від спільноти <a href="https://javaee.github.io/glassfish/" rel="nofollow" target="_blank">glassfish.java.net</a> , але який підтримується корпорацією Oracle настільки, що якщо потрібен javaEE SDK з сайту Oracle, то тобі впиндюрять і цей сервер додатків, інакше ніяк)</li>
 <li><strong>(Red Hat) WildFly</strong> (колишній JBoss)</li>
 <li><strong>(Apache) Geronimo</strong></li>
 <li><strong>(Apache) Tomcat</strong> (це лише контейнер сервлетів, а не сервер додатків, але він є таким еталоном, на якому, якщо програма написана правильно, вона точно запрацює. На інших серверах програма може бути написана правильно з точки зору JavaEE, але працювати все одно буде не коректно або взагалі не буде. Це я про Geronimo, про глюки якого можна говорити довго)</li>
</ol>Тепер давайте накачаємо цих серверів. 
<ul>
 <li>Для <strong>Tomcat</strong> це буде сайт <a href="http://tomcat.apache.org/" rel="nofollow" target="_blank">http://tomcat.apache.org</a> .</li>
 <li>Для <strong>Glassfish</strong> - сайт <a href="http://wildfly.org/" rel="nofollow" target="_blank">http://glassfish.java.net</a> .</li>
 <li>Для <strong>WildFly</strong> – сайт <a href="http://wildfly.org/" rel="nofollow" target="_blank">http://wildfly.org</a> .</li>
 <li>І, нарешті, для <strong>Geronimo</strong> – сайт <a href="http://geronimo.apache.org/" rel="nofollow" target="_blank">http://geronimo.apache.org</a> .</li>
</ul>Де можна було вибрати між 32-х і 64-хбітними версіями, я вибирав архівчик під мою систему в 64 біти. 
<h2>Встановлення</h2>У плані встановлення все просто і для кожного з вибраних серверів встановлення – це просто розпакування архіву. Я, наприклад, створив папку AppServers на робочому столі, куди і почав все розпаковувати. 
<h2>Налаштування</h2>Налаштування серверів почнемо з налаштування порту HTTP, на якому він працюватиме. Потім пропишемо себе як адмін сервера. Для кожного із серверів є свої особливості налаштування. <strong>Для Tomcat. </strong>Заходимо в папку з розпакованим tomcat, далі папка <em>conf</em> , файл <em>server.xml</em> . Знаходимо в цьому файлі число <em>8080</em> (http порт за замовчуванням) і змінюємо його, на що захочемо. Я поставив <em>9713</em> . Щоб прописати себе як адмін сервера, потрібно, перебуваючи в цій же папці, відкрити файл <em>tomcat-users.xml</em> . У ньому перед закриваючим тегом <em>&lt;/tomcat-users&gt;</em> прописати наступний тег <em>&lt;user username="egarmin" password="1" roles="manager-gui,manager-script,manager-status,manager-jmx"</em>де у своїй ролі я прописав максимальну кількість будь-яких адмінських прав (ролей). Це дозволить мені деплоїти програми і через gui, і через віддалене підключення. Тепер запустимо tomcat. Заходимо до папки з розпакованим tomcat, далі папка <em>bin</em> і запускаємо файл <em>startup.bat</em> . Переходимо у браузері за адресаою <a href="http://localhost:9713/" rel="nofollow" target="_blank">http://localhost:9713</a> . Повинне все заробити, і ми побачимо тигру. <img data-id="f721a76f-21bc-410c-bda5-87ae8f137483" data-max-width="570" alt="Tomcat" src="https://cdn.javarush.com/images/article/f721a76f-21bc-410c-bda5-87ae8f137483/512.jpeg" style="width: 570px;">Тепер перевіримо наявність доступу до адмінки. Для цього переходимо за адресаою <a href="http://localhost:9713/manager" rel="nofollow" target="_blank">http://localhost:9713/manager</a> , вводимо вибрані логін та пароль та отримуємо доступ. <img data-id="4913cd51-a37f-403d-9fda-e3fef2f94a85" data-max-width="570" alt="Адмінка у Tomcat" src="https://cdn.javarush.com/images/article/4913cd51-a37f-403d-9fda-e3fef2f94a85/512.jpeg" style="width: 570px;">УРА! Можна тимчасово вимкнути Tomcat, для цього достатньо закрити консоль, в якій він працює. <strong>Для Glassfish. </strong>Заходимо до папки з розпакованим<em>glassfish</em> , далі в підпапку <em>glassfish</em> , далі під папка <em>domains</em> , потім у папку <em>domain1</em> . Заходимо до папки <em>config</em> і знаходимо файл <em>domain.xml</em> . Там також шукаємо число <em>8080</em> (це число взагалі характерне як http-порт за промовчанням для серверів додатків і контейнерів сервлетів) і змінюємо його на що захочемо. Я поставив <em>9813</em> . Запустимо glassfish. Заходимо в папку з розпакованим glassfish, далі в підпапку <em>glassfish</em> , потім у папку <em>bin</em> . Запускаємо файл <em>startserv.bat</em> . У браузері вводимо адресау <a href="http://localhost:9813/" rel="nofollow" target="_blank">http://localhost:9813</a>. На негарній сторінці з заголовком <em>GlassFish Server</em> знаходимо посилання <em>go to the Administration Console</em> і тиснемо на неї. <img data-id="6c93fd86-765a-4d74-a9d5-ee2f9dd84363" data-max-width="570" alt="Перший вхід до GlassFish" src="https://cdn.javarush.com/images/article/6c93fd86-765a-4d74-a9d5-ee2f9dd84363/512.jpeg" style="width: 570px;">Далі, потрапивши на красиву побудовану на JSF сторінку адміністративної консолі, тиснемо пункт <em>Change Administrator Password</em> <img data-id="391ee430-ec1e-4c90-9e5d-e3d185cc7dac" data-max-width="570" alt="Адмінка у GlassFish" src="https://cdn.javarush.com/images/article/391ee430-ec1e-4c90-9e5d-e3d185cc7dac/512.jpeg" style="width: 570px;"> і вводимо потрібний пароль для користувача <em>admin</em> , потім підтверджуємо його і тиснемо кнопку <em>Save</em> . <img data-id="8657aa3a-ff94-49be-81ed-fcfa1b2cf1c6" data-max-width="570" alt="Зміна пароля у GlassFish" src="https://cdn.javarush.com/images/article/8657aa3a-ff94-49be-81ed-fcfa1b2cf1c6/512.jpeg" style="width: 570px;">При наступних входах до адміністративної консолі потрібно буде вказувати логін <em>admin</em> та заданий пароль. <img data-id="c6015011-ad1d-4ecd-9bea-00ce6d065fac" data-max-width="570" alt="Вхід до адмінки GlassFish за паролем" src="https://cdn.javarush.com/images/article/c6015011-ad1d-4ecd-9bea-00ce6d065fac/512.jpeg" style="width: 570px;">Тепер можна тимчасово відключити <em>Glassfish</em> , для цього достатньо закрити консоль, в якій він працює. <strong>Для WildFly. </strong>Заходимо до папки з розпакованим<em>wildfly</em> . Далі заходимо до папки <em>standalone</em> , потім папка <em>configuration</em> , а в ній файл <em>standalone.xml</em> . Далі діємо за налагодженою схемою. Я поставив порт <em>9913</em> . Запустимо сервер. Для цього перейдемо в папку з розпакованим <em>wildfly</em> . Далі заходимо до папки <em>bin</em> і запускаємо файл <em>standalone.bat</em> . Відкриваємо браузер і вводимо адресау <a href="http://localhost:9913/" rel="nofollow" target="_blank">http://localhost:9913</a> . <img data-id="5b42fcb8-efa9-4aad-9cb9-fddac80e99ae" data-max-width="570" alt="Перший вхід до WildFly" src="https://cdn.javarush.com/images/article/5b42fcb8-efa9-4aad-9cb9-fddac80e99ae/512.jpeg" style="width: 570px;">Тиснемо посилання <em>Administration Console</em> для входу в адмінську консоль (простіше кажучи, адмінку сервера додатків). Але тут було, т.к. спливає екран. <img data-id="f5cd5ad1-c4e7-43f6-ab2a-0aa75ba9eae1" data-max-width="570" alt="Перший вхід до адмінки WildFly" src="https://cdn.javarush.com/images/article/f5cd5ad1-c4e7-43f6-ab2a-0aa75ba9eae1/512.jpeg" style="width: 570px;">Цей екран повідомляє нам, що адмін не створений, і щоб його створити, потрібно скористатися консольною утилітою<em> add-user.bat</em> . Ну, якщо треба так треба. Повертаємося в папку <em>bin</em> і запускаємо цю утиліту. Спочатку запропонують вибрати тип користувача, якого хочемо створити. Треба вибрати пункт <em>(a)</em> , що означатиме, що нам потрібний адмін. Потім запитується ім'я цього користувача <em>Username</em> та пароль <em>Password</em> . Порожнім пароль бути не може, але односимвольним – будь ласка. Утиліта звичайно посвариться, але проковтне, якщо їй відповісти yes на запитання «Ви впевнені?». Далі підтверджуємо пароль повторним введенням на запит <em>Re-enter Password</em>. Потім будуть ще питання, але на них все просто відповідаємо ствердно та виходимо з утиліти. Повернувшись на сторінку вище, знаходимо посилання на <em>Try Again</em> і тиснемо на неї. Тепер, ввівши дані щойно створеного адміністратора, можна потрапити до адмінки. <img data-id="3ecf923c-a32b-45c4-a68b-de6536ce25cb" data-max-width="570" alt="Адмінка у WildFly" src="https://cdn.javarush.com/images/article/3ecf923c-a32b-45c4-a68b-de6536ce25cb/512.jpeg" style="width: 570px;">Гасимо сервер, закривши вікно консолі, через яку він був запущений. <strong>Для Geronimo. </strong>Заходимо в папку з розпакованим <em>geronimo</em> . Далі в підпапку <em>var</em> , потім у папку <em>config</em> , а в ній файл <em>config-substitutions.properties</em> . У цьому файлі описані всі порти, що використовуються сервером додатків у зручному форматі, але схема заміни порту та ж. Я поставив порт <em>10013</em> . Запустимо сервер <em>geronimo</em>. Перейдемо в папку з розпакованим<em> geronimo</em> , потім у підпапку <em>bin</em> і запустимо там файл <em>startup.bat</em> . Переходимо на сторінку <a href="http://localhost:10013/" rel="nofollow" target="_blank">http://localhost:10013</a>. Щоб ви думали? Скоріш за все, сторінки там не буде. Чому? Вся справа в тому, остання версія Geronimo (3.0) не може працювати з останньою версією JDK (1.8), тому якщо у вас стоїть тільки вона чи навіть нехай є, скажімо, 7-а версія, але змінна оточення JAVA_HOME все одно посилається саме на 8-му, як у мене, то запуск сервера додатків не відбудеться. Таким чином, для роботи Geronimo потрібно обов'язково завантажити JDK 1.7. Тепер припустимо ви поставабо 7-й JDK, але не хочете змінювати значення змінної JAVA_HOME (врешті-решт інші програми на неї не скаржаться, а значить нехай і працюють з останньою версією JDK). Що робити? Я раджу відкрити файл <em>setjavaenv.bat</em> , розташований у тій же папці <em>bin</em> , і знайти рядок з міткою <em>:okJdkFileCheck</em>. Після чого на наступному рядку додайте перевизначення змінної оточення. Наприклад, так: <em>set JAVA_HOME=C:\Program Files\Java\jdk1.7.0_75</em> Цього рядка там немає, тому будьте ласкаві прописати його самостійно. Якщо у вас 32-бітна система, то більше проблем не повинно бути. Більше того, якщо у вас 64-бітна система і ви поставабо JDK 1.7 саме в 64-бітній комплектації, то у вас також все в шоколаді. А тепер уявімо, що ми вирішабо перекрутитися і поставити на 64-бітну систему (у мене, наприклад, Windows 7 64) JDK 1.7 з лінійки в 32 біта. Що тоді? Тоді доведеться ще повозитися, тому що в 64-бітній системі є дві папки для встановлення програм: <em>Program Files</em> та <em>Program Files (x86)</em>і якщо нічого не змінювати, то 32-хбітний JDK стане саме в останню. Що у цьому страшного? Та начебто нічого, однак, якщо змінна JAVA_HOME матиме у своєму шляху дужки (x86), то у Geronimo трапляється нетравлення. Чому? Чорт його знає, особливо якщо врахувати, що згідно з даними з форумів, цю помилку в 3-й версії <strong>Geronimo</strong> мали виправити. Але ні фіга подібного. Головне в цій справі не робити пі-пі, якщо індіанці не виправабо, то виправимо. Для цього є два способи, які я волію комбінувати, щоб напевно. По-перше, знову йдемо файл <em>setjavaenv.bat</em> і знаходимо вже згадану мітку <em>:okJdkFileCheck</em> . Під цією міткою є рядок<em>if "%JRE_HOME%" == "" if exist "%JAVA_HOME%\bin\javac.exe" (set JRE_HOME=%JAVA_HOME%\jre) else set JRE_HOME=%JAVA_HOME% в якій для лікування Geronimo достатньо буде взяти підрядок</em> JRE_HOME =%JAVA_HOME%\jre в лапки, тобто. замінити весь рядок на <em>if "%JRE_HOME%" == "" if exist "%JAVA_HOME%\bin\javac.exe" (set "JRE_HOME=%JAVA_HOME%\jre") else set JRE_HOME=%JAVA_HOME%</em> . Крім того, пам'ятайте або знайте, що у папок типу Program Files у Windows 7 є синоніми (наприклад, для папки <em>C:\Program Files (x86)</em> синонімом буде папка <em>C:\Progra~2</em> ). Тому якщо ви у файлі <em>setjavaenv.bat</em> після мітки <em>:</em><em>JAVA_HOME set JAVA_HOME=C:\Progra~2\Java\jdk1.7.0_75</em> то у вас теж запрацює сервер <em>Geronimo</em> під управління 32-х бітного JDK в 64-х бітній операційній системі. Якось так ... Ну, нарешті, можна і запускати <strong>Geronimo</strong> , викликавши <em>startup.bat</em> . Тепер проблем не повинно бути. Переходимо у браузері на сторінку <a href="http://localhost:10013/" rel="nofollow" target="_blank">http://localhost:10013</a> . Зліва нагорі знаходимо посилання <em>Console</em> і тиснемо на неї. <img data-id="a4071e52-3679-4f45-8142-998bb0924dda" data-max-width="570" alt="Geronimo" src="https://cdn.javarush.com/images/article/a4071e52-3679-4f45-8142-998bb0924dda/512.jpeg" style="width: 570px;">Потрібно ввести адмінські логін та пароль. Відразу підкажу, що це користувач <em>системи</em> з паролем <em>manager</em> (значення за замовчуванням). <img data-id="7a21043f-9174-4abd-b712-5b508dc7ff6e" data-max-width="570" alt="Вхід до адмінки Geronimo за паролем" src="https://cdn.javarush.com/images/article/7a21043f-9174-4abd-b712-5b508dc7ff6e/512.jpeg" style="width: 570px;">Пройшовши в саму консоль і пройшовши по пунктах меню як на малюнку нижче (вибрати радіобатон <em>Advanced</em>, потім вибрати <em>Security &gt; Users and Groups</em> ), можна як змінити пароль для користувача <strong>system</strong> , так і створити іншого адмінського користувача, а цього видалити. <img data-id="c6ffcb5a-a55b-4315-8d8c-f1924c2b9c87" data-max-width="570" alt="Зміна пароля в Geronimo" src="https://cdn.javarush.com/images/article/c6ffcb5a-a55b-4315-8d8c-f1924c2b9c87/512.jpeg" style="width: 570px;">Зупинити сервер <em>Geronimo</em> можна також простим закриттям вікна консолі, в якому був запущений сервер. 
<h2>Висновок</h2>У цьому огляді я, по суті, просто провів установку та початкове настроювання популярних серверів додатків та контейнера сервлетів Tomcat. За винятком Geronimo, решта серверів була дуже доброзичливою до мене і виявила гостинність. У наступному пості я продовжу розгляд серверів додатків і зроблю третій крок на шляху розгляду веб-сервісів, а саме, покажу як задеплоїти описаний <a href="https://codegym.cc/groups/posts/1168-veb-servisih-shag-1-chto-takoe-veb-servis-i-kak-s-nim-rabotatjh" target="_blank">на першому етапі</a> веб-сервіс в ці сервери. Для цього ми створимо war-архів нашого веб-сервісу, і я наочно покажу, що набір сторонніх jar-ників, які треба включати до цього архіву для коректної роботи сервісу, сильно змінюється від сервера до сервера.