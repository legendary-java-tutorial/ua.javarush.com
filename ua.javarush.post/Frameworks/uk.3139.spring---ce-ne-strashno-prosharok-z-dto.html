Spring - це не страшно, прошарок з DTO
<p>----------------------------------------</p>
Продовжуємо говорити про Spring. Сьогодні розбиратимемо патерн DTO, для розуміння . Найскладніше в DTO – це зрозуміти, навіщо воно потрібне. Давайте займемося спекуляцією овочів, і заразом, попишемо код, може по ходу справи щось прояснитися
<p>----------------------------------------</p>
<a href="https://codegym.cc/groups/posts/3092-spring-ehto-nestrashno" target="_blank" rel="nofollow"><strong>ЗМІСТ ЦИКЛУ СТАТТІВ</strong></a> Продовжуємо говорити про Spring. Сьогодні розбиратимемо патерн DTO, для розуміння<a href="https://habr.com/ru/post/513072/" target="_blank" rel="nofollow"> можна почитати тут</a> . Найскладніше в DTO – це зрозуміти, навіщо воно потрібне. Давайте займемося спекуляцією овочів, і заразом, попишемо код, може по ходу справи щось прояснитися. Створіть<a href="https://codegym.cc/groups/posts/3092-spring-ehto-nestrashno" target="_blank" rel="nofollow"> spring-boot проект</a> ,<a href="https://codegym.cc/groups/posts/3093-spring-ehto-nestrashno-ili-kak-podkljuchitjh-bazu-dannihkh-dlja-studencheskogo-proekta-za-5-min" target="_blank" rel="nofollow"> підключіть h2</a> і<a href="https://codegym.cc/groups/posts/3124-spring--ehto-ne-strashno-koroche-lombok" target="_blank" rel="nofollow"> Lombok</a> . Створіть пакети: entities, repositories, services, utils. В entities створіть сутність Product: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>entities</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span></span><span class="token class-name">Accessors</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">GenericGenerator</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span></span><span class="token class-name">Column</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span></span><span class="token class-name">Entity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span></span><span class="token class-name">GeneratedValue</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span></span><span class="token class-name">Id</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Accessors</span><span class="token punctuation">(</span>chain <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProductEntity</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@Column</span>
    <span class="token annotation punctuation">@GenericGenerator</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"generator"</span><span class="token punctuation">,</span> strategy <span class="token operator">=</span> <span class="token string">"increment"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>generator <span class="token operator">=</span> <span class="token string">"generator"</span><span class="token punctuation">)</span>
    <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span>
    <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span>
    <span class="token class-name">Integer</span> purchasePrice<span class="token punctuation">;</span><span class="token comment">//закупочная цена</span>

<span class="token punctuation">}</span></code></pre> Реалізуйте класи ProducRepository, ProducService та клас ItiiateUtil ( <a href="https://codegym.cc/groups/posts/3095-spring-ehto-ne-strashno-prodolzhaem-napolnjatjh-bd" target="_blank" rel="nofollow">аналогічно минулій статті</a> ). Допустимо ми прикупабо картопля за оптовою ціною 20 рублів за кг., і моркви по 14 рублів за кг. Придбані продукти покладемо у сховище. Доповнимо БД записами: <em>[Id = 1, name = "Картопля", purchasePrice = 20] [Id = 2, name = "Морква", purchasePrice = 14] Як порядні спекулянти, ми повинні вигідно впарити свій</em> товар, для цього давайте красиво запакуємо його і накрутимо ціну. Тобто були у нас брудні і не гарні овочі, навалені купою, а стануть чистенькі преміум-веган продукти сегменту лакшері. Погодьтеся, це буде вже не той продукт який ми купабо оптом. Для нового продукту створимо пакет dto та в ньому <em>клас ProductDto</em>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>dto</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProductDto</span> <span class="token punctuation">{</span>
    <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> purchasePrice<span class="token punctuation">;</span>
    <span class="token class-name">String</span>  packaging<span class="token punctuation">;</span><span class="token comment">//упаковка</span>
    <span class="token class-name">Integer</span> salePrice<span class="token punctuation">;</span><span class="token comment">//цена реализации</span>
<span class="token punctuation">}</span></code></pre> ProductDto має дві змінні, яких немає у ProductEntity: «упаковка» і «ціна реалізації». Об'єкт dto може містити такі самі змінні, як і entity, або їх може бути більше, або менше. Ми пам'ятаємо, що конвертація одного об'єкта в інший – це справа мапінгу. У пакеті utils створимо клас MappingUtils 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>dto<span class="token punctuation">.</span></span><span class="token class-name">ProductDto</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">ProductEntity</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MappingUtils</span> <span class="token punctuation">{</span>
<span class="token comment">//из entity в dto</span>
    <span class="token keyword">public</span> <span class="token class-name">ProductDto</span> <span class="token function">mapToProductDto</span><span class="token punctuation">(</span><span class="token class-name">ProductEntity</span> entity<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">ProductDto</span> dto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProductDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dto<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dto<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dto<span class="token punctuation">.</span><span class="token function">setPurchasePrice</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span><span class="token function">getPurchasePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dto<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">//из dto в entity</span>
    <span class="token keyword">public</span> <span class="token class-name">ProductEntity</span> <span class="token function">mapToProductEntity</span><span class="token punctuation">(</span><span class="token class-name">ProductDto</span> dto<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">ProductEntity</span> entity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProductEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        entity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        entity<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        entity<span class="token punctuation">.</span><span class="token function">setPurchasePrice</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span><span class="token function">getPurchasePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> entity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Просто заповнюємо поля одного об'єкта, аналогічними полями з іншого об'єкта. У класі ProductService реалізуємо методи для пошуку одного продукту або списку продуктів, але перед цим ми конвертуємо entity в dto за допомогою написаного вище методу. 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ProductRepository</span> productRepository<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">MappingUtils</span> mappingUtils<span class="token punctuation">;</span>


<span class="token comment">//для листа продуктов мы использовали стрим</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductDto</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> productRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//создали из листа стирим</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>mappingUtils<span class="token operator">::</span><span class="token function">mapToProductDto</span><span class="token punctuation">)</span> <span class="token comment">//оператором из streamAPI map, использовали для каждого елемента метод mapToProductDto из класса MappingUtils</span>
<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//превратабо стрим обратно в коллекцию, а точнее в лист</span>
<span class="token punctuation">}</span>

<span class="token comment">//для одиночного продукта обошлись проще</span>
<span class="token keyword">public</span> <span class="token class-name">ProductDto</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> mappingUtils<span class="token punctuation">.</span><span class="token function">mapToProductDto</span><span class="token punctuation">(</span> <span class="token comment">//в метод mapToProductDto</span>
            productRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token comment">//поместабо результат поиска по id</span>
                    <span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ProductEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//если ни чего не нашли, то вернем пустой entity</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Що буде, якщо ми зараз покладемо ці овочі на вітрину? А давайте подивимося. Для цього в ItiiateUtil напишемо наступний код і запустимо. 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"\nВитрина магазина"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ProductDto</span> dto <span class="token operator">:</span> productService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> На виході отримаємо: <em>Вітрина магазину ProductDto(id=1, name=Картопля, purchasePrice=20, packaging=null, salePrice=null) ProductDto(id=2, name=Морква, purchasePrice=14, packaging=null, salePrice=null)</em> Ну вже немає! Такі овочі ніхто не придбає: брудні, не упаковані, та й ціна продажу не відома. Настав час бізнес-логіки. Її реалізуємо у класі ProductService. Додамо спочатку в цей клас пару змінних: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><code class=" language-java"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Integer</span> margin <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token comment">//это наша накрутка на цену</span>
<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> packaging <span class="token operator">=</span> <span class="token string">"Упаковано в лучшем виде"</span><span class="token punctuation">;</span><span class="token comment">//так будет выглядеть упаковка</span></code></pre> Для кожної дії: упаковка та накрутка ціни – створимо в цьому ж класі за окремим методом: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">// упаковываем товар</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pack</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductDto</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>productDto <span class="token operator">-&gt;</span>
            productDto<span class="token punctuation">.</span><span class="token function">setPackaging</span><span class="token punctuation">(</span>packaging<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// делаем деньги</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">makeMoney</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductDto</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>productDto <span class="token operator">-&gt;</span>
            productDto<span class="token punctuation">.</span><span class="token function">setSalePrice</span><span class="token punctuation">(</span>productDto<span class="token punctuation">.</span><span class="token function">getPurchasePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> margin<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Повертаємося до ItiiateUtil і викладання на вітрину замінюємо на наступний код 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductDto</span><span class="token punctuation">&gt;</span></span> productDtos <span class="token operator">=</span> productService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

productService<span class="token punctuation">.</span><span class="token function">pack</span><span class="token punctuation">(</span>productDtos<span class="token punctuation">)</span><span class="token punctuation">;</span>
productService<span class="token punctuation">.</span><span class="token function">makeMoney</span><span class="token punctuation">(</span>productDtos<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"\nВитрина магазина"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ProductDto</span> dto <span class="token operator">:</span> productDtos<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Виконуємо: <em>Вітрина магазину ProductDto(id=1, name=Картопля, purchasePrice=20, packaging=Упаковано у найкращому вигляді, salePrice=100) ProductDto(id=2, name=Морква, purchasePrice=14, packaging=Упаковано у найкращому вигляді, salePrice=70)</em> Товар красиво упакований, є ціна, але ви де-небудь бачабо, щоб на вітрині писали ціну за яку купабо оптом і ще id якийсь. Допрацьовуємо напилком, написаний вище код: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductDto</span><span class="token punctuation">&gt;</span></span> productDtos <span class="token operator">=</span> productService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

productService<span class="token punctuation">.</span><span class="token function">pack</span><span class="token punctuation">(</span>productDtos<span class="token punctuation">)</span><span class="token punctuation">;</span>
productService<span class="token punctuation">.</span><span class="token function">makeMoney</span><span class="token punctuation">(</span>productDtos<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"\nВитрина магазина"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ProductDto</span> dto <span class="token operator">:</span> productDtos<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
            <span class="token string">"Купите: %s , по цене:  %d"</span><span class="token punctuation">,</span> dto<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dto<span class="token punctuation">.</span><span class="token function">getSalePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> class InitiateUtils в результаті повинен бути таким: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InitiateUtils</span> <span class="token keyword">implements</span> <span class="token class-name">CommandLineRunner</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ProductService</span> productService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductEntity</span><span class="token punctuation">&gt;</span></span> products <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>
                <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>
                        <span class="token keyword">new</span> <span class="token class-name">ProductEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"Картофель"</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">setPurchasePrice</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token keyword">new</span> <span class="token class-name">ProductEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"Морковь"</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">setPurchasePrice</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        productService<span class="token punctuation">.</span><span class="token function">saveAll</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProductDto</span><span class="token punctuation">&gt;</span></span> productDtos <span class="token operator">=</span> productService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        productService<span class="token punctuation">.</span><span class="token function">pack</span><span class="token punctuation">(</span>productDtos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        productService<span class="token punctuation">.</span><span class="token function">makeMoney</span><span class="token punctuation">(</span>productDtos<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"\nВитрина магазина"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ProductDto</span> dto <span class="token operator">:</span> productDtos<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
                    <span class="token string">"Купите: %s , по цене:  %d"</span><span class="token punctuation">,</span> dto<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dto<span class="token punctuation">.</span><span class="token function">getSalePrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Запускаємо: <em>Вітрина магазину Купуйте: Картопля, за ціною: 100 Купуйте: Морква, за ціною: 70</em> Інша справа! Тепер подумаємо, що dto принесло хорошого, крім купи додаткового коду: 1. Ми можемо здійснювати бізнес-логіку не змінюючи об'єкти в БД (припустимо, ну непотрібно нам у цій таблиці мати поля про упаковку та ціну продажу). Картопля відмінно лежить у сховищі та без упаковки з цінником, вони там навіть зайві. 2. У цьому рядку <em>List&lt;ProductDto&gt; productDtos = productService.findAll()</em>ми створабо кеш з об'єктів, з якими зручно працювати в рамках бізнес-логіки. Це, якби ми поклали частину товару у підсобку магазину. 3. Це нам дозволило зробити дві бізнес дії: упаковка і націнка, але запит в базу зробабо тільки один раз (запити в базу досить важкі в плані продуктивності). Товар можна упаковувати, клеїти цінник і викладати на вітрину – поступово набираючи його з підсобки, а не бігати за ним щоразу у сховище. На запитання: «Навіщо так складно?» люди теж намагаються знайти відповідь, <a href="https://ru.stackoverflow.com/questions/456623/%D0%9D%D0%B0%D0%B3%D0%BB%D1%8F%D0%B4%D0%BD%D1%8B%D0%B9-%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D1%80%D0%B0%D0%B7%D0%BB%D0%B8%D1%87%D0%B8%D1%8F-dto-poco-pojo-%D0%B8-value-object" target="_blank" rel="nofollow">почитайте</a> . <a href="https://codegym.cc/groups/posts/3160-spring---ehto-ne-strashno-kontroliruem-svoy-rest" target="_blank" rel="nofollow">Наступна стаття</a>