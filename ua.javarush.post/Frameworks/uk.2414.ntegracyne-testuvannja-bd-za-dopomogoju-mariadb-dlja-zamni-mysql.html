Інтеграційне тестування БД за допомогою MariaDB для заміни MySql
<p>----------------------------------------</p>
Сьогодні хотілося б поговорити про тестування, бо чим більше код покритий тестами, тим він вважається якіснішим та надійнішим. Торкнемося не модульне тестування, а інтеграційне тестування баз даних. У чому, власне, різниця між модульними те
<p>----------------------------------------</p>
<img data-id="9ccc291b-6aea-4a1e-9a3d-e7d5c4dd3af3" data-max-width="350" alt="Інтеграційне тестування БД за допомогою MariaDB для заміни MySql - 1" src="https://cdn.javarush.com/images/article/9ccc291b-6aea-4a1e-9a3d-e7d5c4dd3af3/256.jpeg" style="width: 350px;">Сьогодні хотілося б поговорити про тестування, бо чим більше код покритий тестами, тим він вважається якіснішим та надійнішим. Торкнемося не модульне тестування, а інтеграційне тестування баз даних. У чому, власне, різниця між модульними тестами та інтеграційними? <img data-id="35afe198-9826-4ef1-a2e6-34d160fe7da2" data-max-width="850" alt="Інтеграційне тестування БД за допомогою MariaDB для заміни MySql - 2" src="https://cdn.javarush.com/images/article/35afe198-9826-4ef1-a2e6-34d160fe7da2/800.jpeg" style="width: 850px;">Модульне (юніт) - це тестування програми на рівні окремо взятих модулів, методів або класів, тобто тести швидкі та легкі, що стосуються максимально ділимих частин функціоналу. Про них говорять «один тест на один метод». Інтеграційні - більш повільні та великовагові, можуть складатися з кількох модулів та підйому додаткового функціоналу. <img data-id="6270633c-1cfa-4b46-aefc-4e5802ab06bd" data-max-width="850" alt="Інтеграційне тестування БД за допомогою MariaDB для заміни MySql - 3" src="https://cdn.javarush.com/images/article/6270633c-1cfa-4b46-aefc-4e5802ab06bd/800.jpeg" style="width: 850px;"><strong>Чому тести для шару dao (Data Access Object) є інтеграційними?</strong>Тому що для тестування методів із запитами до БД нам потрібно піднімати окрему БД в оперативній пам'яті, яка підміняє основну. Ідея в тому, що ми створюємо потрібні нам таблички, заповнюємо їх тестовими даними та перевіряємо коректність відпрацювання методів класу-репозиторію (адже ми знаємо, яким має бути кінцевий результат у тому чи іншому випадку). Тож почнемо. Теми щодо підключення БД вже давно виїжджені вздовж і впоперек, і тому сьогодні на цьому зупинятися не хотілося б, і розглянемо лише частини програми, які нас цікавлять. За замовчуванням будемо відштовхуватися від того, що додаток у нас на Spring Boot, для шару дао Spring JDBC (для більшої наочності), основна БД у нас MySQL, а підміняти ми будемо за допомогою MariaDB (вони максимально сумісні, і відповідно у скриптів MySQL ніколи не буде конфліктів з діалектом MariaDB, як буде у H2). <a href="https://codegym.cc/welcome" target="_blank"><img id="click_banner1_articles" data-id="f93c4209-e4eb-4282-b7cc-a82cc3d4f0c1" data-max-width="1080" alt="Інтеграційне тестування БД за допомогою MariaDB для заміни MySql - 4" src="https://cdn.javarush.com/images/article/f93c4209-e4eb-4282-b7cc-a82cc3d4f0c1/1080.jpeg" style="width: 1080px;"></a>
<h2>Структура проекту</h2>Показані тільки торкнуті частини: <img data-id="261272f7-bc93-4174-ad23-5e6dec4c1162" data-max-width="312" alt="Інтеграційне тестування БД за допомогою MariaDB для заміни MySql - 5" src="https://cdn.javarush.com/images/article/261272f7-bc93-4174-ad23-5e6dec4c1162/256.jpeg" style="width: 312px;">І так, ми сьогодні створюватимемо роботів)) <img data-id="8d8d0ffa-8898-454b-a100-d3e31ef73e73" data-max-width="350" alt="Інтеграційне тестування БД за допомогою MariaDB для заміни MySql - 6" src="https://cdn.javarush.com/images/article/8d8d0ffa-8898-454b-a100-d3e31ef73e73/256.jpeg" style="width: 350px;">Скрипт для таблиці, методи до якої б тестуватимемо сьогодні (create_table_robots.sql): 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java">CREATE TABLE `robots`
<span class="token punctuation">(</span>
   `id`   <span class="token function">BIGINT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> NOT <span class="token class-name">NULL</span> AUTO_INCREMENT<span class="token punctuation">,</span>
   `name` <span class="token function">CHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> CHARACTER SET utf8 <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
   `cpu`  <span class="token function">CHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> CHARACTER SET utf8 <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
   `producer`  <span class="token function">CHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> CHARACTER SET utf8 <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
   <span class="token class-name">PRIMARY</span> KEY <span class="token punctuation">(</span>`id`<span class="token punctuation">)</span>
<span class="token punctuation">)</span> ENGINE <span class="token operator">=</span> <span class="token class-name">InnoDB</span>
 <span class="token class-name">DEFAULT</span> CHARSET <span class="token operator">=</span> utf8<span class="token punctuation">;</span></code></pre> Сутність, що представляє цю таблицю: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Builder</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Robot</span> <span class="token punctuation">{</span>

   <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

   <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

   <span class="token keyword">private</span> <span class="token class-name">String</span> cpu<span class="token punctuation">;</span>

   <span class="token keyword">private</span> <span class="token class-name">String</span> producer<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Інтерфейс для тестованого репозиторію: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">RobotDAO</span> <span class="token punctuation">{</span>

   <span class="token class-name">Robot</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name">Robot</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Robot</span> robot<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Robot</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name">Robot</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Robot</span> robot<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Власне тут стандартні CRUD операції без екзотики, тому розглянемо реалізацію не всіх методів (ну цим нікого вже не здивувати), а деяких — для більшої лаконічності: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Repository</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RobotDAOImpl</span> <span class="token keyword">implements</span> <span class="token class-name">RobotDAO</span> <span class="token punctuation">{</span>

   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> FIND_BY_ID <span class="token operator">=</span> <span class="token string">"SELECT id, name, cpu, producer FROM robots WHERE id = ?"</span><span class="token punctuation">;</span>

   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> UPDATE_BY_ID <span class="token operator">=</span> <span class="token string">"UPDATE robots SET name = ?, cpu = ?, producer = ?  WHERE id = ?"</span><span class="token punctuation">;</span>

   <span class="token annotation punctuation">@Autowired</span>
   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">;</span>

   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token class-name">Robot</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> jdbcTemplate<span class="token punctuation">.</span><span class="token function">queryForObject</span><span class="token punctuation">(</span>FIND_BY_ID<span class="token punctuation">,</span> <span class="token function">robotMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token class-name">Robot</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Robot</span> robot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>UPDATE_BY_ID<span class="token punctuation">,</span>
               robot<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               robot<span class="token punctuation">.</span><span class="token function">getCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               robot<span class="token punctuation">.</span><span class="token function">getProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               robot<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token keyword">return</span> robot<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span> <span class="token class-name">RowMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Robot</span><span class="token punctuation">&gt;</span></span> <span class="token function">robotMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token punctuation">(</span>rs<span class="token punctuation">,</span> rowNum<span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
               <span class="token class-name">Robot</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">cpu</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"cpu"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">producer</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"producer"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre> Зробимо деякий відступ і подивимося, що у нас діється із залежностями (представлені лише ті, що юзаються для продемонстрованої частини додатку): 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependencies<span class="token punctuation">&gt;</span></span>
   <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
       <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>mariadb<span class="token punctuation">.</span>jdbc<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mariadb<span class="token operator">-</span>java<span class="token operator">-</span>client<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.5</span><span class="token number">.2</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>test<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
   <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
       <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>craftercms<span class="token punctuation">.</span>mariaDB4j<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mariaDB4j<span class="token operator">-</span>springboot<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.4</span><span class="token number">.2</span><span class="token number">.3</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>test<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
   <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
       <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>projectlombok<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>lombok<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.18</span><span class="token number">.10</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>provided<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
   <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
       <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>test<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.2</span><span class="token number">.1</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>test<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
   <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
       <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>jdbc<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
       <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.2</span><span class="token number">.1</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependencies<span class="token operator">&gt;</span></code></pre>4 - залежність для самої БД MariaDb 10 - залежність для коннекту з SpringBoot 16 - Lombok (ну, я думаю всі знають, що це за либа) 22 - стартер для тестів (куди вшитий необхідний нам JUnit) 28 - стартер для роботи з springJdbc Розглянемо Spring контейнер із бінами, необхідними для наших тестів (зокрема і бін створення MariaDB): 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestConfigDB</span> <span class="token punctuation">{</span>

   <span class="token annotation punctuation">@Bean</span>
   <span class="token keyword">public</span> <span class="token class-name">MariaDB4jSpringService</span> <span class="token function">mariaDB4jSpringService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MariaDB4jSpringService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token annotation punctuation">@Bean</span>
   <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token class-name">MariaDB4jSpringService</span> mariaDB4jSpringService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">try</span> <span class="token punctuation">{</span>
           mariaDB4jSpringService<span class="token punctuation">.</span><span class="token function">getDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createDB</span><span class="token punctuation">(</span><span class="token string">"testDB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ManagedProcessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
         e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>

       <span class="token class-name">DBConfigurationBuilder</span> config <span class="token operator">=</span> mariaDB4jSpringService<span class="token punctuation">.</span><span class="token function">getConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token keyword">return</span> <span class="token class-name">DataSourceBuilder</span>
               <span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">username</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token function">getURL</span><span class="token punctuation">(</span><span class="token string">"testDB"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">driverClassName</span><span class="token punctuation">(</span><span class="token string">"org.mariadb.jdbc.Driver"</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token annotation punctuation">@Bean</span>
   <span class="token keyword">public</span> <span class="token class-name">JdbcTemplate</span> <span class="token function">jdbcTemplate</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JdbcTemplate</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>5 - головний компонент для підйому MariaDB (для додатків на основі Spring Framework) 10 - визначення біна бази даних 12 - завдання імені створюваної Бази даних 17 - витягуємо конфігурації для нашого випадку 19 - будуємо базу даних за допомогою патерну Builder ( непоганий огляд на <a href="https://habr.com/ru/post/244521/" rel="nofollow" target="_blank">пат</a> І нарешті те, заради чого весь сир-бор - це бін JdbcTemplate для зв'язку з базою, що піднімається. Ідея в тому, що у нас буде основний клас для тестів дао, від якого успадковуватимуться всі класи-тести дао, до завдань яких входить: 
<ol>
 <li>запуск деяких використовуваних в основній БД скриптів (скриптів створення таблиць, зміни колонок та інших);</li>
 <li>запуск тестових скриптів, які заповнюють таблиці тестовими даними;</li>
 <li>видалення таблиць.</li>
</ol>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@SpringBootTest</span><span class="token punctuation">(</span>classes <span class="token operator">=</span> <span class="token class-name">TestConfigDB</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">DataBaseIT</span> <span class="token punctuation">{</span>

   <span class="token annotation punctuation">@Autowired</span>
   <span class="token keyword">private</span> <span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">;</span>

   <span class="token keyword">public</span> <span class="token class-name">JdbcTemplate</span> <span class="token function">getJdbcTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> jdbcTemplate<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fillDataBase</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> initList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> x <span class="token operator">:</span> initList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">try</span> <span class="token punctuation">{</span>
               jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">resourceToString</span><span class="token punctuation">(</span><span class="token string">"/db.migrations/"</span> <span class="token operator">+</span> x<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">cleanDataBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">getJdbcTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">"DROP database testDB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">getJdbcTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">"CREATE database testDB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">getJdbcTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">"USE testDB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fillTables</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fillList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> x <span class="token operator">:</span> fillList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">try</span> <span class="token punctuation">{</span>
               <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>
                       <span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">resourceToString</span><span class="token punctuation">(</span><span class="token string">"/fill_scripts/"</span> <span class="token operator">+</span> x<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>jdbcTemplate<span class="token operator">::</span><span class="token function">update</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> 1 - за допомогою інструкції @SpringBootTest задаємо тестову конфігурацію 11 - аргументом в даному методі передаємо назви потрібних нам таблиць, і він як відповідальний трудяга буде нам їх підвантажувати (що дає нам можливість цьому метод перевикористовувати, скільки душа забажає) 21 - це метод використовуємо для чистки, а саме, видалення всіх таблиць (та їх даних) з БД 27 - аргумент у даному методі - масив назв скриптів з тестовими даними, які будуть завантажені для тестування певного методу Наш скрипт з тестовими даними: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class=" language-java">INSERT <span class="token class-name">INTO</span> <span class="token function">robots</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> cpu<span class="token punctuation">,</span> producer<span class="token punctuation">)</span>
VALUES <span class="token punctuation">(</span><span class="token string">'Rex'</span><span class="token punctuation">,</span> <span class="token string">'Intel Core i5-9400F'</span><span class="token punctuation">,</span> <span class="token string">'Vietnam'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token string">'Molly'</span><span class="token punctuation">,</span> <span class="token string">'AMD Ryzen 7 2700X'</span><span class="token punctuation">,</span> <span class="token string">'China'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token string">'Ross'</span><span class="token punctuation">,</span> <span class="token string">'Intel Core i7-9700K'</span><span class="token punctuation">,</span> <span class="token string">'Malaysia'</span><span class="token punctuation">)</span></code></pre> А тепер те, заради чого ми всі сьогодні зібралися. 
<h2>Клас для тестування дао</h2>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RobotDataBaseIT</span> <span class="token keyword">extends</span> <span class="token class-name">DataBaseIT</span> <span class="token punctuation">{</span>

   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">RobotDAO</span> countryDAO<span class="token punctuation">;</span>

   <span class="token annotation punctuation">@Before</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fillData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">fillDataBase</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>
               <span class="token string">"create_table_robots.sql"</span>
       <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       countryDAO <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RobotDAOImpl</span><span class="token punctuation">(</span><span class="token function">getJdbcTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token annotation punctuation">@After</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">cleanDataBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">private</span> <span class="token class-name">RowMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Robot</span><span class="token punctuation">&gt;</span></span> <span class="token function">robotMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token punctuation">(</span>rs<span class="token punctuation">,</span> rowNum<span class="token punctuation">)</span> <span class="token operator">-&gt;</span>
               <span class="token class-name">Robot</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">cpu</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"cpu"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">producer</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"producer"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span></code></pre> 2 - успадковуємося від основного класу для наших тестів 4 - наш тестований репозиторій 7 - метод, який запускатиметься до кожного тесту 8 - використовуємо метод батьківського класу, щоб завантажити необхідні таблиці таблиці 11 - ініціалізуємо наш дао 15 - метод, який запускатиметься після кожного тесту тесту, чистячи нашу базу 19 - реалізація нашого RowMapper, аналог з класу дао Ми використовуємо @Before і @After, які юзаться до і після одного методу-тесту, а могли б взяти якусь лібу, що дозволяє використовувати анотації, прив'язані до початку виконання тестів даного класу та кінцю. Наприклад, <a href="https://bitbucket.org/radistao/before-after-spring-test-runner/src/master/" rel="nofollow" target="_blank">ось цю</a>, Що значно прискорило б тести, так як створювати таблиці і повністю їх видаляти потрібно було б гн кожен раз, а один раз на клас. Але ми так не робимо. Чому, спитаєте ви? А якщо один із методів буде змінювати структуру таблиці? Наприклад, видаляти одну колонку. У такому випадку решта методів може або не виконатися, або повинна відреагувати належним чином (наприклад, створити колонку назад). Доводиться визнати, що це дає непотрібну нам пов'язаність (залежність) тестів один від одного, що нам ні до чого. Але я відволікся, продовжуємо…. 
<h2>Тестування методу findById</h2>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findByIdTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">fillTables</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"fill_table_robots.sql"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name">Long</span> id <span class="token operator">=</span> <span class="token function">getJdbcTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">queryForObject</span><span class="token punctuation">(</span><span class="token string">"SELECT id FROM robots WHERE name = 'Molly'"</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">Robot</span> robot <span class="token operator">=</span> countryDAO<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token function">assertThat</span><span class="token punctuation">(</span>robot<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isNotNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>robot<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>robot<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span><span class="token string">"Molly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>robot<span class="token punctuation">.</span><span class="token function">getCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span><span class="token string">"AMD Ryzen 7 2700X"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>robot<span class="token punctuation">.</span><span class="token function">getProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span><span class="token string">"China"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> 3 — заповнюємо тестовими даними таблицю 5 — дістаємо id для потрібної нам сутності 6 — використовуємо метод, що перевіряється 8...12 — звіряємо отримані дані з очікуваними 
<h2>Тест методу update</h2>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">fillTables</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"fill_table_robots.sql"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name">Long</span> robotId <span class="token operator">=</span> <span class="token function">getJdbcTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">queryForObject</span><span class="token punctuation">(</span><span class="token string">"SELECT id FROM robots WHERE name = 'Rex'"</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name">Robot</span> updateRobot <span class="token operator">=</span> <span class="token class-name">Robot</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
           <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>robotId<span class="token punctuation">)</span>
           <span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"Aslan"</span><span class="token punctuation">)</span>
           <span class="token punctuation">.</span><span class="token function">cpu</span><span class="token punctuation">(</span><span class="token string">"Intel Core i5-3470"</span><span class="token punctuation">)</span>
           <span class="token punctuation">.</span><span class="token function">producer</span><span class="token punctuation">(</span><span class="token string">"Narnia"</span><span class="token punctuation">)</span>
           <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token class-name">Robot</span> responseRobot <span class="token operator">=</span> countryDAO<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>updateRobot<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">Robot</span> updatedRobot <span class="token operator">=</span> <span class="token function">getJdbcTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">queryForObject</span><span class="token punctuation">(</span>
           <span class="token string">"SELECT id, name, cpu, producer FROM robots WHERE id = ?"</span><span class="token punctuation">,</span>
           <span class="token function">robotMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           robotId<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token function">assertThat</span><span class="token punctuation">(</span>updatedRobot<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isNotNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>updateRobot<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>responseRobot<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>updateRobot<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>updatedRobot<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>updateRobot<span class="token punctuation">.</span><span class="token function">getCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>responseRobot<span class="token punctuation">.</span><span class="token function">getCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>updateRobot<span class="token punctuation">.</span><span class="token function">getCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>updatedRobot<span class="token punctuation">.</span><span class="token function">getCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>updateRobot<span class="token punctuation">.</span><span class="token function">getProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>responseRobot<span class="token punctuation">.</span><span class="token function">getProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>updateRobot<span class="token punctuation">.</span><span class="token function">getProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>updatedRobot<span class="token punctuation">.</span><span class="token function">getProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>responseRobot<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>updatedRobot<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">assertThat</span><span class="token punctuation">(</span>updateRobot<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>updatedRobot<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> 3 — заповнюємо тестовими даними таблицю 5 — дістаємо id сутності, що оновлюється 7 — будуємо оновлену сутність 14 — юзаєм метод, що перевіряється 15 — дістаємо оновлену сутність для звіряння 20...28 — звіряємо отримані дані з очікуваними тестування. Принаймні в мене. Перекручуватися зі звірками можна як душі завгодно: перевірок багато не буває. Дуже хотілося б помітити і те, що тести не гарантують повної працездатності або відсутності багів. Тести лише забезпечують відповідність реального результату роботи програми (її фрагмента) очікуваному. У цьому перевірка відбувається лише частин, котрим були написані тести. 
<h2>Запускаємо клас із тестами…</h2><img data-max-width="200" alt="Інтеграційне тестування БД за допомогою MariaDB для заміни MySql - 7" src="https://cdn.javarush.com/images/article/de92a3ca-b8d0-4851-845f-9319f30828d8/original.jpeg">Перемога)) Ідемо заварювати чай і діставати печінки: ми це заслужабо)) <img data-max-width="200" alt="Інтеграційне тестування БД за допомогою MariaDB для заміни MySql - 8" src="https://cdn.javarush.com/images/article/7cdd0ce2-ea39-4e8b-b499-522b2afb0fa0/original.jpeg">
<h2>Корисні посилання</h2>
<ul>
 <li><a href="https://www.javaguides.net/2019/08/spring-boot-spring-jdbc-mysql-crud-example.html" rel="nofollow" target="_blank">Непогана стаття щодо нерозглянутої частини з цим стеком технологій.</a></li>
 <li><a href="https://codegym.cc/groups/posts/2253-znakomstvo-s-maven-spring-mysql-hibernate-i-pervoe-crud-prilozhenie-chastjh-1" target="_blank">Цікавий цикл статей про Maven, Spring, MySQL, Hibernate.</a></li>
 <li><a href="https://habr.com/ru/post/120101/" rel="nofollow" target="_blank">Трохи освіжимо пам'ять по юніт тестам.</a></li>
 <li><a href="https://habr.com/ru/company/haulmont/blog/454970/" rel="nofollow" target="_blank">Цікавий приклад інтеграційного тестування, але із заміною PostgreSQL.</a></li>
 <li><a href="https://xakep.ru/2011/05/26/55801/" rel="nofollow" target="_blank">Багато хто і не тільки в тестах використовують MariaDB замість MySql.</a></li>
</ul>Хто дочитав — дякую за увагу та… <img data-id="151b0636-70a0-46c3-80e0-8307327ef4dc" data-max-width="850" alt="Інтеграційне тестування БД за допомогою MariaDB для заміни MySql - 9" src="https://cdn.javarush.com/images/article/151b0636-70a0-46c3-80e0-8307327ef4dc/800.jpeg" style="width: 850px;">
<center>
 <p>*епічна музика зі Star Wars*</p>
 <p></p>
</center>