Spring - це не страшно, або як поставити питання БД
<p>----------------------------------------</p>
Сьогодні ми дорозбираємо роботу з базою в рамках нашого проекту. Якщо ви все робили правильно, то у вас має бути pom ось із такими залежностями:
<p>----------------------------------------</p>
<a href="https://codegym.cc/groups/posts/3092-spring-ehto-nestrashno" target="_blank" rel="nofollow"><strong>ЗМІСТ ЦИКЛУ СТАТЕЙ</strong></a> Сьогодні ми дорозбираємо роботу з базою в рамках нашого проекту. Якщо ви все робабо правильно, то у вас має бути pom ось із такими залежностями: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token generics"><span class="token punctuation">&lt;</span>properties<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>source<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>source<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>target<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>target<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>java<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>java<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>properties<span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>parent<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>parent<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.2</span><span class="token number">.0</span><span class="token punctuation">.</span>RELEASE<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>relativePath<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> lookup parent from repository <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>parent<span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>dependencies<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>web<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>data<span class="token operator">-</span>jpa<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>h2database<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>h2<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>projectlombok<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>lombok<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependencies<span class="token operator">&gt;</span></code></pre> І ось така структура проекту: <img width="800" height="500" data-id="b16712c2-0df1-4676-afe9-1a2770d8b1ef" alt="Spring - це не страшно, або як поставити питання БД - 1" src="https://cdn.javarush.com/images/article/b16712c2-0df1-4676-afe9-1a2770d8b1ef/1080.jpeg"> Знаєте, кого ми давно не згадували? Це application.yml, ми поговорабо небагато про нього в одній з минулих статей. А тепер давайте візьмемо та видалимо його! Так, так delete і все! Якщо ми запустимо зараз проект, все буде працювати як і раніше, спробуйте це зробити. Це сталося через те, що Spring сам налаштувався на дефолних налаштуваннях. Тепер треба повернути наш ямл файл назад у папку ресурси, він нам ще знадобиться: application.yml (найменування має бути таким самим) 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java">spring<span class="token operator">:</span>
  datasource<span class="token operator">:</span>
    driverClassName<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>h2<span class="token punctuation">.</span></span>Driver</span>
    url<span class="token operator">:</span> jdbc<span class="token operator">:</span>h2<span class="token operator">:</span>mem<span class="token operator">:</span>test<span class="token punctuation">;</span>
    username<span class="token operator">:</span> sa
    password<span class="token operator">:</span>
    h2<span class="token operator">:</span>
      console<span class="token operator">:</span>
        enabled<span class="token operator">:</span> <span class="token boolean">true</span>
  jpa<span class="token operator">:</span>
    hibernate<span class="token punctuation">.</span>ddl<span class="token operator">-</span>auto<span class="token operator">:</span> create
    generate<span class="token operator">-</span>ddl<span class="token operator">:</span> <span class="token boolean">true</span>
    show<span class="token operator">-</span>sql<span class="token operator">:</span> <span class="token boolean">false</span>
    properties<span class="token operator">:</span>
      hibernate<span class="token operator">:</span>
        dialect<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>dialect<span class="token punctuation">.</span></span>H2Dialect</span></code></pre> Минулого разу ми за допомогою методів інтерфейсу JpaRepository&lt;&gt; реалізували кілька запитів до бази: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//сохранить одну запись в таблицу фруктов</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">FruitEntity</span> fruitEntity<span class="token punctuation">)</span><span class="token punctuation">{</span>
    fruitRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>fruitEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//получить все записи из таблицы фруктов</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FruitEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span> fruitRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//сохранить несколько записей в таблицу фруктов</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveAll</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FruitEntity</span><span class="token punctuation">&gt;</span></span> fruits<span class="token punctuation">)</span><span class="token punctuation">{</span>
    fruitRepository<span class="token punctuation">.</span><span class="token function">saveAll</span><span class="token punctuation">(</span>fruits<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Якщо ви прочитали про <a href="https://sql-academy.org/ru/guide" target="_blank" rel="nofollow">SQL</a> , як я вас просив минулого разу, то ви повинні знати, що такі дії з БД повинні виконуватися за допомогою запитів SQL . Але в проекті на це немає і натяку, навіть у логах консолі немає нічого схожого. Давайте їх знайдемо, відкриваємо application.yml, знаходимо там термін show-sql: (показати sql) і змінюємо false на true. Запускаємо проект і дивимося в консоль, логи наповнабося новими записами дуже схожими на SQL, насправді більшість з них зрозуміти не дивно, наприклад: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token class-name">Hibernate</span><span class="token operator">:</span> drop table fruit_table <span class="token keyword">if</span> exists <span class="token comment">//удалить таблицу fruit_table  если она есть</span>
<span class="token class-name">Hibernate</span><span class="token operator">:</span> drop table provider_table <span class="token keyword">if</span> exists
<span class="token class-name">Hibernate</span><span class="token operator">:</span> create table fruit_table <span class="token punctuation">(</span>id_fruit integer not <span class="token keyword">null</span><span class="token punctuation">,</span> fruit_name <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> provider_code integer<span class="token punctuation">,</span> primary key <span class="token punctuation">(</span>id_fruit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//создать таблицу fruit_table с полями id_fruit тип integer not null, fruit_name  тип varchar(255), provider_code тип integer, назначить первичным ключем поле id_fruit</span>
<span class="token class-name">Hibernate</span><span class="token operator">:</span> create table provider_table <span class="token punctuation">(</span>id_provider integer not <span class="token keyword">null</span><span class="token punctuation">,</span> provider_name <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> primary key <span class="token punctuation">(</span>id_provider<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre> Але цей запис може викликати багато запитань через своїх знаків питань: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span></span><code class=" language-java"><span class="token class-name">Hibernate</span><span class="token operator">:</span> insert into fruit_table <span class="token punctuation">(</span>fruit_name<span class="token punctuation">,</span> provider_code<span class="token punctuation">,</span> id_fruit<span class="token punctuation">)</span> values <span class="token punctuation">(</span><span class="token operator">?</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">)</span></code></pre> Давайте мислити логічно: По-перше ми бачимо слово Hibernate, значить цей потай хлопець приклав тут свою волохату лапу. Прочитавши про нього в інтернеті, ми дізнаємося, що містер <a href="https://javahelp.online/osnovy/hibernate-java" target="_blank" rel="nofollow">Hiber</a> – це реалізація ORM-моделі. Об'єктно-реляційна модель описує відносини між програмними об'єктами та записами у БД. Зафіксували цю думку, продовжуємо мислити логічно: З одного боку, у нас є об'єкт <em>FruitEntity</em> , у нього є три поля: <em>Integer id; String fruitName; Integer providerCode. </em> З іншого боку, ми маємо таблицю в БД <em>fruit_table</em> з полями <em>id_fruit</em> тип <em>integer, </em> <em>fruit_name</em> тип <em>varchar(255)</em> , <em>provider_code</em> тип<em>integer. </em> Грубо кажучи, Hibernate бере об'єкт <em>FruitEntity</em> , витягує значення полів об'єкта і записує їх у відповідні поля таблиці. У мене до вас питання: Дивіться, в класі <em>InitiateUtils</em> ми реалізували заповнення таблиці фруктів, але чому ми тут задали значення тільки двом полям, де третє? 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">new</span> <span class="token class-name">FruitEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setFruitName</span><span class="token punctuation">(</span><span class="token string">"Fruit1"</span><span class="token punctuation">)</span><span class="token comment">//раз</span>
        <span class="token punctuation">.</span><span class="token function">setProviderCode</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//два</span>
                                            <span class="token comment">//три???</span></code></pre> Впевнений ви розберетеся в цьому самі, до того ж ми миттю торкалися цього питання позаминулої статті. Для початку розберіться якого поля тут немає, а далі ви все зрозумієте. Ну що ж, Hiber молодець, нагенерував за нас купу запитів. Але і ми не ликом шиті, давайте в класі <em>FruitService</em> реалізуємо ще кілька методів з інтерфейсу <em>JpaRepository&lt;&gt;</em>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token comment">//возвращает запись из таблицы по id</span>
<span class="token keyword">public</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FruitEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">getById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span> fruitRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//удаляет запись из таблицы по id</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
    fruitRepository<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//возвращает true або false при поиске в таблице Фруктов об'єкта который соответствует типу FruitEntity або принадлежит к типу об'єкта который наследуется от FruitEntity</span>
<span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">exist</span><span class="token punctuation">(</span><span class="token class-name">Example</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">FruitEntity</span><span class="token punctuation">&gt;</span></span> example<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> fruitRepository<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Реалізуйте такі самі методи у класі ProviderService. Потім використовуйте їх у класі <em>InitiateUtils</em> для <em>FruitEntity</em> та <em>ProviderEntity</em> , результат виведете в консоль. (До речі, якщо ви не знали швидко написати “System.out.println()” можна якщо набрати sout і натиснути ентер, таже штука працює з “public static void main(String[] args){}” достатньо набрати psvm ну <a href="https://xn----htbdsuo3h.xn--p1ai/%D0%B3%D0%BE%D1%80%D1%8F%D1%87%D0%B8%D0%B5-%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D1%88%D0%B8-%D0%B2-intellij-idea/" target="_blank" rel="nofollow">і так далі</a> ). Я думаю, ви вже впоралися і ми готові йти далі. Давайте зайдемо в інтерфейс <em>FruitRepository</em> і почнемо в ньому набирати (саме набирати, а не копіювати) наступний метод: List&lt;FruitEntity&gt; f Повинна вийти наступна штука <img width="800" height="500" data-id="e1068275-8299-473e-9a3c-9ec67faba7e6" alt="Spring - це не страшно, або як поставити питання БД - 2" src="https://cdn.javarush.com/images/article/e1068275-8299-473e-9a3c-9ec67faba7e6/1080.jpeg"> Просто називаєте метод як складаєте запит: findById(Integer id) - знайде об'єкт по id; countFruitEntityByFruitName(String name) - порахує кількість фруктів із певним ім'ям; Це <a href="https://sysout.ru/spring-data-jpa-zaprosy-generiruemye-po-imeni-metoda/" target="_blank" rel="nofollow">запити, що генеруються на ім'я методу,</a> обов'язково почитайте про них і реалізуйте в класі <em>FruitService</em> метод <em>between(Integer from, Integer to)</em> для пошуку List&lt;FruitEntity&gt; за значеннями поля <em>provider_code</em>що входять у певний інтервал, результат роботи виведете в консоль. Наприклад: знайти всі фрукти, у яких номер постачальника знаходиться між 5 і 7. Не поспішайте читати далі, доки не реалізуєте метод, це не довго. Як ви могли прочитати у статті про запити на ім'я методу: «Усі запити так не напишеш, але прості можна.» Для більш складних запитів використовується анотація @Query і замість SQL тут використовується <a href="https://ru.bmstu.wiki/JPQL_(Java_Persistence_Query_Language)" target="_blank" rel="nofollow">JPQL</a> (теж візьміть на замітку цю статтю), для нашого проекту можна зробити JOIN запити так: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>repositories</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">JpaRepository</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">Query</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Repository</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">ru<span class="token punctuation">.</span>java<span class="token punctuation">.</span>rush<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">FruitEntity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">FruitRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FruitEntity</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"select f.fruitName, p.providerName from  FruitEntity f left join ProviderEntity p on f.providerCode = p.id"</span><span class="token punctuation">)</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">joinSting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></code></pre> Стандартний SQL запит був би таким: <em>"select fruit_table.fruit_name, provider_table.provider_name з fruit_table left join provider_table on fruit_table.provider_code = provider_table.id". </em> Тут легко можна встановити відповідність: f <em>ruit_table</em> це <em>FruitEntiy f,</em> де <em>FruitEntiy</em> це тип змінної, <em>f</em> це її найменування, тобто SQL працює з таблицями та полями, а JPQL з об'єктами та їх полями. Знову ж таки <em>fruit_table.fruit_name</em> це <em>f.fruitName</em> ; Так як ми працюємо з об'єктами, то можемо і об'єкт вивести: Напишемо ще один метод FruitRepository 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"select f from  FruitEntity f  join ProviderEntity p on f.providerCode = p.id"</span><span class="token punctuation">)</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FruitEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">joinFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> Реалізуємо обидва методи у класі FruitService 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">joinString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span> fruitRepository<span class="token punctuation">.</span><span class="token function">joinSting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FruitEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">joinFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> fruitRepository<span class="token punctuation">.</span><span class="token function">joinFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> Звучить непогано, але все одно для складних запитів використовують старий добрий SQL 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span>
        value <span class="token operator">=</span> <span class="token string">"select fruit_table.fruit_name, provider_table.provider_name from  fruit_table  join provider_table on fruit_table.provider_code = provider_table.id_provider"</span><span class="token punctuation">,</span>  <span class="token comment">//по идее эту портянку надо засунуть в якой нибудь  Enum</span>
        nativeQuery <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">//нужно только пометить только nativeQuery = true</span>
<span class="token class-name">ListList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">joinSqlFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> І використовуємо їх усіх у класі <em>InitiateUtils</em>
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"\nТаблица фруктов и их поставщиков"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> join <span class="token operator">:</span> fruitService<span class="token punctuation">.</span><span class="token function">joinString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>join<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"\nТаблица фруктов и их поставщиков"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">FruitEntity</span> join <span class="token operator">:</span> fruitService<span class="token punctuation">.</span><span class="token function">joinFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>join<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"\nТаблица фруктов и их поставщиков"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> join <span class="token operator">:</span> fruitService<span class="token punctuation">.</span><span class="token function">joinSqlFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>join<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span></code></pre> Запускаємо проект і бачимо в консолі нові логи: <em>Таблиця фруктів і їх постачальників 2, fruitName=Fruit2, providerCode=5) FruitEntity(id=3, fruitName=Fruit3, providerCode=2) FruitEntity(id=4, fruitName=Fruit4, providerCode=5) Таблиця фруктів та їх постачальників Fruit2,Provider4 Fruit ,Provider5 </em> Так, якщо вам вже набридли "псевдо" і просто SQL запити в консолі, можете в ямл файлі повернути false на місце. Чому в першій таблиці є null, це ви дізнаєтеся, якщо почитаєте про <a href="https://sql-academy.org/ru/guide" target="_blank" rel="nofollow">JOIN SQL</a>. І так, із запитами до БД ми закінчабо, я впевнений, що у вас залишилося багато питань, але я сподіваюся, що ви шукатимете на них відповіді, шляхи пошуку я спробував підсвітити. Давайте спробуємо з резюмувати все, що ми дізналися за цей час: 1. Можна запустити веб-сервер на Spring і це не складно. 2. Для розуміння як це все працює необхідно поринути в теорію. 3. А щоб розуміння перейшло у фізичний код треба кодити, і перш ніж йти далі, набийте руку на простих проектах на spring <a href="https://codegym.cc/groups/posts/spring-framework-java-1" target="_blank" rel="nofollow">- </a><a href="https://codegym.cc/groups/posts/1763-36-urovenjh---tozhe-ne-nashjel-otvetih-na-voprosih-iz-sobesedovaniy" target="_blank" rel="nofollow">boot </a><a href="https://codegym.cc/groups/posts/537-post-blagodarnosti-i-vpechatlenija-ot-spring-in-action" target="_blank" rel="nofollow">. </a> І краще не копіювати написаний код, а переписувати його. Я викладу проект, який ми з вами паболи сюди, але сподіватимусь на вашу свідомість і впевнений ви не бездумно копіпаститимете. <a href="https://bitbucket.org/FromJava/jd/src/master/" target="_blank" rel="nofollow">Посилання на репозиторій</a><a href="https://codegym.cc/groups/posts/spring-framework-java-1" target="_blank" rel="nofollow"></a> <a href="https://codegym.cc/groups/posts/1763-36-urovenjh---tozhe-ne-nashjel-otvetih-na-voprosih-iz-sobesedovaniy" target="_blank" rel="nofollow"></a><a href="https://bitbucket.org/FromJava/jd/src/master/" target="_blank" rel="nofollow"></a> git clone https://FromJava@bitbucket.org/FromJava/jd.git <a href="https://codegym.cc/groups/posts/2818-podruzhim-git-s-intellij-idea" target="_blank" rel="nofollow">Для тих хто не знає як користуватися цим посиланням</a> Рекомендую реалізувати два тренувальні проекти: <strong>Проект про фарбування машин:</strong> Перший клас: <em>CarEntity{ Integer id; String modelName; String color; }</em> Другий клас: <em>ColorEntity { Integer id; String color; Integer price; }</em> Наповніть базу (придумайте реалістичні назви так буде легше для розуміння), реалізуйте: , entity, repositories, services, створіть стандартні та міжтабличні запити (Скільки коштує фарбування BMW у червоний колір? Який колір найдорожчий? тощо); <strong>Проект про бібліотеку:</strong> Перший клас: <em>BookEntity{ Integer id; String nameBook; Integer yearCreat; Integer autorId; }</em> Другий клас: <em>AutorEntity { Integer id; String firstNameAutor; String lastNameAutor; }</em> Наповніть базу (придумайте реалістичні назви так буде легше для розуміння), реалізуйте: entity, repositories, services, створіть стандартні та міжтабличні запити (Хто написав яку книгу? Яка книга написана раніше за всіх? Які книги були написані з 1800 по 1900? Хто з авторів написав найбільше книг?); Приклади для заповнення бази проекту <strong>"Бібліотека"</strong> <em>Таблиця книг BookEntity(id=1, nameBook=Горе від розуму, yearCreat=1824, authorId=1) BookEntity(id=2, nameBook=Війна та мир, yearCreat=1863, authorId=2) BookEntity(id=3, nameBook= Мцирі, yearCreat=1838, authorId=3) BookEntity(id=4, nameBook=Євгеній Онєгін, yearCreat=1833, authorId=4) Таблиця авторів AuthorEntity(id=1, firstNameAuthor=Александр, lastNameAuthor= , firstNameAuthor=Лев, lastNameAuthor=Толстой) AuthorEntity(id=3, firstNameAuthor=Михайло, lastNameAuthor=Лермонтів) AuthorEntity(id=4, firstNameAuthor=Олександр, lastNameAuthor=Пушкін) Всім</em> удачі <a href="https://codegym.cc/groups/posts/3102-spring--ehto-ne-strashno-ili-kratkostjh-sestra-talanta" target="_blank" rel="nofollow">!</a>