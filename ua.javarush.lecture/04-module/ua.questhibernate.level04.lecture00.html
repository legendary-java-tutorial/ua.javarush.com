Типи даних у SQL
<p>----------------------------------------</p>
Знайомство з типами даних у SQL.
Числові типи в SQL.
Рядкові типи в SQL.
Тимчасові типи SQL.
Зберігання об'єктів у SQL.
<p>----------------------------------------</p>
<h2>Знайомство з типами даних у SQL</h2>
 
<p>На відміну від мови JavaScript, у мові SQL є сувора типізація. У кожній таблиці кожна колонка має свій власний жорстко фіксований тип даних. </p>
 
Типів даних дуже багато, але на відміну від мови Java, тут їх так багато не тому, що є типи даних на всі випадки життя. Бази даних дуже залежать від розміру даних, тому багато типів даних відрізняються один від одного лише довжиною.</p>
 
<p>Усього типи даних можна розбити на 5 груп: </p>

<ul>
<li><strong>Числові</strong> типи</li>
<li><strong>Строкові</strong> типи</li>
<li>Типи для зберігання <strong>дати</strong> та <strong>часу</strong></li>
<li>Об'єкти: зазвичай представлені як <strong>набір байт</strong></li>
<li><strong>Транспортні</strong>: JSON та XML</li>
</ul>

<p>Зазвичай різні СУБД мають свої власні типи даних. Кожна СУБД має свою спеціалізацію, тому додавання нових типів даних – дуже поширена річ. </p>

<p>Інша справа, просто додати новий тип даних недостатньо, потрібно додати і функції, які будуть з ним працювати, а також зробити цю роботу зручною та швидкою.</p>
 
<p>Якщо ти працюватимеш на якійсь промисловій (enterprise) СУБД, то швидше за все тобі доведеться розбиратися з її типами даних та її функціями. Для чого потрібно буде прочитати 2-5 хороших книжок.</p>
  
<p>Ми в рамках знайомства з SQL розглянемо три основні групи типів даних: </p>

<ul>
<li>Числа</li>
<li>Рядки</li>
<li>Дати</li>
</ul>

<h2>Кількісні типи в SQL </h2>

<p>У мові SQL числові типи поділяються на три групи: </p>

<ul>
<li>Цілі типи</li>
<li>Числа з фіксованою комою (фіксована кількість знаків після коми)</li>
<li>Числа з плаваючою комою</li>
</ul>

<p>Почнемо з <strong>цілих чисел</strong>. Їх лише 5, і вони можуть бути описані однією таблицею: </p>

<table>
<tbody>
<tr>
<th># </th>
<th>Ім'я типу </th>
<th>Довжина в байтах </th>
<th>Аналог з Java</th>
<th>Мінімальне значення</th>
<th>Максимальне значення</th>
</tr>
<tr>
<td>1 </td>
<td>TINYINT </td>
<td>1 </td>
<td>byte </td>
<td>-128</td>
<td>127 </td>
</tr>
<tr>
<td>2 </td>
<td>SMALLINT </td>
<td>2 </td>
<td>short </td>
<td>-32,768</td>
<td>32,767</td>
</tr>
<tr>
<td>3 </td>
<td>MEDIUMINT </td>
<td>3 </td>
<td></td>
<td>-8,388,608</td>
<td>8,388,607</td>
</tr>
<tr>
<td>4 </td>
<td>INT </td>
<td>4 </td>
<td>int </td>
<td>-2,147,483,648</td>
<td>2,147,483,647</td>
</tr>
<tr>
<td>5 </td>
<td>BIGINT </td>
<td>8 </td>
<td>long </td>
<td>-2<sup>63</sup> </td>
<td>2<sup>63-1</sup> </td>
</tr>
</tbody>
</table>

<p>Типи даних дуже схожі на типи даних у Java, проте тут є ще один тип integer довжиною три байти. Так зроблено для можливості заощаджувати на розмірі.</p>
 
<p>Далі йдуть <strong>типи з плаваючою комою</strong>, як і в Java, їх всього два: </p>

<table>
<tbody>
<tr>
<th>#</th>
<th>Ім'я типу </th>
<th>Довжина в байтах </th>
<th>Аналог з Java</th>
<th>Мінімальне значення</th>
<th>Максимальне значення</th>
</tr>
<tr>
<td>1 </td>
<td>FLOAT </td>
<td>4 </td>
<td>float </td>
<td>-3.40E+38 </td>
<td>+1.18E+38</td>
</tr>
<tr>
<td>2 </td>
<td>DOUBLE </td>
<td>8 </td>
<td>doble </td>
<td>-1.79E+308 </td>
<td>+1.79E+308</td>
</tr>
</tbody>
</table>
 
<p>Знову-таки нічого нового. Все, як і в Java. Однак, на відміну від Java, у SQL є ще один спеціальний тип – речове число з фіксованою комою. Називається воно DECIMAL.</p>
  
<p>Зазвичай, цей тип використовується для зберігання сум грошей. Коли пишеться назва цього типу, після нього зазвичай вказується, скільки в кількості десяткових знаків до коми і після коми. Загальний формат має такий вигляд: </p>
 
    <div class="lesson-example lesson-example-center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-red">DECIMAL</span>(<span class="text-green">всього_знаків</span>, <span class="text-user">після_комою</span>) </ code></pre>
    </div>

<p>І невеликий приклад:</p>
 
    <div class="lesson-example lesson-example-center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-green">salary</span> <span class="text-red">DECIMAL(<span class="text-user">5</span>,<span class="text- user">2</span>)</span> </code></pre>
    </div>

<p>Так ми описали те, що колонка salary може містити цілі числа (максимум 3 знаки до коми) і дрібну частину – 2 знаки після коми. </p>

<p>Максимальна кількість символів, яка підтримує тип DECIMAL – 65. </p>

<h2>Строкові типи в SQL</h2>
 
<p>Рядки в базі даних можуть зберігатися у двох видах: </p>

<ul>
<li>Рядки з фіксованою довжиною</li>
<li>Рядки зі змінною довжиною</li>
</ul>

<p>Рядки з <strong>фіксованою довжиною</strong> задаються типом <strong>CHAR</strong>:</p>
 
    <div class="lesson-example lesson-example-center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-red">CHAR</span>(<span class="text-user">довжина</span>) </code></pre>
    </div>

<p>Фіксована довжина означає, що всі значення цієї колонки будуть містити строго фіксовану кількість символів. </p>

<p>Приклад рядка з фіксованою довжиною: </p>
 
    <div class="lesson-example lesson-example-center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-green">country_code</span> <span class="text-red">CHAR(<span class="text-user">2</span>)</span> </code ></pre>
    </div>

<p>Рядки з <strong>змінною довжиною</strong> задаються типом <strong>VARCHAR</strong>:</p>
 
    <div class="lesson-example lesson-example-center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-red">VARCHAR</span>(<span class="text-user">макс_довжина</span>) </code></pre>
    </div>

<p>Змінна довжина означає, що всі значення цієї колонки будуть містити текст будь-якої довжини, але не більше, ніж максимальна довжина. </p>

<p>Приклад рядка зі змінною довжиною:</p>
 
    <div class="lesson-example lesson-example-center">
    <pre class="lecture-code lecture-code--present language-java"><code>
<span class="text-green">phone</span> <span class="text-red">VARCHAR(<span class="text-user">12</span>)</span> </code ></pre>
    </div>

<p>У рядків із фіксованою довжиною є дуже велика перевага. Якщо клієнт попросив SQL-сервер повернути йому 1,000,000-й рядок з таблиці, а в таблиці рядка фіксованої довжини, то, знаючи довжину рядка, можна легко обчислити байти, які відносяться до рядка.</p>
 
<p>У випадку зі змінною довжиною рядків, так швидко знайти потрібний рядок таблиці не вийде. Згадай швидкість доступу до ArrayList та LinkedList, тут приблизно схожа ситуація.</p>
 
<p>Давай порівняємо, як зберігатимуться рядки різної довжини в таблиці, залежно від типу даних. </p>

<table>
<tbody>
<tr>
<th>Рядок </th>
<th>CHAR(4) </th>
<th>Байт для зберігання </th>
<th></th>
<th>VARCHAR(4) </th>
<th>Байт для зберігання </th>
</tr>
<tr>
<td>'' </td>
<td>''</td>
<td>4 </td>
<td></td>
<td>'' </td>
<td>1 </td>
</tr>
<tr>
<td>'ab' </td>
<td>'ab'</td>
<td>4 </td>
<td></td>
<td>'ab' </td>
<td>3 </td>
</tr>
<tr>
<td>'abcd'</td>
<td>'abcd'</td>
<td>4 </td>
<td></td>
<td>'abcd'</td>
<td>5 </td>
</tr>
<tr>
<td>'abcdefgh'</td>
<td>'abcd'</td>
<td>4 </td>
<td></td>
<td>'abcd'</td>
<td>5 </td>
</tr>
</tbody>
</table>

<p><strong>Примітка.</strong> Тип VARCHAR вимагає на один байт більше за тієї ж довжини, оскільки він змушений додатково зберігати довжину рядка. </p>
 
<h2>Тимчасові типи в SQL</h2>
 
<p>У SQL також є спеціальні типи для зберігання дати та часу. Усього таких типів п'ять: </p>

<table>
<tbody>
<tr>
<th># </th>
<th>Ім'я типу </th>
<th>Аналог з Java DateTime API</th>
<th>Приклад </th>
<th>Мінімальне значення</th>
<th>Максимальне значення</th>
</tr>
<tr>
<td>1 </td>
<td>DATE </td>
<td>LocalDate </td>
<td>‘2022-06-30’ </td>
<td> ‘1000-01-01’ </td>
<td>'9999-12-31'</td>
</tr>
<tr>
<td>2 </td>
<td>TIME </td>
<td>LocalTime </td>
<td>'hh:mm:ss[.fraction]' </td>
<td>'-838:59:59.000000' </td>
<td>'838:59:59.000000' </td>
</tr>
<tr>
<td>3 </td>
<td>DATETIME </td>
<td>LocalDateTime </td>
<td></td>
<td>‘1000-01-01 00:00:00.000000’ </td>
<td>'9999-12-31 23:59:59.999999' </td>
</tr>
<tr>
<td>4 </td>
<td>TIMESTAMP </td>
<td>Date </td>
<td></td>
<td>'1970-01-01 00:00:01.000000' </td>
<td>'2038-01-19 03:14:07.999999' </td>
</tr>
<tr>
<td>5 </td>
<td>YEAR </td>
<td></td>
<td></td>
<td>1901</td>
<td>2155</td>
</tr>
</tbody>
</table>

<p>Всі дані у запитах записуються у вигляді рядка – в одинарних лапках. Формат запису йде від більшого до меншого: </p>

<ul>
<li>Рік</li>
<li>Місяць</li>
<li>День</li>
<li>Година</li>
<li>Хвилина</li>
<li>Секунда</li>
<li>Долі секунд</li>
</ul>

<p>Типи DATE, TIME та DATETIME можна умовно вважати аналогами типів з Java DateTme API: LocalDate, LocalTime, LocalDateTime. Логіка приблизно та сама.</p>
 
<p>Тип TIMESTAMP зберігає дані у вигляді мілісекунд, що від початку 1970 року (стандарт операційної системи UNIX). Саме в такому вигляді їх зберігає тип Date у мові Java.</p>
 
<p>Ну і нарешті є тип YEAR, довжина якого 1 байт і який зберігає значення від 1 до 255. Тому доступний йому діапазон років - це 1901-2155. Рік 1900 цей тип зберігати не може, оскільки значення 0 використовується для кодування NULL.</p>
 
<h2>Зберігання об'єктів у SQL</h2>
 
<p>Для зберігання об'єктів або текстів великої довжини є спеціальні типи. Особливо їх розбирати не будемо, але я все ж таки їх перерахую: </p>
 
<table>
<tbody>
<tr>
<th>#</th>
<th>Ім'я типу </th>
<th>Пояснення </th>
</tr>
<tr>
<td>1 </td>
<td>TEXT </td>
<td>Використовується для зберігання текстів великої довжини. При порівнянні та сортування цього поля використовується тільки перші 100 символів. </td>
</tr>
<tr>
<td>2 </td>
<td>BLOB </td>
<td>Назва розшифровується як Byte Large Object. Зберігається як просто набору байт. Можна використовувати, щоб, наприклад, зберігати в базі даних зображення. </td>
</tr>
<tr>
<td>3 </td>
<td>CLOB </td>
<td>Назва розшифровується як Char Large Object. Використовується для збереження великої довжини текстів. </td>
</tr>
<tr>
<td>4 </td>
<td>ENUM </td>
<td>Дозволяє встановити фіксований набір значень і зберігати як значення одне з них. </td>
</tr>
<tr>
<td>5 </td>
<td>SET </td>
<td>Дозволяє задати фіксований набір значень і зберігати як значення будь-яке їхнє підмножина. Зазвичай зберігає їх як бінарну маску. </td>
</tr>
</tbody>
</table>
 
<p>Теоретично ти можеш будь-який Java-об'єкт серіалізувати у вигляді набору байт та зберегти його у базі даних у тип BLOB. Зберегти об'єкт – не проблема. Як із ним працювати далі? </p>

<p>Припустимо, таблиця зберігає мільйон об'єктів у серіалізованому вигляді – як ти виконуватимеш по них пошук? СУБД лише тоді підтримує певний тип даних, коли надає великий набір функцій до роботи з ним.</p>