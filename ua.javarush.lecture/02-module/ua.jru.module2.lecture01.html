Вітання! Сьогоднішню лекцію присвятимо інкапсуляції і почнемо її одразу з прикладів :) <img data-id="cd065697-891d-46fe-9429-a3bf741cf71f" data-max-width="850" alt="Принципи інкапсуляції." src="https://cdn.javarush.com/images/article/cd065697-891d-46fe-9429-a3bf741cf71f/800.jpeg" style="width: 850px;">Перед тобою – <em>звичний автомат із газуванням</em> . У мене до тебе одне запитання: як він працює? Спробуй докладно відповісти: звідки вивалюється склянка, як підтримується температура всередині, де зберігається лід, як автомат розуміє, який сироп додати і т.д. Найімовірніше, відповіді на ці питання в тебе немає. Добре, можливо, не всі користуються такими автоматами, нині вони не настільки популярні. Спробуємо навести інший приклад. Що-небудь, чим ти точно користуєшся багато разів щодня. О, є ідея! <img data-id="3a3c8ba1-d3e2-4818-8766-d840c278e19b" data-max-width="850" alt="Принципи інкапсуляції." src="https://cdn.javarush.com/images/article/3a3c8ba1-d3e2-4818-8766-d840c278e19b/800.jpeg" style="width: 850px;"> Розкажи, як працює <em>пошуковик Google</em>. Як саме він шукає інформацію за тими словами, які ти ввів? Чому нагорі ці результати, а не інші? Хоча ти користуєшся гуглом щодня, швидше за все, ти цього не знаєш. Але це не важливо. <strong>Адже тобі й не треба цього знати. </strong> Ти можеш вводити запити до пошукової системи не замислюючись, як саме вона працює. Ти можеш купити газовану машину в автоматі, не знаючи як він влаштований. Ти можеш водити машину, не вникаючи в роботу двигуна внутрішнього згоряння, і взагалі не знаючи фізики навіть на шкільному рівні. Все це можливо завдяки одному з основних принципів об'єктно-орієнтованого програмування - <strong>інкапсуляції</strong> . Читаючи різні статті на цю тему, напевно, ти стикався з тим, що в програмуванні є два поширені поняття - <strong>інкапсуляція</strong> і<strong>приховування</strong> . І під словом «інкапсуляція» автори розуміють то одне, то інше (так уже склалося). Ми розберемо обидва терміни, щоб у тебе було повне розуміння. Початкове значення слова « <em>інкапсуляція</em> » у програмуванні - <strong>поєднання даних та методів роботи з цими даними в одній упаковці</strong> («капсулі»). У Java в ролі упаковки-капсули виступає <em>клас</em> . Клас містить у собі <em>дані</em> (поля класу), і <em>методи</em> до роботи з цими даними. <img data-id="5fe85c7c-7d12-4195-aca8-111e1c0992d9" data-max-width="850" alt="Принципи інкапсуляції - 3" src="https://cdn.javarush.com/images/article/5fe85c7c-7d12-4195-aca8-111e1c0992d9/800.jpeg" style="width: 850px;"> Тобі це здається очевидним, але в інших концепціях програмування все влаштовано інакше. Наприклад, у функціональному програмуванні дані суворо відокремлені від операцій з них. В ООП ж (об'єктно-орієнтованому програмуванні) програми складаються з класів-капсул, які є одночасно і даними, і функціями для роботи з ними. Тепер поговоримо про <strong>приховання</strong> . Як же так виходить, що ми користуємось усілякими складними механізмами без розуміння, як вони влаштовані і на чому ґрунтується їхня робота? Все просто: їх творці надали простий та зручний <strong>інтерфейс</strong>. На автоматі з газованою інтерфейс - це кнопки на панелі. Натиснувши одну кнопку, ти вибираєш об'єм склянки. Натиснувши другу, вибираєш сироп. Третя відповідає за додавання льоду. І це все, що потрібно зробити. Неважливо, як саме автомат влаштований усередині. Головне - <strong>він влаштований так, що для отримання газування користувачеві потрібно натиснути три кнопки</strong> . Те саме і з автомобілем. Не має значення, що там відбувається у нього всередині. Головне - <strong>при натисканні правої педалі автомобіль їде вперед, а при натисканні лівої - гальмує</strong> . Саме в цьому полягає суть приховання. Всі «начинки» програми ховаються від користувача. Для нього ця інформація є зайвою, непотрібною. Користувачеві необхідний кінцевий результат, а не внутрішній процес. Давай для прикладу подивимося на клас <code>Auto</code>: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Auto</span> <span class="token punctuation">{</span>

   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">gas</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

       <span class="token comment">/*всередині автомобіля відбуваються якісь складні речі
       внаслідок яких він їде вперед*/</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">brake</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

       <span class="token comment">/*всередині автомобіля відбуваються якісь складні речі
       внаслідок яких він гальмує*/</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

       <span class="token class-name">Auto</span> auto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Auto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">//Як все виглядає для користувача</span>

       <span class="token comment">//натиснув одну педаль - поїхав</span>
       auto<span class="token punctuation">.</span><span class="token function">gas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">//натиснув іншу педаль - загальмував</span>
       auto<span class="token punctuation">.</span><span class="token function">brake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> Ось як виглядає приховування реалізації Java-програмі. Все як у реальному житті: користувачеві надано інтерфейс (методи). Якщо йому потрібно, щоб автомобіль у програмі здійснив дію, достатньо викликати потрібний метод. А що там відбувається всередині цих методів — інформація зайва, головне, щоб усе працювало як слід. Тут ми говорабо про <strong>приховування реалізації</strong> . Крім нього в Java є ще <strong>приховування даних</strong> . Про нього ми писали в <a href="https://codegym.cc/groups/posts/1928-getterih-i-setterih" target="_blank">лекції про гетери та сетери</a> , але не зайвим нагадати. Наприклад, у нас є клас <code>Cat</code>: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>

   <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
   <span class="token keyword">public</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
   <span class="token keyword">public</span> <span class="token keyword">int</span> weight<span class="token punctuation">;</span>

   <span class="token keyword">public</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token keyword">int</span> weight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>weight <span class="token operator">=</span> weight<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sayMeow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Мяу!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>


<span class="token punctuation">}</span></code></pre> Можливо, ти запам'ятав із минулої лекції, у чому проблема цього класу? Якщо ні – давай згадаємо. Проблема в тому, що його дані (поля) відкриті для всіх, і інший програміст легко може створити у програмі безіменного кота з вагою 0 та віком -1000 років: 
<pre class=" line-numbers language-java" tabindex="0"><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span><code class=" language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

   <span class="token class-name">Cat</span> cat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   cat<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
   cat<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1000</span><span class="token punctuation">;</span>
   cat<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></code></pre> У такій ситуації можна уважно стежити за тим, чи хтось із твоїх колег об'єктів з неправильним станом створює, але набагато краще було б виключити саму можливість створювати такі «неправильні об'єкти». <img data-id="70d6b15d-d3a7-4cee-b562-4a9537ab78d0" data-max-width="850" alt="Принципи інкапсуляції - 4" src="https://cdn.javarush.com/images/article/70d6b15d-d3a7-4cee-b562-4a9537ab78d0/800.jpeg" style="width: 850px;"> З приховуванням даних нам допомагають: 
<ol>
 <li>модифікатори доступу ( <em>private</em> , <em>protected</em> , <em>package default</em> );</li>
 <li>гетери та сетери.</li>
</ol> Туди можемо, наприклад, закласти перевірку, чи хтось намагається привласнити коту негативне число як вік. Як ми говорабо раніше, автори різних статей про інкапсуляцію мають на увазі або інкапсуляцію (об'єднання даних і методів), або приховування, або те й інше. У Java присутні обидва механізми (в інших ООП-мовах це не обов'язково так), тому останній варіант буде найбільш правильним. Використання інкапсуляції дає нам кілька важливих переваг: 
<ol>
 <li><strong>Контролює коректний стан об'єкта. </strong>Приклади цього були вищими: завдяки сеттеру та модифікатору private, ми убезпечабо нашу програму від котів з вагою 0.</li>
 <br>
 <li><strong>Зручність користувача за рахунок інтерфейсу. </strong>Ми залишаємо "зовні" для доступу користувача лише методи. Йому достатньо викликати їх, щоб отримати результат, і зовсім не потрібно вникати в деталі їхньої роботи.</li>
 <br>
 <li><strong>Зміни коду не відображаються на користувачах. </strong>Усі зміни ми проводимо усередині методів. На користувача це не вплине: він як писав auto.gas() для газу машини, так і писатиме. А те, що ми змінабо щось у роботі методу gas(), для нього залишиться непомітним: він, як і раніше, просто отримуватиме потрібний результат.</li>
</ol>