Змінні-посилання у Java
<p>----------------------------------------</p>
Змінні-посилання. У мові Java є змінні двох видів: змінні примітивного типу і всі інші. От про «всі інші» ми зараз і поговоримо. Насправді точнішим буде таке визначення: є змінні примітивного типу (primitive type variables), і є вказівні змінні (reference variables).
<p>----------------------------------------</p>
<div class="lesson-carousel lesson-carousel--comics">
    <div class="lesson-carousel__list">
        <div class="lesson-carousel__item">
            <img data-id="35297677-17a3-42ad-963e-88407198b228" src="https://cdn.javarush.com/images/article/35297677-17a3-42ad-963e-88407198b228/original.png" alt=""/>
        </div>
    </div>
</div>
<hr>
<h2>1. Змінні-посилання</h2>
<p>У мові Java є змінні двох видів: змінні примітивного типу і всі інші. От про «всі інші» ми зараз і поговоримо.</p>
<p>Насправді точнішим буде таке визначення: є змінні примітивного типу (<strong>primitive type variables</strong>), і є вказівні змінні (<strong>reference variables</strong>). То ж це таке — вказівні змінні?</p>
<p>На відміну від примітивних типів, які дозволяють зберігати значення безпосередньо всередині змінних, змінні вказівних типів зберігають <strong>посилання на об'єкти</strong>. Тобто десь у пам'яті є певний об'єкт, а у вказівній змінній (синонім: змінна-посилання) просто зберігається адреса цього об'єкта в пам'яті (посилання).</p>
<p>Значення всередині змінних зберігають <span class="text-green">тільки примітивні типи</span>, <strong>усі</strong> інші типи зберігають лише <span class="text-user">посилання на об'єкт</span>. До речі, ви вже знайомі з двома такими типами змінних — це змінні типу <code>String</code> і змінні типу <span class="term">масив</span>.</p>
<p>І масив, і рядок є об'єктами, які зберігаються десь у пам'яті. Змінні типу <code>String</code> і змінні типу масив зберігають тільки посилання на об'єкти.</p>
<p><img data-id="221f475e-92e7-4a6a-aace-fe35a6ba6e53" src="https://cdn.javarush.com/images/article/221f475e-92e7-4a6a-aace-fe35a6ba6e53/original.png" alt="Змінні-посилання у Java"/></p>
<p>Змінні <code>int a, int b і double d</code> є примітивними і зберігають у собі значення.</p>
<p>Змінна <code>String str</code> — вказівна і зберігає адресу (посилання) об'єкта типу <code>String</code> у пам'яті.</p>
<p>Під час присвоювання значення змінній примітивного типу це значення копіюється (дублюється). А коли відбувається присвоювання значення вказівній змінній, <span class="text-green">копіюється тільки адреса об'єкта</span>, а <span class="text-orange">власне об'єкт</span> <span class="text-red">не копіюється</span>.</p>
<hr>
<h2>2. Сутність посилань</h2>
<p>У чому принципова відмінність вказівних змінних від примітивних?</p>
<p>Примітивна змінна схожа на коробку, де можна зберігати якесь значення. Вказівна змінна більше схожа на аркуш паперу із записаним на ньому номером телефону.</p>
<p><strong>Автомобіль і ключі від автомобіля</strong></p>
<p>Уявіть, що ви вирішили подарувати своєму другові на день народження автомобіль. Ви ж не запакуєте його в коробку і не понесете із собою: автомобіль для цього надто великий.</p>
<p>Значно зручніше взяти з собою тільки ключі від автомобіля і покласти їх в коробку відповідного розміру. А ваш друг і так усе зрозуміє, коли дістане ключі з коробки. Немає потреби приносити автомобіль, коли можна просто передати ключі.</p>
<p><strong>Людина і номер її телефону</strong></p>
<p>Або ще один варіант: людина і номер її телефону. Номер телефону — це не сама людина, але за цим номером можна їй зателефонувати, щось запитати, дати вказівки.</p>
<p>Так само й посилання використовуються для взаємодії з об'єктом. Усі об'єкти взаємодіють один з одним за допомогою посилань. Замість того, щоб «обмінюватися людьми», досить обмінятися номерами телефонів.</p>
<p>Коли присвоюється значення змінній примітивного типу, це значення копіюється (дублюється). А коли присвоюється значення вказівній змінній, копіюється тільки адреса об'єкта («номер телефону»), а власне об'єкт не копіюється.</p>
<p>Посилання мають ще одну перевагу: можна передати посилання на об'єкт у якийсь метод, і тоді метод зможе змінювати цей об'єкт, використовуючи посилання на нього, викликаючи його методи і звертаючись до даних всередині об'єкта.</p>
<hr>
<h2>3. Присвоювання посилань</h2>
<p>Для вказівних змінних операція присвоювання полягає в тому, що змінній просто присвоюється адреса об'єкта в пам'яті. А самі об'єкти в результаті присвоєння не з'являються й не зникають.</p>
<p>Такий підхід дає змогу уникнути копіювання великих обсягів пам'яті. Якщо потрібно кудись передати дуже великий об'єкт, ми просто передамо в цей метод посилання на об'єкт, і все. Посилання займає значно менше місця.</p>
<img data-max-width="1024" data-id="82beaab5-0e54-48bd-8b21-e401dd78f1d0" src="https://cdn.javarush.com/images/article/82beaab5-0e54-48bd-8b21-e401dd78f1d0/1024.jpeg" alt="">
<p>Розмір усіх вказівних змінних (незалежно від типу) однаковий і становить 4 байти (як тип int). Але! Якщо ваша програма працює в 64-розрядній Java-машині, розмір усіх посилань буде 8 байтів (64 біти).</p>
<p>Посилання можна присвоїти лише посиланню. Не можна змінювати посилання чи присвоювати їм довільні значення.</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Опис</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>String <span class="text-user">hello</span> = "Привіт";
String <span class="text-viola">s</span> = <span class="text-user">hello</span>;</code></pre>
        </td>
        <td>Так <span class="text-green">можна</span></td>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>String <span class="text-red">hello</span> = "Привіт";
<span class="text-red">hello</span>++;</code></pre>
        </td>
        <td>А так <span class="text-red">не можна</span></td>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code>String <span class="text-red">hello = 0x1234</span>;</code></pre>
        </td>
        <td>І так <span class="text-red">не можна</span></td>
    </tr>
    </tbody>
</table>
<hr>
<h2>4. Порожнє посилання — <code>null</code></h2>
<p>А що зберігає вказівна змінна, коли їй ще нічого не присвоєно?</p>
<p>Вона зберігає порожнє посилання — <span class="text-red">null</span>. <code>null</code> — це спеціальне ключове слово в Java, яке позначає відсутність посилання (порожнє посилання). Значення <code>null</code> можна присвоїти будь-якій вказівній змінній.</p>
<p>Усі вказівні змінні, доки їм не присвоєно певне посилання, мають значення <code>null</code>.</p>
<p>Приклади:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Опис</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>class Person
{
   public static <span class="text-red">String name</span>;
   public static int age;
}</code></pre>
        </td>
        <td><br/><br/>Змінна <code><span class="text-red">String name</span></code> має значення за замовчуванням: <code>null</code>.<br/> Змінна <code>int age</code> має значення за замовчуванням: <code>0</code>.</td>
    </tr>
    </tbody>
</table>
<p>І для примітивних, і для вказівних типів локальні змінні без значення вважаються неініціалізованими.</p>
<p>Якщо змінна зберігає посилання на певний об'єкт, а ви хочете видалити значення цієї змінної, просто присвойте їй посилання null.</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Опис</th>
    </tr>
    <tr>
        <td>
                <pre class="language-java"><code>String <span class="text-red">s</span> = null;
<span class="text-red">s</span> = "Привіт";
<span class="text-red">s</span> = null;</code></pre>
        </td>
        <td><code><span class="text-red">s</span></code> зберігає посилання <code>null</code>.<br/> <code><span class="text-red">s</span></code> зберігає посилання на об'єкт-рядок<br/> <code><span class="text-red">s</span></code> зберігає посилання <code>null</code></td>
    </tr>
    </tbody>
</table>
<hr>
<h2>5. Передавання посилань у методи</h2>
<p>Якщо параметрами певного методу є <span class="term">вказівні змінні</span>, то значення передаються в такі змінні так само, як і у звичайні. Змінній-параметру просто присвоюється значення іншої змінної.</p>
<p>Приклад:</p>
<table>
    <tbody>
    <tr>
        <th>Код</th>
        <th>Опис</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>class Solution
{
   public static void <span class="text-red">fill</span>(String[] <span class="text-orange">array</span>, String <span class="text-green">value</span>)
   {
      for (int i = 0; i &lt; <span class="text-orange">array</span>.length; i++)
        <span class="text-orange">array</span>[i] = <span class="text-green">value</span>;
   }

   public static void main(String[] args)
   {
     String[] <span class="text-user">data</span> = new String[<span class="text-user">10</span>];
     <span class="text-red">fill</span>(<span class="text-user">data</span>, <span class="text-green">"Hello"</span>);
   }
}</code></pre>
        </td>
        <td><br/><br/>Метод <code><span class="text-red">fill</span></code> заповнює переданий масив <code><span class="text-orange">array</span></code> переданим значенням <code><span class="text-green">value</span></code>.</td>
    </tr>
    </tbody>
</table>
<p>Коли викликається метод <code><span class="text-red">fill</span></code>, змінній <code><span class="text-orange">array</span></code> присвоюється посилання на масив <code><span class="text-user">data</span></code>. Змінній <code><span class="text-green">value</span></code> присвоюється посилання на об'єкт-рядок «Hello».</p>
<p>Отака ситуація буде в пам'яті <strong>перед викликом методу</strong> <code><span class="text-red">fill</span></code>:</p>
<img data-max-width="1024" data-id="19f47474-e90c-4354-bee9-c347227a91bc" src="https://cdn.javarush.com/images/article/19f47474-e90c-4354-bee9-c347227a91bc/1024.jpeg" alt="">
<p><span>Отака ситуація буде в пам'яті <strong>під час виконання методу</strong> <code><span class="text-red">fill</span></code></span><span>:</span></p>
<img data-max-width="1024" data-id="dfbfe3f5-a64c-40f9-87bf-cc0bd41161f2" src="https://cdn.javarush.com/images/article/dfbfe3f5-a64c-40f9-87bf-cc0bd41161f2/1024.jpeg" alt="">
<p>Змінні <code><span class="text-user">data</span></code> і <code><span class="text-orange">array</span></code> посилаються (зберігають посилання) на один і той самий масив-контейнер у пам'яті.</p>
<p>Змінна <code><span class="text-green">value</span></code> зберігає посилання на об'єкт-рядок <code>Hello</code>.</p>
<p>У комірках масиву також зберігаються просто посилання на об'єкт <code>Hello</code>.</p>
<p>Фактично об'єкти не дублюються — відбувається тільки копіювання посилань.</p>
<hr>
<div class="task-widget-container" showCover="true" taskKey="ua.javarush.task.pro.task07.task0710"></div>
<div class="task-widget-container" showCover="true" taskKey="ua.javarush.task.pro.task07.task0711"></div>
<hr>
<h2>6. Порівняння з мовою С/С++</h2>
<p>Іноді Java-програмістів на співбесідах запитують: як у Java передаються дані в методи? Часом ще й уточнюють: за посиланням чи за значенням?</p>
<p>Це питання походить з мови С++ — <span class="text-orange">у мові Java воно не має сенсу</span>. У мові Java змінним-параметрам завжди просто присвоюються значення змінних-аргументів. Отже, правильна відповідь — <span class="text-red">за значенням</span>.</p>
<p>Але будьте готові до того, щоб <strong>пояснити свою думку</strong>, тому що вам можуть заперечити, що «примітивні типи передаються за значенням, а вказівні — за посиланням».</p>
<p>Ця проблема пов'язана з тим, що багато Java-програмістів були в минулому програмістами С++. А там питання «як передаються параметри в методи» відігравало дуже важливу роль.</p>
<p>У Java все однозначно: примітивні типи зберігають значення, вказівні теж зберігають значення — посилання. Річ у тім, що саме вважати <strong>значенням</strong> змінної.</p>
<p>У мові C++ змінні можуть зберігати як посилання на об'єкт, так і сам об'єкт. Це також стосується примітивних типів: у змінній можна зберігати значення або оголосити змінну посиланням на тип <code>int</code>. Тому, щоб не заплутатися, програмісти С++ завжди називають <span class="term">посилання на об'єкт</span> <span class="term">посиланням</span>, а власне об'єкт — значенням.</p>
<p>У С++ легко може скластися ситуація, коли одна змінна містить об'єкт, а інша — посилання на цей самий об'єкт. Тому питання, що зберігає в собі змінна — сам об'єкт чи тільки посилання на нього, — дуже важливе. Під час передавання об'єкта в метод цей об'єкт копіюється (якщо передається за значенням) або не копіюється (якщо передається за посиланням).</p>
<p>У Java цієї подвійності немає, і правильна відповідь буде така: <strong>у Java параметри передаються в методи за значенням</strong>. Просто у випадку із вказівними змінними це значення — посилання.</p>