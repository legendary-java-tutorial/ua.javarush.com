Правильна робота програми
<p>----------------------------------------</p>
Завдання програміста. Дуже часто програмісти-початківці уявляють собі суть роботи програміста зовсім не так, як досвідчені. Від новачка часто можна почути «Програма працює, що вам ще потрібно?» А от досвідчений програміст знає, що «працює правильно» — це лише одна з вимог
<p>----------------------------------------</p>
<h2>1. Завдання програміста</h2>
<p><img data-id="ca2c2d09-f7e9-48ff-a2f6-263cc39c12c3" data-max-width="856" alt="" src="https://cdn.javarush.com/images/article/ca2c2d09-f7e9-48ff-a2f6-263cc39c12c3/original.png"/></p>
<p>Дуже часто <span class="text-red">програмісти-початківці</span> уявляють собі суть роботи програміста зовсім не так, як <span class="text-green">досвідчені</span>.</p>
<p>Від новачка часто можна почути «Програма працює, що вам ще потрібно?» А от досвідчений програміст знає, що «працює правильно» — це лише <span class="text-orange">одна з вимог до програми</span>, причому навіть <span class="text-red">не найголовніша</span>!</p>
<p><strong>Прочитність коду</strong></p>
<p>Найголовніше — щоб <span class="text-green">код програми могли зрозуміти інші програмісти</span>. Це <span class="text-red">важливіше, ніж програма, яка правильно працює. </span>Набагато важливіше.</p>
<p>Якщо у вас є програма, що працює неправильно, ви можете її виправити, а якщо у вас є програма, код якої незрозумілий, ви нічого не можете з нею зробити.</p>
<p>Просто візьміть будь-яку скомпільовану програму, наприклад Notepad (блокнот), і змініть у ній колір фону на червоний. Працююча програма у вас є, зрозумілого коду програми — немає: у таку програму неможливо вносити зміни.</p>
<p>Хрестоматійний приклад — коли розробники Microsoft прибрали з Windows гру Pinball, оскільки не змогли перенести її на 64-розрядну архітектуру. Причому в них навіть були вихідні коди цієї гри. Просто вони <a href="https://habr.com/ru/post/163105/">не могли зрозуміти</a>, як працює написаний код.</p>
<p><strong>Урахування всіх сценаріїв використання</strong></p>
<p>Друга за важливістю вимога до програми — це врахування всіх сценаріїв її роботи. Часто-густо все виявляється трохи складнішим, ніж здається.</p>
<p>Як програміст-початківець бачить надсилання SMS у своїй програмі:</p>
<p><img data-max-width="1024" data-id="73357597-8736-4bbe-ab88-7bac0cace96c" src="https://cdn.javarush.com/images/article/73357597-8736-4bbe-ab88-7bac0cace96c/original.png" alt=""></p>
<p>Як це бачить-програміст-професіонал:</p>
<p><img data-max-width="1024" data-id="b1105edc-a7b3-47f9-a008-110efd2c2243" src="https://cdn.javarush.com/images/article/b1105edc-a7b3-47f9-a008-110efd2c2243/original.png" alt=""></p>
<p>А «правильна робота» — це зазвичай лише один із безлічі сценаріїв. І саме тому багато новачків скаржаться на валідатор задач у JavaRush: один сценарій із 10 працює, і програміст-новачок думає, що цього досить.</p>
<hr>
<h2>2. Позаштатні ситуації</h2>
<p><img data-id="31d3ab35-e07d-483d-9152-852ed4731d6a" src="https://cdn.javarush.com/images/article/31d3ab35-e07d-483d-9152-852ed4731d6a/original.png" alt="Позаштатні ситуації"/></p>
<p>Під час роботи будь-якої програми можуть виникати позаштатні ситуації.</p>
<p>Наприклад, ви вирішили зберегти файл, а на диску немає місця. Або програма намагається записати дані в пам'ять, а пам'яті замало. Або ви завантажуєте картинку з інтернету, а в процесі завантаження перервався зв'язок.</p>
<p>Програміст (автор програми) повинен кожну позаштатну ситуацію а) <span class="text-red">передбачити</span>, б) <span class="text-red">вирішити, як саме програма має діяти в цій ситуації</span>, в) <span class="text-green">запрограмувати рішення, максимально близьке до бажаного.</span></p>
<p>Тому доволі довго поведінка програм була дуже простою: <span class="text-red">якщо в програмі ставалася помилка, програма закривалася.</span> І це був досить хороший підхід.</p>
<p>Припустімо, ви хочете зберегти документ на диску і в процесі збереження з'ясовується, що місця на ньому не вистачає. Який варіант поведінки програми вам би сподобався найбільше:</p>
<ul>
    <li>Програма закрилася</li>
    <li>Програма продовжила працювати, але файл не зберегла.</li>
</ul>
<p>Новоспеченому програмісту може здатися, що другий варіант кращий, адже програма працює. Але насправді це не так.</p>
<p>Уявіть, що ви 3 години набирали текст документа у Word, хоча ще на другій хвилині роботи стало зрозуміло, що програма не може зберегти документ на диску. Що краще — втратити дві хвилини роботи чи три години?</p>
<p><span class="text-green">Якщо програма не може зробити те, що потрібно, краще нехай вона закриється, ніж продовжує вдавати, що все гаразд.</span> Найкраще, що може зробити програма в разі збою, який вона не здатна усунути самостійно, — одразу повідомити користувача про наявність проблеми.</p>
<hr>
<h2>3. Передісторія виникнення винятків</h2>
<p>Позаштатні ситуації трапляються не тільки з програмами, а й усередині програми — з методами. Наприклад:</p>
<ul>
    <li>Метод намагається записати файл на диск, а місця немає.</li>
    <li>Метод намагається викликати функцію для змінної, а змінна == null.</li>
    <li>У методі виникло ділення на 0.</li>
</ul>
<p>Водночас у деяких випадках метод, звідки здійснюється виклик, міг би виправити ситуацію (виконати альтернативний сценарій), якби знав, яка саме проблема виникла під час роботи методу, що викликається.</p>
<p>Якщо ми намагаємося зберегти файл на диску і такий файл уже існує, можна просто попросити користувача підтвердити перезапис файлу. Якщо на диску немає місця, можна вивести повідомлення для користувача й запропонувати вибрати інший диск. А якщо закінчилася пам'ять — програма аварійно завершиться.</p>
<p>Колись давно програмісти думали над цим питанням і придумали таке рішення: <span class="text-orange">усі методи/функції мають повертати код помилки як результат своєї роботи. </span>Якщо функція відпрацювала відмінно, вона <span class="text-green">повертала</span> 0, якщо ні — повертала <span class="text-red">код помилки</span> (не нуль).</p>
<p>За такого підходу до помилок програмісту після виклику майже кожної функції потрібно було додавати перевірку, чи не завершилася функція з помилкою. Код програм став значно довшим і схожим на щось таке:</p>
<table>
    <tbody>
    <tr>
        <th>Код без обробки помилок</th>
        <th>Код з обробкою помилок</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>File <span class="text-user">file</span> = new File("ca:\\note.txt");
<span class="text-user">file</span>.<span class="text-red">writeLine</span>("Текст");
<span class="text-user">file</span>.<span class="text-red">close</span>();</code></pre>
        </td>
        <td>
<pre class="language-java"><code>File <span class="text-user">file</span> = new File("ca:\\note.txt");
int <span class="text-green">status</span> = <span class="text-user">file</span>.<span class="text-red">writeLine</span>("Текст");
if (<span class="text-green">status</span> == 1)
{
   ...
}
else if (<span class="text-green">status</span> == 2)
{
   ...
}
status = <span class="text-user">file</span>.<span class="text-red">close</span>();
if (<span class="text-green">status</span> == 3)
{
   ...
}</code></pre>
        </td>
    </tr>
    </tbody>
</table>
<p>Крім того, дуже часто функція, яка «бачила», що сталася помилка, не знала, що з нею робити: помилку потрібно було повернути функції, звідки здійснюється виклик, а та повертала її далі, туди, звідки викликали її саму і т. д.</p>
<p><span class="text-orange">У великій програмі ланцюжок із десятків викликів функцій — це норма: іноді навіть можна стикнутися з глибиною виклику, яка дорівнює сотні функцій. </span>І тоді потрібно передати код помилки із самого низу на самий верх. І якщо десь на цьому шляху якась функція не обробить код завершення, помилка загубиться.</p>
<p>Такий підхід має ще один мінус — якщо функції повертали код помилки, вони більше не могли повертати значення своєї роботи. Доводилося передавати результат обчислень через параметри-посилання. Отож код ставав ще більш громіздким, і кількість помилок збільшувалася.</p>
<hr>
<div class="task-widget-container" showCover="true" taskKey="ua.javarush.task.pro.task14.task1401"></div>