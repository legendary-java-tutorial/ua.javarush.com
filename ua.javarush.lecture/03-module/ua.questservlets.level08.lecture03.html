<h2>Історія появи DNS</h2>
<p>Ще в 70-х роках люди втомабося запам'ятовувати IP-адресаи серверів, до яких хотіли звернутися. Тоді ж з'явилася ідея використати більш просте ім'я, що запам'ятовується, замість числової адресаи хоста.</p>
<p>Працівники Стенфордського дослідницького інституту придумали текстовий файл <span class="text-bold">HOSTS.TXT</span> , який містив список рядкових імен та відповідні числові адресаи комп'ютерів в ARPANET.</p>
<p>Адреси призначалися вручну. Щоб запитити ім'я хоста та адресау або додати комп'ютер до головного файлу, користувачі зв'язувалися з мережним інформаційним центром Стенфорда телефоном у робочий час.</p>
<p>На початку 1980-х років підтримку єдиної централізованої таблиці хостів стало повільним і громіздким, а мережі, що розвивалася, була потрібна автоматична система іменування для вирішення технічних і кадрових питань.</p>
<p>У 1984 році чотири студенти університету Берклі написали першу версію ієрархічної системи доменних імен. В даний час вона широко поширена, особливо в Unix-системах, і, як і раніше, є найбільш широко використовуваним програмним забезпеченням DNS в Інтернеті.</p>
<h2>Знайомство з DNS</h2>
<p><span class="text-bold">Domain Name System (DNS)</span> – це розподільна система для зберігання та отримання інформації про домени. Вона найчастіше використовується для отримання IP-адресаи на ім'я хоста (комп'ютера або пристрою), отримання інформації про маршрутизацію пошти та/або обслуговуючих вузлів для протоколів у домені.</p>
<p>Система організована як певної ієрархії DNS-серверів, взаємодіючих за певним протоколом. Основою розуміння DNS є уявлення про ієрархічну структуру імені та зони.</p>
<p>Кожен сервер, який відповідає за доменну зону, може передати відповідальність за подальшу частину домену іншому серверу, що дозволяє покласти відповідальність за актуальність інформації на сервери різних організацій, які відповідають лише за «свою» частину доменного імені.</p><img data-max-width="512" data-id="d8d8c8aa-923f-477d-a57f-4e8c7753f63d" alt="" src="https://cdn.javarush.com/images/article/d8d8c8aa-923f-477d-a57f-4e8c7753f63d/512.jpeg" style="width: 512px;">
<p>Система DNS містить <span class="text-bold">ієрархію DNS-серверів</span> , що відповідає ієрархії зон. Кожна зона підтримується як мінімум одним авторитетним сервером DNS, на якому розміщено інформацію про домен.</p>
<p><span class="text-bold"><span class="text-red">Важливо! </span></span>Ім'я та IP-адресаа не обов'язково ставляться один до одного як один до одного. Одна IP-адресаа може мати безліч доменних імен, що дозволяє підтримувати на одному комп'ютері безліч веб-сайтів (це називається<span class="text-bold"> віртуальний хостинг</span> ).</p>
<p>Може бути і навпаки - одному доменному імені може бути зіставлено безліч IP-адреса: це дозволяє створювати <span class="text-bold">балансування навантаження і активно використовується в CDN-мережах</span> .</p>
<p>Для підвищення стійкості системи використовують безліч серверів, що містять ідентичну інформацію, а в протоколі є засоби, що дозволяють підтримувати синхронність інформації, розташованої на різних серверах. Існує 13 кореневих серверів, їх адресаи мало змінюються.</p>
<p><span class="text-bold"><span class="text-red">Цікаво! </span></span>Протокол DNS використовує для роботи TCP- або UDP-порт 53 для відповіді запити. Традиційно запити та відповіді надсилаються у вигляді однієї UDP-датаграми. TCP використовується, коли розмір даних відповіді перевищує 512 байт.</p>
<h2>Записи DNS</h2>
<p>DNS-сервер зберігає набір параметрів для кожного доменного імені. Це записи про ім'я домену, його IP-адресау, а також різна службова інформація.</p>
<p>Усього таких записів кілька десятків, тому ми розглянемо лише найпопулярніші з них:</p>
<div class="table-container">
 <table>
  <tbody>
   <tr>
    <td><span class="text-bold">A</span></td>
    <td>Address</td>
    <td>IP-адресаа</td>
   </tr>
   <tr>
    <td><span class="text-bold">AAAA</span></td>
    <td>Address IPv6</td>
    <td>Адреса у форматі IPv6</td>
   </tr>
   <tr>
    <td><span class="text-bold">CNAME</span></td>
    <td>Canonical name</td>
    <td>Канонічне ім'я для псевдоніма</td>
   </tr>
   <tr>
    <td><span class="text-bold">MX</span></td>
    <td>Mail Exchanger</td>
    <td>Адреса поштового шлюзу для домену</td>
   </tr>
   <tr>
    <td><span class="text-bold">NS</span></td>
    <td>name server</td>
    <td>Адреса вузла, що відповідає за доменну зону</td>
   </tr>
   <tr>
    <td><span class="text-bold">SOA</span></td>
    <td>Start of authority</td>
    <td>Вказівка ​​на авторитетність інформації</td>
   </tr>
   <tr>
    <td><span class="text-bold">SRV</span></td>
    <td>Server selection</td>
    <td>Вказівка ​​на розташування серверів для сервісів</td>
   </tr>
   <tr>
    <td><span class="text-bold">PTR</span></td>
    <td>pointer</td>
    <td>Відповідність адресаи імені – зворотна відповідність для A та AAAA</td>
   </tr>
   <tr>
    <td><span class="text-bold">TXT</span></td>
    <td>Text string</td>
    <td>Запис довільних двійкових даних до 255 байт</td>
   </tr>
  </tbody>
 </table>
</div>
<p>Найцікавіші тут такі:</p>
<ul>
 <li><span class="text-bold">A</span> - запис дозволяє встановити IP-адресау, яка відповідає домену.</li>
 <li><span class="text-bold">CNAME</span> дозволяє встановити синонім імені, наприклад, www.codegym.cc == codegym.cc.</li>
 <li><span class="text-bold">MX</span> запис містить інформацію про поштовий сервер: що робити, якщо на xxx@codegym.cc прийде лист.</li>
 <li><span class="text-bold">NS</span> — Вказує на адресау DNS-сервера, який містить інформацію щодо даного домену. Корисно, коли записи кешуються і зберігаються не так на рідних вузлах.</li>
</ul>
<h2>Пошук IP адресаи</h2>
<p>Давайте розберемося, як працює DNS-система.</p>
<p>Допустимо, ти набрав у браузері адресау api.codegym.cc. Браузер звернеться до локального DNS-сервісу та попросить дати йому IP-адресау для домену api.codegym.cc. Далі відбуватиметься ось що…</p>
<p>Спочатку DNS-сервіс дивиться, чи є цей домен у локальному файлі hosts на комп'ютері. Якщо є, то бере IP-адресау з нього. Якщо ні, то надсилає запит до відомого йому DNS-серверу: "Яка IP-адресаа у api.codegym.cc?".</p>
<p>Однак, сервер DNS може нічого не знати не тільки про запитане ім'я, але і про весь домен codegym.cc. У цьому випадку сервер звертається до кореневого сервера, наприклад, 198.41.0.4. Цей сервер повідомляє: “Я не маю інформації про дану адресау, але я знаю, що 204.74.112.1 є відповідальним за зону ru.”.</p>
<p>Тоді сервер DNS надсилає свій запит до 204.74.112.1, але той відповідає: "У мене немає інформації про цей сервер, але я знаю, що 207.142.131.234 є відповідальним за зону codegym.cc.". Нарешті, той самий запит відправляється до третього DNS-сервера і отримує відповідь — IP-адресау, яка і передається клієнту, тобто браузеру.</p>
<p>В даному випадку в процесі пошуку IP на ім'я спрацювали такі правила:</p>
<ul>
 <li>Браузер відправив відомому йому DNS-серверу <span class="text-bold">рекурсивний запит</span> (у відповідь такий тип запиту сервер зобов'язаний повернути IP-адресау, або порожня відповідь і код помилки NXDOMAIN).</li>
 <li>DNS-сервер, який отримав запит від браузера, послідовно відправляв нерекурсивні запити, на які отримував від інших DNS-серверів відповіді, доки не отримав відповіді від сервера, відповідального за зону.</li>
 <li>Інші згадувані DNS-сервери обробляли запити нерекурсивно (і, швидше за все, не почали обробляти запити рекурсивно, навіть якби така вимога стояла в запиті).</li>
</ul>
<p>Іноді допускається, щоб запитаний сервер передавав рекурсивний запит "вищому" DNS-серверу і чекав готової відповіді.</p>
<p><span class="text-bold"><span class="text-red">Важливо! </span></span>При рекурсивній обробці запитів усі відповіді проходять через DNS-сервер, і він має можливість кешувати їх. Повторний запит тих же доменних імен зазвичай не йде далі за кеш сервера, звернення до інших серверів не відбувається взагалі.</p>
<p>Допустимий час зберігання відповідей у ​​кеші надходить разом із відповідями (поле TTL ресурсного запису).</p>
<h2>Файл hosts</h2>
<p>Зауважабо, що спочатку пошук йде в локалному файлі hosts. Це спадкоємець того файлу HOSTS.TXT, який вигадали ще за часів ARPANET. Так, він досі існує і досі використовується.</p>
<p>Він розташований на шляху:</p>
<ul>
 <li><span class="text-bold">/etc/hosts</span> у Linux.</li>
 <li><span class="text-bold">%SystemRoot%\system32\drivers\etc\hosts</span> у Windows.</li>
 <li><span class="text-bold">/system/etc/hosts</span> в Android.</li>
</ul>
<p>Зазвичай файл включає визначення розташування вузла localhost:</p>
<pre><code>127.0.0.1   	localhost
</code></pre>
<p>Структура його дуже проста: спочатку йде IP-адресаа, потім доменне ім'я.</p>
<h4>Корисне</h4>
<p>За допомогою файлу hosts можна здійснювати фільтрацію реклами шляхом перенаправлення доменних адреса банерів на адресау 127.0.0.0, 127.0.0.1 або 0.0.0.0.</p>
<p>Використання 127.0.0.1 зазвичай не рекомендується, оскільки призводить до очікування відповіді та супутніх затримок, якщо сервер не існує або неправильно налаштований. А якщо замапит якийсь рекламний домен на IP-адресау 0.0.0.0, то всі запити до нього відразу відвалюватимуться).</p>
<h2>Публічне DNS-сервер</h2>
<p>Зазвичай ти отримуєш DNS-сервер разом із послугою Інтернету, коли його підключаєш. Але такий безкоштовний DNS-сервер – не завжди найкращий варіант. Більше того, можливо, ти б не хотів, щоб кожного разу, коли заходиш на якийсь сайт до DNS-сервера твого провайдера, надсилався запит з ім'ям домену.</p>
<p>Тому багато хто воліє переходити на публічні безкоштовні DNS-сервери. По-перше, вони дуже швидкі і мають великий кеш доменних імен. Ти отримаєш прискорене завантаження сайтів та безвідмовну роботу з мінімальною ймовірністю технічних неполадок.</p>
<p>По-друге – безпека. Деякі DNS-сервіси можуть блокувати доступ до фішингових та шкідливих сайтів та пропонують фільтрацію контенту, щоб захистити дітей від небажаного контенту в Інтернеті.</p>
<p>Такі сервери DNS можуть навіть боротися з шахраями. Наприклад, ти заходиш на підроблений сайт банку, а DNS-сервер віддасть тобі не IP-адресау шахраїв, а своєї служби безпеки.</p>
<h4>Список таких серверів</h4>
<div class="table-container">
 <table>
  <tbody>
   <tr>
    <td>Cloudflare</td>
    <td>1.1.1.1 <br>
      1.0.0.1</td>
    <td>Cloudflare обіцяє, що не буде використовувати дані відвідувань для показу реклами і зобов'язується ніколи не записувати IP-адресаи джерела запитів на диск</td>
   </tr>
   <tr>
    <td>Google Public DNS</td>
    <td>8.8.8.8 <br>
      8.8.4.4</td>
    <td>Зберігає повну інформацію про IP-адресау запитуючого пристрою протягом приблизно 24-48 годин для усунення несправностей та діагностики</td>
   </tr>
   <tr>
    <td>Comodo Secure DNS</td>
    <td>8.26.56.26 <br>
      8.20.247.20</td>
    <td>Блокує фішингові сайти, але й попереджає, якщо ви намагаєтеся відвідати сайти зі шкідливими, шпигунськими програмами</td>
   </tr>
   <tr>
    <td>Яндекс.DNS</td>
    <td>77.88.8.8 <br>
      77.88.8.1</td>
    <td>Безкоштовний DNS-сервіс від популярної російської пошукової системи</td>
   </tr>
  </tbody>
 </table>
</div>